module LowVOC

begin
	using PlutoUI
	using ModelingToolkit
	using DifferentialEquations
	using Unitful
	using Plots
	using Statistics
	using ForwardDiff
	using CSV
	using DataFrames
end

# Absorptive partitioning.

Kₒₘ is an equilibrium partition coefficient, which describes the partition between gas and aerosol phase for the compounds which can occurr in teh form of particles and gases.
Naphtalene falls in the group of intermidiate volatility compounds which are more volatile than semivolatile intermidiate compounds. The partitioning between gas and aerosol phase can be calculated assuming pseudo-ideal solution and absorptive partitioning theory:

#naphtalene partial partition coefficient
begin
	Kₒₘ = zeros(18)
	for n in 1:size(Tp,1), j in 1:size(Tp,2)
		Kₒₘ[n] = R * Tp[n,1] / (Mᵢ[1] * γᵢ[1] * Tp[j,2] * 1000)
	end
	Kₒₘ
end

where,

begin
	R = 8.314 #unit = u"kg*m^2/(s^2*K*mol)" # gas constant
			#T is the temperature, unit = K
	Mᵢ = 128.1705 #unit = ug/mol" #Molecular weight
	γᵢ = 2.3300 # activity coefficient of compound i in aerosol phase
	
end;

T = [263.61, 267.98, 273.16, 278.22, 283.14, 288.01, 293.24, 293.25, 298.26, 303.29, 308.17, 313.24, 318.21, 323.14, 328.24, 333.39, 338.10, 343.06] #temperature range in K
p = [0.23, 0.40, 0.74, 1.38, 2.41, 4.13, 6.93, 6.95, 11.35, 18.45, 28.95, 44.73, 68.82, 104.14, 158.41, 237.54, 340.76, 488.58] #vapor pressure in Pa

Tp = hcat(T, p)

temp = 1 ./T

Now we can plot the equilibrium partition coefficient with the change of the temperature.

plot(Kₒₘ, temp, c=:blue, lab = :none, xlabel="Kₒₘ", ylabel="1/Temperature")

Kₒₘ2 = R .* Tp[:,1] ./ (Mᵢ[1] .* γᵢ[1] .* Tp[:,2]' * 1000)

heatmap(Kₒₘ2,
	xlabel="Temperature", ylabel="Vapor pressure", 
		colorbar_title="Equilibrium partition coefficient",
		title="Kₒₘ dependance on Temperature and vapor pressure")

SVOCs from all sources are assumed to be emitted as two semivolatile surrogate species, SVOC1 and SVOC2, in roughly equal fractions of 0.49 and 0.51. Under most atmospherically relevant conditions, only the lower volatility component is expected to partition appreciably to the aerosol phase.

end
