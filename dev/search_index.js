var documenterSearchIndex = {"docs":
[{"location":"VBS/#VBS:-Volatility-Basis-Set-(VBS)-model-that-deals-with-the-partitioning-of-Secondary-Organic-Aerosol-(SOA)","page":"VBS","title":"VBS: Volatility Basis Set (VBS) model that deals with the partitioning of Secondary Organic Aerosol (SOA)","text":"","category":"section"},{"location":"VBS/#Model","page":"VBS","title":"Model","text":"This is an implementation of the model to simulate the behavior of semivolatile organic compounds in the atmosphere, as described in Donahue et al. (2006):\n\nDonahue, N. M., Robinson, A. L., Stanier, C. O., & Pandis, S. N. (2006). Coupled partitioning, dilution, and chemical aging of semivolatile organics. Environmental science & technology, 40(8), 2635-2643.\n\nWe can create an instance of the model in the following manner. Ci is the input of the function, which is the organic compound concentration in all phases (air and aerosol phase), values were read from the original Figure 1.(a):\n\nusing Aerosol\nusing NonlinearSolve, ModelingToolkit\n\nCi = [2.5, 1.8, 4.0, 4.0, 5.8, 4.8, 6.3, 8.0]\nns = VBS(Ci)\nnothing # hide\n\nWe could solve and visualize the results with the following codes, Let's try reproducing Figure 1.(a):\n\nsimplens = mtkcompile(ns)\nguess = [29] # initial guess of the C_OA, the total organic compound in aerosol phase\nprob = NonlinearProblem(simplens, guess, [])\nsol = solve(prob, TrustRegion())\nnothing # hide\n\nFigure 1.(a) shows a partitioning in ideal situations that compounds are distributed without any potential effects. The green part is the concentration of organic compounds in aerosol phase and white part is the concentration in gas phase.\n\nusing Plots\np1 = begin\n    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])\n    p = bar(x, Ci, label = \"total\", color = :white)\n    bar!(x, sol[simplens.ξ] .* Ci, label = \"condensed-phase\", color = :green)\n    ylabel!(\"Organic Mass, μg/m³\")\n    xlabel!(\"log10(C*)\")\n    title!(\"Typical Ambient Partitioning\")\nend\n\nLet's try reproducing Figure 1.(b): Semi-volatile emissions as they might appear near the output of a primarysource, before substantial dilution into the background atmosphere (only enough dilution to cool the emissions to ambient temperatureis assumed). The high loading leads to partitioning well into the highC* end of the distribution, as shown in brown. Note the scale oftheyaxis (mg/m³).\n\nCi_2 = [0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4] .* 1000 # The unit of Ci is μg/m³, and the values read from the original Figure 1(b) are in units of mg/m³\nns2 = VBS(Ci_2)\nsimplens2 = mtkcompile(ns2)\nprob2 = NonlinearProblem(simplens2, [10000], [])\nsol2 = solve(prob2, TrustRegion())\np2 = begin\n    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])\n    p = bar(x, Ci_2, label = \"total\", color = :white)\n    bar!(x, sol2[simplens2.ξ] .* Ci_2, label = \"condensed-phase\", color = :red)\n    ylabel!(\"Organic Mass, mg/m³\")\n    xlabel!(\"log10(C*)\")\n    title!(\"Cooled Fresh Emissions\")\nend\n\nLet's try reproducing Figure 1.(c): The effect of dilution by pure air on the emissionsdepicted above. The dilution factor of 1000 is indicated with a horizontal black arrow. Dilution by a factor of 1000 reduces the aerosolmass by a factor of 4000 because of repartitioning into the vapor phase\n\nCi_3 = [0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4]\nsimplens3 = mtkcompile(VBS(Ci_3))\nsol3 = solve(NonlinearProblem(simplens3, [10], []), TrustRegion())\np3 = begin\n    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])\n    p = bar(x, Ci_3, label = \"total\", color = :white)\n    bar!(x, sol3[simplens3.ξ] .* Ci_3, label = \"condensed-phase\", color = :red)\n    ylabel!(\"Organic Mass, μg/m³\")\n    xlabel!(\"log10(C*)\")\n    title!(\"Diluted Emissions (dilution factor = 1000)\")\nend\n\nLet's try reproducing Figure 1.(d): The effect of dilution, as depicted in panel b above but nowinto background air represented in panel a above. The partitioning of the background organic material and the fresh emissions are keptseparate,  in  green  and  brown,  only  for  illustrative  purposes.  The  vapor  portions  of  the  background  and  the  fresh  emissions  are  alsoseparated, though each is shown with a white bar.\n\np4 = begin\n    x = log10.([0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4])\n    Ci_sum = Ci .+ Ci_3\n    p = bar(x, Ci_sum, label = \"total\", color = :white)\n    both = sol[simplens.ξ] .* Ci .+ sol3[simplens3.ξ] .* Ci_3\n    bar!(x, both, label = \"diluted emission\", color = :red)\n    bar!(x, sol[simplens.ξ] .* Ci, label = \"background\", color = :green)\n    ylabel!(\"Organic Mass, μg/m³\")\n    xlabel!(\"log10(C*)\")\n    title!(\"Emission & Background Mixed\")\nend","category":"section"},{"location":"VBS/#Temperature-dependence","page":"VBS","title":"Temperature dependence","text":"Temperature dependence was taken into consideration. A  basis  set  of  saturation concentrations (ranging from 1 ng to 100 mg at 300 K) changes with temperature  according  to  the  Clausius  Clapeyron  equation. Let's try reproducing Figure 2:\n\nCi_t = [0.4, 0.55, 0.7, 1.1, 1.25, 1.45, 1.7, 1.8, 2] # values were read from the original Figure\nns_t = VBS(Ci_t, [0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000, 100000]) # The second input of the VBS function is different basic set at standard temperatures, ranging from 1 ng to 100 mg at 300 K\nsimplens_t = mtkcompile(ns_t)\nprob_310 = NonlinearProblem(simplens_t, [29], [simplens_t.T=>310]) # Temperature is an adjustable parameter in the model.\nprob_285 = NonlinearProblem(simplens_t, [29], [simplens_t.T=>285])\nsol_310 = solve(prob_310, TrustRegion())\nsol_285 = solve(prob_285, TrustRegion())\n\n# Helpful visualize function\nfunction pl_t(sol, simplens_t, string::String)\n    x = log10.([0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])\n    p = bar(x, Ci_t, label = \"total\", color = :white)\n    bar!(x, sol[simplens_t.ξ] .* Ci_t, label = \"condensed-phase\", color = :green)\n    ylabel!(\"Organic Mass, μg/m³\")\n    xlabel!(\"log10(C*)\")\n    title!(string)\nend\nplot(pl_t(sol_310, simplens_t, \"310K\"), pl_t(sol_285, simplens_t, \"285K\"), layout = (1, 2))","category":"section"},{"location":"seinfeld_pandis_ch10/#Aerosol-Thermodynamics-(Seinfeld-and-Pandis-Ch.-10)","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol Thermodynamics (Seinfeld & Pandis Ch. 10)","text":"","category":"section"},{"location":"seinfeld_pandis_ch10/#Overview","page":"Seinfeld & Pandis Ch. 10","title":"Overview","text":"This module implements key aerosol thermodynamics equations from Chapter 10 of Seinfeld & Pandis (2006). These equations govern the phase behavior, hygroscopic growth, and gas-particle partitioning of atmospheric aerosols, which are essential processes for air quality modeling and climate science.\n\nThe module provides four ModelingToolkit components:\n\nKelvinEffect: Vapor pressure enhancement over curved droplet surfaces (Eq. 10.86)\nDRHTemperature: Temperature-dependent deliquescence relative humidity (Eq. 10.72)\nZSRWaterContent: Aerosol liquid water content via the Zdanovskii-Stokes-Robinson mixing rule (Eq. 10.98)\nNH4NO3Equilibrium: Ammonium nitrate gas-aerosol partitioning (Eqs. 10.88, 10.91)\n\nAdditionally, standalone functions are provided for all equilibrium constant calculations from Table 10.7.\n\nReference: Seinfeld, J.H. and Pandis, S.N. (2006) \"Atmospheric Chemistry and Physics: From Air Pollution to Climate Change\", 2nd Edition, John Wiley & Sons, Chapter 10.","category":"section"},{"location":"seinfeld_pandis_ch10/#Implementation","page":"Seinfeld & Pandis Ch. 10","title":"Implementation","text":"","category":"section"},{"location":"seinfeld_pandis_ch10/#KelvinEffect-Component","page":"Seinfeld & Pandis Ch. 10","title":"KelvinEffect Component","text":"The Kelvin effect describes the enhancement of vapor pressure over a curved liquid surface relative to a flat surface (Eq. 10.86):\n\np_A = p_A expleft(frac2sigma MRT rho_l R_pright)","category":"section"},{"location":"seinfeld_pandis_ch10/#Variables","page":"Seinfeld & Pandis Ch. 10","title":"Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Aerosol, Aerosol.SeinfeldPandisCh10\n\nsys = KelvinEffect()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch10/#Parameters","page":"Seinfeld & Pandis Ch. 10","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch10/#Equations","page":"Seinfeld & Pandis Ch. 10","title":"Equations","text":"equations(sys)","category":"section"},{"location":"seinfeld_pandis_ch10/#DRHTemperature-Component","page":"Seinfeld & Pandis Ch. 10","title":"DRHTemperature Component","text":"Calculates the temperature-dependent deliquescence relative humidity using Eq. 10.72:\n\nDRH(T) = DRH(298) expleftfracDelta H_sRleftAleft(frac1T - frac1298right) - BlnfracT298 - C(T-298)rightright\n\nwhere A, B, C are the solubility polynomial coefficients from Table 10.2.","category":"section"},{"location":"seinfeld_pandis_ch10/#Variables-and-Parameters","page":"Seinfeld & Pandis Ch. 10","title":"Variables and Parameters","text":"sys_drh = DRHTemperature(salt = :NH4NO3)\nparams_drh = parameters(sys_drh)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params_drh],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params_drh],\n    :Description => [ModelingToolkit.getdescription(p) for p in params_drh]\n)","category":"section"},{"location":"seinfeld_pandis_ch10/#Equations-2","page":"Seinfeld & Pandis Ch. 10","title":"Equations","text":"equations(sys_drh)","category":"section"},{"location":"seinfeld_pandis_ch10/#ZSRWaterContent-Component","page":"Seinfeld & Pandis Ch. 10","title":"ZSRWaterContent Component","text":"Calculates aerosol liquid water content using the ZSR mixing rule (Eq. 10.98):\n\nW = sum_i fracC_im_i0(a_w)\n\nwhere C_i is the concentration of species i and m_i0(a_w) is the molality in binary solution at water activity a_w = RH (Eq. 10.63).","category":"section"},{"location":"seinfeld_pandis_ch10/#Variables-and-Parameters-2","page":"Seinfeld & Pandis Ch. 10","title":"Variables and Parameters","text":"sys_zsr = ZSRWaterContent(n_species = 2)\nvars_zsr = unknowns(sys_zsr)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars_zsr],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars_zsr],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars_zsr]\n)","category":"section"},{"location":"seinfeld_pandis_ch10/#NH4NO3Equilibrium-Component","page":"Seinfeld & Pandis Ch. 10","title":"NH4NO3Equilibrium Component","text":"Implements NH₄NO₃ gas-aerosol equilibrium including:\n\nSolid dissociation constant K_p (Eq. 10.91): ln K_p = 846 - 24220T - 61 ln(T298)\nEmpirical DRH (Eq. 10.88): ln(DRH) = 7237T + 16954\nPhase determination based on RH vs DRH","category":"section"},{"location":"seinfeld_pandis_ch10/#Equations-3","page":"Seinfeld & Pandis Ch. 10","title":"Equations","text":"sys_nh4 = NH4NO3Equilibrium()\nequations(sys_nh4)","category":"section"},{"location":"seinfeld_pandis_ch10/#Equilibrium-Constants-(Table-10.7)","page":"Seinfeld & Pandis Ch. 10","title":"Equilibrium Constants (Table 10.7)","text":"Temperature-dependent equilibrium constants for 13 reactions follow the general form:\n\nK(T) = K(298) expleftaleft(frac298T - 1right) + bleft1 + lnfrac298T - frac298Trightright","category":"section"},{"location":"seinfeld_pandis_ch10/#Analysis","page":"Seinfeld & Pandis Ch. 10","title":"Analysis","text":"","category":"section"},{"location":"seinfeld_pandis_ch10/#Kelvin-Effect:-Saturation-Ratio-vs.-Droplet-Radius-(cf.-Figure-10.12)","page":"Seinfeld & Pandis Ch. 10","title":"Kelvin Effect: Saturation Ratio vs. Droplet Radius (cf. Figure 10.12)","text":"The Kelvin effect becomes significant for particles smaller than ~100 nm. This figure shows the saturation ratio as a function of droplet radius for water at 298 K.\n\nusing Plots\n\n# Saturation ratio vs droplet radius for water (Fig. 10.12)\nR_p_range = 10 .^ range(log10(2e-9), log10(1e-6), length = 200)\nS_water = [kelvin_saturation_ratio(298.0, R_p, 0.072, 0.018, 1000.0) for R_p in R_p_range]\n\nplot(R_p_range * 1e9, S_water,\n    xlabel = \"Droplet Radius (nm)\", ylabel = \"Saturation Ratio S\",\n    label = \"Water (σ=0.072 N/m)\",\n    xscale = :log10, legend = :topright,\n    title = \"Kelvin Effect: Vapor Pressure Enhancement\",\n    linewidth = 2, xlims = (1, 1000), ylims = (1.0, 1.3))\n\n# Add other compounds from Table 10.6 for comparison\n# Dioctyl phthalate (DOP)-like organic: lower surface tension\nS_organic = [kelvin_saturation_ratio(298.0, R_p, 0.030, 0.104, 900.0) for R_p in R_p_range]\nplot!(R_p_range * 1e9, S_organic, label = \"Organic (σ=0.030 N/m)\",\n    linewidth = 2, linestyle = :dash)\n\n# Add reference line at S=1\nhline!([1.0], label = \"\", color = :gray, linestyle = :dot)\n\nsavefig(\"kelvin_effect.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#DRH-Temperature-Dependence-(cf.-Figure-10.6)","page":"Seinfeld & Pandis Ch. 10","title":"DRH Temperature Dependence (cf. Figure 10.6)","text":"The deliquescence relative humidity varies with temperature. Salts with positive enthalpy of solution (Delta H_s  0) show decreasing DRH with increasing temperature, while those with negative Delta H_s show the opposite trend.\n\nT_range = 250.0:1.0:320.0\n\nsalts = [:NH4NO3, :NH42SO4, :NaCl, :Na2SO4, :KCl, :NaNO3]\nsalt_labels = [\"NH₄NO₃\", \"(NH₄)₂SO₄\", \"NaCl\", \"Na₂SO₄\", \"KCl\", \"NaNO₃\"]\n\np_drh = plot(xlabel = \"Temperature (K)\", ylabel = \"DRH (%)\",\n    title = \"DRH Temperature Dependence (Eq. 10.72)\",\n    legend = :outertopright, ylims = (40, 100))\n\nfor (salt, label) in zip(salts, salt_labels)\n    drh_vals = [drh_temperature(T, salt) * 100 for T in T_range]\n    plot!(p_drh, T_range, drh_vals, label = label, linewidth = 2)\nend\n\nsavefig(\"drh_temperature.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#NHNO-Dissociation-Constant-vs.-Temperature-(cf.-Figure-10.19)","page":"Seinfeld & Pandis Ch. 10","title":"NH₄NO₃ Dissociation Constant vs. Temperature (cf. Figure 10.19)","text":"The dissociation constant K_p of solid NH₄NO₃ increases strongly with temperature, indicating that higher temperatures favor evaporation of NH₄NO₃ to NH₃(g) + HNO₃(g).\n\nT_range_kp = 270.0:0.5:320.0\nKp_vals = [nh4no3_Kp(T) for T in T_range_kp]\n\nplot(T_range_kp, Kp_vals,\n    xlabel = \"Temperature (K)\", ylabel = \"Kp (ppb²)\",\n    title = \"NH₄NO₃ Dissociation Constant (Eq. 10.91)\",\n    label = \"Kp\", linewidth = 2, yscale = :log10,\n    legend = :topleft)\n\nsavefig(\"nh4no3_kp.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#NHNO-Deliquescence-RH-vs.-Temperature-(cf.-Figure-10.20)","page":"Seinfeld & Pandis Ch. 10","title":"NH₄NO₃ Deliquescence RH vs. Temperature (cf. Figure 10.20)","text":"The DRH of NH₄NO₃ decreases with increasing temperature, which determines the phase transition boundary between solid and aqueous NH₄NO₃.\n\nT_range_drh = 270.0:0.5:320.0\ndrh_nh4no3_emp = [nh4no3_drh(T) * 100 for T in T_range_drh]\ndrh_nh4no3_eq72 = [drh_temperature(T, :NH4NO3) * 100 for T in T_range_drh]\n\nplot(T_range_drh, drh_nh4no3_emp,\n    xlabel = \"Temperature (K)\", ylabel = \"DRH (%)\",\n    title = \"NH₄NO₃ DRH vs. Temperature\",\n    label = \"Empirical (Eq. 10.88)\", linewidth = 2)\nplot!(T_range_drh, drh_nh4no3_eq72,\n    label = \"General form (Eq. 10.72)\", linewidth = 2, linestyle = :dash)\n\nsavefig(\"nh4no3_drh.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#ZSR-Water-Content-vs.-Relative-Humidity","page":"Seinfeld & Pandis Ch. 10","title":"ZSR Water Content vs. Relative Humidity","text":"The ZSR mixing rule predicts aerosol liquid water content as a function of relative humidity for multicomponent aerosols.\n\nRH_range = 0.4:0.01:0.95\n\n# Single-component water uptake\nW_nh42so4 = [zsr_water_content(RH, Dict(:NH42SO4 => 1e-6)) for RH in RH_range]\nW_nh4no3 = [zsr_water_content(RH, Dict(:NH4NO3 => 1e-6)) for RH in RH_range]\nW_nacl = [zsr_water_content(RH, Dict(:NaCl => 1e-6)) for RH in RH_range]\n\n# Mixed aerosol\nW_mixed = [zsr_water_content(RH, Dict(:NH42SO4 => 0.5e-6, :NH4NO3 => 0.5e-6))\n           for RH in RH_range]\n\nplot(RH_range * 100, W_nh42so4 * 1e6,\n    xlabel = \"Relative Humidity (%)\", ylabel = \"Water Content (μmol/m³)\",\n    title = \"ZSR Aerosol Water Content (Eq. 10.98)\",\n    label = \"(NH₄)₂SO₄\", linewidth = 2)\nplot!(RH_range * 100, W_nh4no3 * 1e6, label = \"NH₄NO₃\", linewidth = 2)\nplot!(RH_range * 100, W_nacl * 1e6, label = \"NaCl\", linewidth = 2)\nplot!(RH_range * 100, W_mixed * 1e6, label = \"Mixed\", linewidth = 2, linestyle = :dash)\n\nsavefig(\"zsr_water.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#Temperature-Dependence-of-Equilibrium-Constants-(Table-10.7)","page":"Seinfeld & Pandis Ch. 10","title":"Temperature Dependence of Equilibrium Constants (Table 10.7)","text":"Selected equilibrium constants from Table 10.7 showing their temperature dependence.\n\nT_range_eq = 260.0:1.0:320.0\n\nreactions = [:HSO4_dissoc, :NaCl_dissoc, :NH42SO4_dissoc, :Na2SO4_dissoc]\nlabels = [\"HSO₄⁻ dissoc.\", \"NaCl dissoc.\", \"(NH₄)₂SO₄ dissoc.\", \"Na₂SO₄ dissoc.\"]\n\np_eq = plot(xlabel = \"Temperature (K)\", ylabel = \"K / K(298)\",\n    title = \"Equilibrium Constants (Table 10.7, normalized)\",\n    legend = :topleft, yscale = :log10)\n\nfor (rxn, label) in zip(reactions, labels)\n    K_ref = get_equilibrium_constant(rxn, 298.0)\n    K_vals = [get_equilibrium_constant(rxn, T) / K_ref for T in T_range_eq]\n    plot!(p_eq, T_range_eq, K_vals, label = label, linewidth = 2)\nend\n\nhline!([1.0], label = \"\", color = :gray, linestyle = :dot)\n\nsavefig(\"equilibrium_constants.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#Ionic-Strength-Fraction-(Eq.-10.100)","page":"Seinfeld & Pandis Ch. 10","title":"Ionic Strength Fraction (Eq. 10.100)","text":"The ionic strength fraction Y determines the activity coefficient correction for NH₄NO₃ in the presence of (NH₄)₂SO₄:\n\nY = fractextNH_4textNO_3textNH_4textNO_3 + 3(textNH_4)_2textSO_4\n\nratios = 0.0:0.01:1.0  # NH4NO3 fraction of total\nY_vals = [ionic_strength_fraction(r, 1-r) for r in ratios]\n\nplot(ratios * 100, Y_vals,\n    xlabel = \"NH₄NO₃ Mole Fraction (%)\", ylabel = \"Ionic Strength Fraction Y\",\n    title = \"Ionic Strength Fraction (Eq. 10.100)\",\n    label = \"Y\", linewidth = 2, legend = :topleft)\n\nsavefig(\"ionic_strength.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"seinfeld_pandis_ch10/#Functional-API-Reference","page":"Seinfeld & Pandis Ch. 10","title":"Functional API Reference","text":"","category":"section"},{"location":"seinfeld_pandis_ch10/#Module-Reference","page":"Seinfeld & Pandis Ch. 10","title":"Module Reference","text":"","category":"section"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.KelvinEffect","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.KelvinEffect","text":"KelvinEffect(; name=:KelvinEffect)\n\nA component that calculates the Kelvin effect on vapor pressure over curved droplet surfaces.\n\nImplements Equation 10.86 from Seinfeld & Pandis (2006):\n\np_A = p_A expleft(frac2sigma MRT rho_l R_pright)\n\nwhere:\n\np_A is the vapor pressure over the droplet\np°_A is the saturation vapor pressure over a flat surface\nσ is the surface tension\nM is the molar mass\nR is the gas constant\nT is temperature\nρ_l is the liquid density\nR_p is the droplet radius\n\nVariables\n\nS: Saturation ratio (pA / p°A) (dimensionless)\nln_S: Natural log of saturation ratio (dimensionless)\n\nParameters\n\nT: Temperature (K)\nR_p: Particle radius (m)\nσ: Surface tension (N/m)\nM_mol: Molar mass (kg/mol)\nρ_l: Liquid density (kg/m³)\n\nExample\n\nusing ModelingToolkit, Aerosol\n@mtkbuild sys = KelvinEffect()\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.DRHTemperature","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.DRHTemperature","text":"DRHTemperature(; name=:DRHTemperature, salt=:NH4NO3)\n\nA component that calculates the temperature-dependent deliquescence relative humidity.\n\nImplements Equation 10.72 from Seinfeld & Pandis (2006):\n\nDRH(T) = DRH(298) expleftfracDelta H_sRleftAleft(frac1T - frac1298right) - BlnfracT298 - C(T-298)rightright\n\nwhere A, B, C are the solubility polynomial coefficients from Table 10.2.\n\nParameters\n\nT: Temperature (K)\nDRH_298K: DRH at 298 K (dimensionless, 0-1)\nΔH_s: Enthalpy of solution (J/mol)\nA_sol: Solubility coefficient A (dimensionless)\nB_sol: Solubility coefficient B (K⁻¹)\nC_sol: Solubility coefficient C (K⁻²)\n\nVariables\n\nDRH: Deliquescence relative humidity at temperature T (dimensionless, 0-1)\n\nExample\n\nusing ModelingToolkit, Aerosol\n@mtkbuild sys = DRHTemperature(salt = :NH4NO3)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.ZSRWaterContent","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.ZSRWaterContent","text":"ZSRWaterContent(; name=:ZSRWaterContent, n_species=3)\n\nA component that calculates aerosol liquid water content using the ZSR mixing rule.\n\nImplements Equation 10.98 from Seinfeld & Pandis (2006):\n\nW = sum_i fracC_im_i0(a_w)\n\nwhere:\n\nW is the total aerosol liquid water content (kg water per m³ air)\nCᵢ is the concentration of species i (mol/m³ air)\nmᵢ,₀(aᵤ) is the molality of species i in a binary solution at water activity aᵤ\n\nThe water activity equals the relative humidity for equilibrium aerosols (Eq. 10.63).\n\nParameters\n\nRH: Relative humidity as a fraction (0-1)\nC[1:n_species]: Concentrations of each salt species (mol/m³)\nm0[1:n_species]: Molalities of each species at saturation in binary solution (mol/kg)\n\nVariables\n\nW: Total aerosol liquid water content (kg/m³)\nα_w: Water activity (dimensionless)\n\nExample\n\nusing ModelingToolkit, Aerosol\n@mtkbuild sys = ZSRWaterContent(n_species = 2)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.NH4NO3Equilibrium","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.NH4NO3Equilibrium","text":"NH4NO3Equilibrium(; name=:NH4NO3Equilibrium)\n\nA component that calculates NH4NO3 gas-aerosol equilibrium.\n\nImplements the equilibrium reactions and constants from Section 10.4.3 of Seinfeld & Pandis (2006).\n\nSolid NH4NO3 equilibrium (below DRH)\n\nEq. 10.87: NH3(g) + HNO3(g) ⇌ NH4NO3(s)\n\nEq. 10.91 - Dissociation constant (ppb² units):\n\nln K_p = 846 - frac24220T - 61 lnfracT298\n\nAqueous NH4NO3 equilibrium (above DRH)\n\nEq. 10.92: NH3(g) + HNO3(g) ⇌ NH4+ + NO3-\n\nEq. 10.97 - Equilibrium constant:\n\nK_AN = 4 times 10^17 expleft647left(frac298T - 1right) + 1151left1 + lnfrac298T - frac298Trightright\n\n(units: mol² kg⁻² atm⁻²)\n\nIonic strength fraction (Eq. 10.100)\n\nY = fracNH_4NO_3NH_4NO_3 + 3(NH_4)_2SO_4\n\nParameters\n\nT: Temperature (K)\nRH: Relative humidity (0-1)\nC_NH42SO4: (NH4)2SO4 concentration for ionic strength calculation (mol/m³)\n\nVariables\n\nln_Kp: Log of solid dissociation constant (dimensionless for ppb² units)\nKp: Solid dissociation constant (ppb²)\nK_AN: Aqueous equilibrium constant (mol² kg⁻² atm⁻²)\nDRH: Deliquescence RH of NH4NO3 (dimensionless)\nis_aqueous: 1 if RH > DRH (aqueous phase), 0 otherwise (dimensionless)\nY: Ionic strength fraction (dimensionless)\n\nExample\n\n    # Temperature coefficients with units for Eq. 10.91 and 10.88\n\nusing ModelingToolkit, Aerosol\n@mtkbuild sys = NH4NO3Equilibrium()\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.get_equilibrium_constant","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.get_equilibrium_constant","text":"get_equilibrium_constant(reaction::Symbol, T::Real)\n\nGet the equilibrium constant for a reaction at temperature T using Table 10.7 data.\n\nArguments\n\nreaction: Symbol identifying the reaction (e.g., :NH4NO3solid, :HSO4dissoc)\nT: Temperature (K)\n\nReturns\n\nEquilibrium constant at temperature T\n\nAvailable reactions\n\n:NaCl_HNO3 - NaCl(s) + HNO3(g) ⇌ NaNO3(s) + HCl(g)\n:HSO4_dissoc - HSO4⁻ ⇌ H⁺ + SO4²⁻\n:NH3HNO3aq - NH3(g) + HNO3(g) ⇌ NH4⁺ + NO3⁻\n:HCl_dissoc - HCl(g) ⇌ H⁺ + Cl⁻\n:NH3HClaq - NH3(g) + HCl(g) ⇌ NH4⁺ + Cl⁻\n:Na2SO4_dissoc - Na2SO4(s) ⇌ 2Na⁺ + SO4²⁻\n:NH42SO4_dissoc - (NH4)2SO4(s) ⇌ 2NH4⁺ + SO4²⁻\n:HNO3_dissoc - HNO3(g) ⇌ H⁺ + NO3⁻\n:NH4Cl_dissoc - NH4Cl(s) ⇌ NH3(g) + HCl(g)\n:NH4NO3_solid - NH3(g) + HNO3(g) ⇌ NH4NO3(s)\n:NaCl_dissoc - NaCl(s) ⇌ Na⁺ + Cl⁻\n:NaHSO4_dissoc - NaHSO4(s) ⇌ Na⁺ + HSO4⁻\n:NaNO3_dissoc - NaNO3(s) ⇌ Na⁺ + NO3⁻\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.kelvin_saturation_ratio","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.kelvin_saturation_ratio","text":"kelvin_saturation_ratio(T, R_p, σ, M_mol, ρ_l)\n\nCalculate the Kelvin saturation ratio for a droplet.\n\nImplements Equation 10.86 from Seinfeld & Pandis (2006).\n\nArguments\n\nT: Temperature (K)\nR_p: Particle radius (m)\nσ: Surface tension (N/m)\nM_mol: Molar mass (kg/mol)\nρ_l: Liquid density (kg/m³)\n\nReturns\n\nSaturation ratio S = pA/p°A (dimensionless)\n\nExample\n\nFor a 50 nm water droplet at 298 K:\n\nS = kelvin_saturation_ratio(298.0, 50e-9, 0.072, 0.018, 1000.0)\n# S ≈ 1.024 (2.4% vapor pressure enhancement)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.drh_temperature","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.drh_temperature","text":"drh_temperature(T, salt::Symbol)\n\nCalculate the DRH of a salt at temperature T using the full form of Eq. 10.72.\n\nDRH(T) = DRH(298) expleftfracDelta H_sRleftAleft(frac1T - frac1298right) - BlnfracT298 - C(T-298)rightright\n\nwhere A, B, C are the solubility polynomial coefficients from Table 10.2.\n\nArguments\n\nT: Temperature (K)\nsalt: Salt symbol (:NH4NO3, :NH42SO4, :NaCl, etc.)\n\nReturns\n\nDRH as a decimal fraction (0-1)\n\nExample\n\ndrh = drh_temperature(280.0, :NH4NO3)  # Returns DRH of NH4NO3 at 280 K\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.nh4no3_drh","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.nh4no3_drh","text":"nh4no3_drh(T)\n\nCalculate the DRH of NH4NO3 using the empirical correlation (Eq. 10.88).\n\nln(DRH) = frac7237T + 16954\n\nArguments\n\nT: Temperature (K)\n\nReturns\n\nDRH as a decimal fraction (0-1)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.zsr_water_content","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.zsr_water_content","text":"zsr_water_content(RH, concentrations::Dict{Symbol,Float64})\n\nCalculate aerosol liquid water content using the ZSR mixing rule (Eq. 10.98).\n\nArguments\n\nRH: Relative humidity as a fraction (0-1)\nconcentrations: Dictionary mapping salt symbols to concentrations (mol/m³)\n\nReturns\n\nAerosol liquid water content W (kg/m³)\n\nSupported salts\n\n:NH42SO4 - Ammonium sulfate\n:NH4NO3 - Ammonium nitrate\n:NaCl - Sodium chloride\n\nExample\n\nW = zsr_water_content(0.8, Dict(:NH42SO4 => 1e-6, :NH4NO3 => 2e-6))  # Eq. 10.63\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.nh4no3_Kp","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.nh4no3_Kp","text":"nh4no3_Kp(T)\n\nCalculate the solid NH4NO3 dissociation constant at temperature T.\n\nImplements Equation 10.91 from Seinfeld & Pandis (2006):\n\nln K_p = 846 - frac24220T - 61 lnfracT298\n\nArguments\n\nT: Temperature (K)\n\nReturns\n\nKp in ppb² units\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.nh4no3_K_AN","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.nh4no3_K_AN","text":"nh4no3_K_AN(T)\n\nCalculate the aqueous NH4NO3 equilibrium constant at temperature T.\n\nImplements Equation 10.97 from Seinfeld & Pandis (2006).\n\nArguments\n\nT: Temperature (K)\n\nReturns\n\nK_AN in mol² kg⁻² atm⁻² units\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.ionic_strength_fraction","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.ionic_strength_fraction","text":"ionic_strength_fraction(C_NH4NO3, C_NH42SO4)\n\nCalculate the ionic strength fraction Y (Eq. 10.100).\n\nArguments\n\nC_NH4NO3: NH4NO3 concentration (any units, same as C_NH42SO4)\nC_NH42SO4: (NH4)2SO4 concentration (any units, same as C_NH4NO3)\n\nReturns\n\nIonic strength fraction Y (dimensionless, 0-1)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.equilibrium_constant_temperature","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.equilibrium_constant_temperature","text":"equilibrium_constant_temperature(K_ref, T, T_ref, a, b)\n\nCalculate temperature-dependent equilibrium constant using the standard form.\n\nK(T) = K(298) expleftaleft(frac298T - 1right) + bleft1 + lnfrac298T - frac298Trightright\n\nThis form is used for equilibrium constants in Table 10.7 of Seinfeld & Pandis (2006).\n\nArguments\n\nK_ref: Equilibrium constant at reference temperature\nT: Temperature (K)\nT_ref: Reference temperature (K), typically 298\na: First temperature coefficient\nb: Second temperature coefficient\n\nReturns\n\nEquilibrium constant at temperature T\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.binary_molality_nh42so4","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.binary_molality_nh42so4","text":"binary_molality_nh42so4(a_w)\n\nCalculate the molality of (NH4)2SO4 in binary aqueous solution at water activity a_w.\n\nBased on polynomial fits to water activity data.\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.binary_molality_nh4no3","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.binary_molality_nh4no3","text":"binary_molality_nh4no3(a_w)\n\nCalculate the molality of NH4NO3 in binary aqueous solution at water activity a_w.\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10.binary_molality_nacl","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10.binary_molality_nacl","text":"binary_molality_nacl(a_w)\n\nCalculate the molality of NaCl in binary aqueous solution at water activity a_w.\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch10/#Aerosol.SeinfeldPandisCh10","page":"Seinfeld & Pandis Ch. 10","title":"Aerosol.SeinfeldPandisCh10","text":"Aerosol thermodynamics equations from Seinfeld & Pandis (2006) Chapter 10.\n\nReference: Seinfeld, J.H. and Pandis, S.N. (2006) \"Atmospheric Chemistry and Physics: From Air Pollution to Climate Change\", 2nd Edition, John Wiley & Sons, Chapter 10.\n\n\n\n\n\n","category":"module"},{"location":"aerosol_radiative_forcing/#Aerosol-Radiative-Forcing","page":"Radiative Forcing","title":"Aerosol Radiative Forcing","text":"","category":"section"},{"location":"aerosol_radiative_forcing/#Overview","page":"Radiative Forcing","title":"Overview","text":"This module implements the aerosol radiative forcing equations from Chapter 24 (\"Aerosols and Climate\") of Seinfeld & Pandis's \"Atmospheric Chemistry and Physics\" textbook. The equations describe both direct and indirect effects of aerosols on Earth's radiation budget.\n\nDirect effects occur when aerosols scatter and absorb incoming solar radiation, modifying the planetary albedo. Indirect effects arise from aerosols acting as cloud condensation nuclei (CCN), increasing cloud droplet number concentration (CDNC) and thereby altering cloud optical properties.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 24, pp. 1054-1091.","category":"section"},{"location":"aerosol_radiative_forcing/#Implementation","page":"Radiative Forcing","title":"Implementation","text":"The module provides six @component functions that implement the key equations from Chapter 24:\n\nAerosolLayerRadiativeForcing: Calculates the change in outgoing radiative flux due to an aerosol layer (Eqs. 24.1-24.10)\nCriticalSingleScatteringAlbedo: Determines the boundary between aerosol cooling and heating (Eq. 24.15)\nCloudOpticalDepth: Relates cloud optical depth to microphysical properties (Eq. 24.36)\nCloudAlbedo: Computes cloud albedo from optical depth using two-stream approximation (Eqs. 24.37-24.38)\nCloudAlbedoSensitivity: Quantifies the Twomey susceptibility (Eqs. 24.40-24.41)\nIndirectAerosolForcing: Calculates the first indirect effect of aerosols on climate (Eqs. 24.42-24.43)","category":"section"},{"location":"aerosol_radiative_forcing/#System-Variables","page":"Radiative Forcing","title":"System Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Aerosol\n\nsys = AerosolLayerRadiativeForcing()\n\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [repr(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"aerosol_radiative_forcing/#System-Parameters","page":"Radiative Forcing","title":"System Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [repr(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"aerosol_radiative_forcing/#Equations","page":"Radiative Forcing","title":"Equations","text":"equations(sys)","category":"section"},{"location":"aerosol_radiative_forcing/#Analysis","page":"Radiative Forcing","title":"Analysis","text":"","category":"section"},{"location":"aerosol_radiative_forcing/#Table-24.2:-Global-Mean-Parameters-for-Sulfate-Aerosol-Forcing","page":"Radiative Forcing","title":"Table 24.2: Global Mean Parameters for Sulfate Aerosol Forcing","text":"The following table presents global mean values of the parameters in Equation 24.29 for estimating direct radiative forcing by anthropogenic sulfate aerosol, along with estimated uncertainty factors (from Penner et al. 1994).\n\nParameter Value Units Uncertainty Factor\nF₀ 1370 W m⁻² —\n1 - Aᶜ 0.4 — 1.1\nTₐ 0.76 — 1.15\n1 - Rₛ 0.85 — 1.1\nβ̄ 0.29 — 1.3\nα_{SO₄}^{RH} 5ᵇ m²(g SO₄²⁻)⁻¹ 1.5\nf(RH) 1.7 — 1.2\nQ_{SO₂} 80 Tg yr⁻¹ 1.15\nγ_{SO₂} 0.4 — 1.5\nτ_{SO₄} 0.02 yr 1.5\nA 5 × 10¹⁴ m² —\n\nᵃThe central value, divided/multiplied by the uncertainty factor, gives the estimated range of values of the parameter. ᵇIncludes associated cations.\n\nSource: Penner et al. (1994).","category":"section"},{"location":"aerosol_radiative_forcing/#Figure-24.2:-Critical-Single-Scattering-Albedo","page":"Radiative Forcing","title":"Figure 24.2: Critical Single-Scattering Albedo","text":"The critical single-scattering albedo ωcrit defines the boundary between aerosol-induced cooling (ω > ωcrit) and heating (ω < ωcrit). This depends on surface albedo Rs and the upscatter fraction β.\n\nFrom Equation 24.15:\n\nomega_textcrit = frac2R_s2R_s + beta(1-R_s)^2\n\nusing Plots\n\n# Calculate critical SSA for various surface albedos and upscatter fractions\nR_s_vals = 0.0:0.01:1.0\nβ_vals = [0.1, 0.2, 0.3, 0.4]\n\np = plot(\n    xlabel = \"Surface Albedo (Rₛ)\", ylabel = \"Critical Single-Scattering Albedo (ωcrit)\",\n    title = \"Figure 24.2: Critical SSA vs Surface Albedo\",\n    legend = :bottomright, ylim = (0, 1))\n\nfor β in β_vals\n    ω_crit = [2 * R_s / (2 * R_s + β * (1 - R_s)^2) for R_s in R_s_vals]\n    plot!(p, R_s_vals, ω_crit, label = \"β = $β\", linewidth = 2)\nend\n\n# Mark typical values\nR_s_typical = 0.15\nβ_typical = 0.29\nω_crit_typical = 2 * R_s_typical / (2 * R_s_typical + β_typical * (1 - R_s_typical)^2)\nscatter!(p, [R_s_typical], [ω_crit_typical], markersize = 8, color = :red,\n    label = \"Typical (Rₛ=0.15, β=0.29)\")\n\np\n\nFor the global mean surface albedo (Rs ≈ 0.15) and typical upscatter fraction (β ≈ 0.29), ωcrit ≈ 0.6. This means sulfate aerosols (ω ≈ 0.95) cause net cooling, while highly absorbing aerosols like black carbon can cause heating.","category":"section"},{"location":"aerosol_radiative_forcing/#Figure-24.16:-Cloud-Albedo-vs-Optical-Depth","page":"Radiative Forcing","title":"Figure 24.16: Cloud Albedo vs Optical Depth","text":"Cloud albedo increases with optical depth according to the two-stream approximation (Eq. 24.38):\n\nR_c = fractau_ctau_c + gamma\n\nwhere γ ≈ 7.7 for an asymmetry factor g = 0.85.\n\n# Cloud albedo vs optical depth\nτ_c_vals = 0.0:0.5:100.0\ng = 0.85\nγ = 2 / (sqrt(3) * (1 - g))\n\nR_c_vals = [τ / (τ + γ) for τ in τ_c_vals]\n\np = plot(τ_c_vals, R_c_vals, xlabel = \"Cloud Optical Depth (τc)\",\n    ylabel = \"Cloud Albedo (Rc)\", title = \"Figure 24.16: Cloud Albedo vs Optical Depth\",\n    linewidth = 2, legend = false, xlim = (0, 100), ylim = (0, 1))\n\n# Mark half-albedo point\nscatter!(p, [γ], [0.5], markersize = 8, color = :red)\nannotate!(p, γ + 5, 0.52, text(\"τc = γ ≈ 7.7\\nRc = 0.5\", 8, :left))\n\np","category":"section"},{"location":"aerosol_radiative_forcing/#Figure-24.18:-Twomey-Susceptibility","page":"Radiative Forcing","title":"Figure 24.18: Twomey Susceptibility","text":"The Twomey susceptibility quantifies how cloud albedo responds to changes in droplet number concentration (Eq. 24.41):\n\nfracdR_cd ln N = fracR_c(1-R_c)3\n\nMaximum susceptibility occurs at R_c = 0.5.\n\nR_c_vals = 0.0:0.01:1.0\nS_vals = [R * (1 - R) / 3 for R in R_c_vals]\n\np = plot(R_c_vals, S_vals, xlabel = \"Cloud Albedo (Rc)\",\n    ylabel = \"Susceptibility dRc/d(ln N)\",\n    title = \"Figure 24.18: Twomey Susceptibility\",\n    linewidth = 2, legend = false, xlim = (0, 1), ylim = (0, 0.1))\n\n# Mark maximum\nscatter!(p, [0.5], [0.5 * 0.5 / 3], markersize = 8, color = :red)\nannotate!(p, 0.55, 0.085, text(\"Maximum at Rc = 0.5\", 8, :left))\n\np","category":"section"},{"location":"aerosol_radiative_forcing/#Figure-24.17:-Cloud-Albedo-vs-Cloud-Droplet-Number-Concentration","page":"Radiative Forcing","title":"Figure 24.17: Cloud Albedo vs Cloud Droplet Number Concentration","text":"Figure 24.17 shows cloud albedo as a function of cloud droplet number concentration at constant liquid water content (L = 0.3 g m⁻³). At constant liquid water content and cloud thickness, cloud albedo increases with increasing CDNC.\n\n# Reproduce Figure 24.17: Cloud albedo vs CDNC\n# Parameters from Figure 24.17 caption\nL = 0.3e-3  # kg/m³ (0.3 g/m³)\nρ_w = 1000.0  # kg/m³\ng = 0.85\nγ = 2 / (sqrt(3) * (1 - g))\n\n# Cloud thicknesses\nh_vals = [50, 100, 500, 1500]  # meters\n\n# CDNC range (cm⁻³)\nN_cm3_range = 10.0:10.0:1000.0\nN_range = N_cm3_range .* 1e6  # Convert to m⁻³\n\np = plot(xlabel = \"Cloud Droplet Number Concentration (cm⁻³)\",\n    ylabel = \"Cloud Albedo (Rᶜ)\",\n    title = \"Figure 24.17: Cloud Albedo vs CDNC (L = 0.3 g m⁻³)\",\n    xscale = :log10, legend = :bottomright, ylim = (0, 1))\n\nfor h in h_vals\n    τ_c_vals = [h * (9 * π * L^2 * N / (2 * ρ_w^2))^(1/3) for N in N_range]\n    R_c_vals = [τ / (τ + γ) for τ in τ_c_vals]\n    plot!(p, N_cm3_range, R_c_vals, label = \"h = $h m\", linewidth = 2)\nend\n\np\n\nThis figure demonstrates the potential of aerosols to affect climate indirectly. For a cloud 50 m thick, increasing CDNC from 100 to 1000 cm⁻³ nearly doubles cloud albedo (from ~0.2 to ~0.4).","category":"section"},{"location":"aerosol_radiative_forcing/#Cloud-Optical-Depth-Sensitivity","page":"Radiative Forcing","title":"Cloud Optical Depth Sensitivity","text":"The relationship between cloud optical depth and cloud droplet number concentration (Eq. 24.36):\n\ntau_c = h left(frac9pi L^2 N2rho_w^2right)^13\n\nThis shows that τ_c increases with N^(1/3), meaning a 30% increase in CDNC produces approximately a 9% increase in optical depth.\n\n# Parameters from Figure 24.17\nh = 500.0  # m (cloud thickness)\nL = 0.3e-3  # kg/m³ (liquid water content)\nρ_w = 1000.0  # kg/m³\n\nN_vals = 10e6:10e6:1000e6  # m⁻³\n\nτ_c_vals = [h * (9 * π * L^2 * N / (2 * ρ_w^2))^(1/3) for N in N_vals]\n\n# Convert to cm⁻³ for plotting\nN_cm3 = N_vals ./ 1e6\n\np = plot(N_cm3, τ_c_vals, xlabel = \"Cloud Droplet Number (cm⁻³)\",\n    ylabel = \"Cloud Optical Depth (τc)\",\n    title = \"Cloud Optical Depth vs CDNC (h=500m, L=0.3 g/m³)\",\n    linewidth = 2, legend = false, xscale = :log10)\n\np","category":"section"},{"location":"aerosol_radiative_forcing/#Indirect-Aerosol-Forcing","page":"Radiative Forcing","title":"Indirect Aerosol Forcing","text":"The change in shortwave forcing due to aerosol-induced changes in cloud albedo (Eq. 24.43):\n\nDelta F_c = -F_0 cdot A_c cdot T_a^2 cdot Delta R_c\n\nwhere ΔR_c depends on the fractional change in CDNC through the Twomey relationship.\n\n# Calculate forcing for different fractional changes in N\nF_0 = 1370.0  # W/m²\nA_c = 0.6     # Cloud fraction\nT_a = 0.76   # Atmospheric transmittance\nR_c = 0.5    # Cloud albedo\n\nΔln_N_vals = 0.0:0.01:0.5  # Fractional change in N\n\nΔR_c_vals = [R_c * (1 - R_c) / 3 * Δln_N for Δln_N in Δln_N_vals]\nΔF_c_vals = [-F_0 * A_c * T_a^2 * ΔR_c for ΔR_c in ΔR_c_vals]\n\n# Convert to percentage for x-axis\npercent_change = (exp.(Δln_N_vals) .- 1) .* 100\n\np = plot(percent_change, ΔF_c_vals, xlabel = \"Percent Increase in CDNC (%)\",\n    ylabel = \"ΔFc (W/m²)\",\n    title = \"Indirect Aerosol Forcing vs CDNC Change\",\n    linewidth = 2, legend = false)\n\n# Mark 30% increase point\nidx_30 = argmin(abs.(percent_change .- 30))\nscatter!(p, [percent_change[idx_30]], [ΔF_c_vals[idx_30]], markersize = 8, color = :red)\nannotate!(p, 35, ΔF_c_vals[idx_30] - 1,\n    text(\"30% increase\\n≈ $(round(ΔF_c_vals[idx_30], digits=1)) W/m²\", 8, :left))\n\np","category":"section"},{"location":"aerosol_radiative_forcing/#Physical-Interpretation","page":"Radiative Forcing","title":"Physical Interpretation","text":"","category":"section"},{"location":"aerosol_radiative_forcing/#Direct-Aerosol-Effects","page":"Radiative Forcing","title":"Direct Aerosol Effects","text":"The direct radiative forcing of aerosols depends on three key properties:\n\nSingle-scattering albedo (ω): The fraction of extinction due to scattering vs absorption. Pure sulfate aerosols have ω ≈ 0.95-1.0, while black carbon has ω ≈ 0.2-0.3.\nUpscatter fraction (β): The fraction of scattered radiation directed upward, which depends on particle size and solar zenith angle. Typical values range from 0.1-0.4.\nAerosol optical depth (τ): The integrated extinction through the aerosol layer. Typical tropospheric values are τ ≈ 0.1.","category":"section"},{"location":"aerosol_radiative_forcing/#Indirect-Aerosol-Effects","page":"Radiative Forcing","title":"Indirect Aerosol Effects","text":"The first indirect effect (Twomey effect) operates through this chain:\n\nIncreased aerosol concentration → More CCN\nMore CCN → More cloud droplets for fixed liquid water\nMore droplets → Smaller droplet size\nSmaller droplets → Higher cloud optical depth\nHigher optical depth → Higher cloud albedo\nHigher albedo → More reflected sunlight (cooling)\n\nThe second indirect effect (cloud lifetime effect) involves precipitation suppression, which is not implemented in this module.","category":"section"},{"location":"aerosol_radiative_forcing/#References","page":"Radiative Forcing","title":"References","text":"Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24.\nCharlson, R. J., et al. (1992). Climate forcing by anthropogenic aerosols. Science, 255(5043), 423-430.\nTwomey, S. (1977). The influence of pollution on the shortwave albedo of clouds. J. Atmos. Sci., 34, 1149-1152.\nHaywood, J. M., and Shine, K. P. (1995). The effect of anthropogenic sulfate and soot aerosol on the clear sky planetary radiation budget. Geophys. Res. Lett., 22(5), 603-606.","category":"section"},{"location":"aerosol_radiative_forcing/#Aerosol.AerosolLayerRadiativeForcing","page":"Radiative Forcing","title":"Aerosol.AerosolLayerRadiativeForcing","text":"AerosolLayerRadiativeForcing(; name=:AerosolLayerRadiativeForcing)\n\nAerosol layer radiative forcing model from Seinfeld & Pandis (2006) Chapter 24.\n\nThis component calculates the change in outgoing radiative flux due to an aerosol layer using the scattering-absorbing model from Section 24.1. It computes the reflection and transmission coefficients, the total reflectance of the aerosol-surface system, and the change in planetary albedo.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 24, Equations 24.1-24.10.\n\nParameters\n\nF_0: Incident solar flux (W m⁻²)\nτ: Aerosol optical depth (dimensionless)\nω: Single-scattering albedo (dimensionless)\nβ: Upscatter fraction (dimensionless)\nR_s: Surface albedo (dimensionless)\nA_c: Cloud fraction (dimensionless)\nT_a: Atmospheric transmittance (dimensionless)\n\nVariables (computed)\n\nr_aer: Fraction of light reflected upward by aerosol (dimensionless)\nt_aer: Fraction of light transmitted through aerosol (dimensionless)\nR_as: Total reflectance of aerosol-surface system (dimensionless)\nΔR_p: Change in planetary albedo (dimensionless)\nΔF: Change in outgoing radiative flux (W m⁻²)\n\n\n\n\n\n","category":"function"},{"location":"aerosol_radiative_forcing/#Aerosol.CriticalSingleScatteringAlbedo","page":"Radiative Forcing","title":"Aerosol.CriticalSingleScatteringAlbedo","text":"CriticalSingleScatteringAlbedo(; name=:CriticalSingleScatteringAlbedo)\n\nComponent to calculate the critical single-scattering albedo (ω_crit) at which an aerosol layer transitions from cooling to heating the climate system.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Equation 24.15: ωcrit = 2*Rs / (2R_s + β(1-R_s)²)\n\nWhen ω > ωcrit, the aerosol causes net cooling (increased reflection). When ω < ωcrit, the aerosol causes net heating (absorption dominates).\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.2.\n\nParameters\n\nR_s: Surface albedo (dimensionless)\nβ: Upscatter fraction (dimensionless)\n\nVariables (computed)\n\nω_crit: Critical single-scattering albedo (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aerosol_radiative_forcing/#Aerosol.CloudOpticalDepth","page":"Radiative Forcing","title":"Aerosol.CloudOpticalDepth","text":"CloudOpticalDepth(; name=:CloudOpticalDepth)\n\nComponent to calculate cloud optical depth from liquid water content and droplet number concentration.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.1: τc = h * (9πL²N / 2ρw²)^(1/3)    (Eq. 24.36)\n\nThis relates cloud optical depth to cloud thickness (h), liquid water content (L), and cloud droplet number concentration (N).\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.1, Equations 24.34-24.36.\n\nParameters\n\nh: Cloud thickness (m)\nL: Liquid water content (kg m⁻³)\nN: Cloud droplet number concentration (m⁻³)\n\nConstants\n\nρ_w: Density of water (kg m⁻³)\n\nVariables (computed)\n\nτ_c: Cloud optical depth (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aerosol_radiative_forcing/#Aerosol.CloudAlbedo","page":"Radiative Forcing","title":"Aerosol.CloudAlbedo","text":"CloudAlbedo(; name=:CloudAlbedo)\n\nComponent to calculate cloud albedo from optical depth using the two-stream approximation.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.1: Rc = τc / (τ_c + γ)    (Eq. 24.38, simplified form for g = 0.85)\n\nwhere γ = 7.7 for an asymmetry factor g = 0.85 (typical for cloud droplets).\n\nThe general two-stream approximation (Eq. 24.37) is: Rc = √3(1-g)τc / (2 + √3(1-g)τ_c)\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.1, Equations 24.37-24.38.\n\nParameters\n\nτ_c: Cloud optical depth (dimensionless)\ng: Asymmetry factor (dimensionless, default 0.85)\n\nVariables (computed)\n\nR_c: Cloud albedo (dimensionless)\nγ: Denominator coefficient for two-stream approximation (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aerosol_radiative_forcing/#Aerosol.CloudAlbedoSensitivity","page":"Radiative Forcing","title":"Aerosol.CloudAlbedoSensitivity","text":"CloudAlbedoSensitivity(; name=:CloudAlbedoSensitivity)\n\nComponent to calculate the sensitivity of cloud albedo to cloud droplet number concentration (Twomey susceptibility).\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.2: dRc/dN = Rc(1-Rc)/(3N)    (Eq. 24.40) dRc/d(ln N) = R_c(1-R_c)/3  (Eq. 24.41, Twomey susceptibility)\n\nThe maximum susceptibility occurs at R_c = 0.5.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.2, Equations 24.39-24.42.\n\nParameters\n\nR_c: Cloud albedo (dimensionless)\nN: Cloud droplet number concentration (m⁻³)\n\nVariables (computed)\n\ndRc_dN: Sensitivity of cloud albedo to CDNC (m³)\nS: Twomey susceptibility dR_c/d(ln N) (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aerosol_radiative_forcing/#Aerosol.IndirectAerosolForcing","page":"Radiative Forcing","title":"Aerosol.IndirectAerosolForcing","text":"IndirectAerosolForcing(; name=:IndirectAerosolForcing)\n\nComponent to calculate the indirect radiative forcing from aerosol effects on cloud albedo (first indirect effect, or Twomey effect).\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.2: ΔFc = -F0 * Ac * Ta² * ΔRc    (Eq. 24.43) ΔRc = Rc*(1-Rc)/3 * Δln(N)      (Eq. 24.42)\n\nThis gives the change in shortwave forcing due to changes in cloud albedo caused by changes in cloud droplet number concentration.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.2, Equations 24.42-24.43.\n\nParameters\n\nF_0: Incident solar flux (W m⁻²)\nA_c: Cloud fraction (dimensionless)\nT_a: Atmospheric transmittance (dimensionless)\nR_c: Cloud albedo (dimensionless)\nΔln_N: Fractional change in CDNC, Δln(N) = ΔN/N (dimensionless)\n\nVariables (computed)\n\nΔR_c: Change in cloud albedo (dimensionless)\nΔF_c: Change in shortwave forcing (W m⁻²)\n\n\n\n\n\n","category":"function"},{"location":"nucleation/#Nucleation","page":"Nucleation","title":"Nucleation","text":"","category":"section"},{"location":"nucleation/#Overview","page":"Nucleation","title":"Overview","text":"Nucleation is the process by which gas-phase molecules spontaneously form small clusters (nuclei) that can grow into aerosol particles. This module implements classical nucleation theory for single-component (homogeneous) nucleation following the treatment in Seinfeld & Pandis (2006), Chapter 11.\n\nThe key outputs of the nucleation model are:\n\nCritical cluster size (i*): The minimum number of molecules required for a stable cluster\nCritical radius (r*): The radius of the critical cluster\nNucleation rate (J): The rate at which new particles form per unit volume per unit time\nFree energy barrier (ΔG*): The energy barrier that must be overcome for nucleation to occur\n\nReference: Seinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 11, pp. 489-536.","category":"section"},{"location":"nucleation/#Implementation","page":"Nucleation","title":"Implementation","text":"The implementation follows classical nucleation theory, which treats the formation of molecular clusters using thermodynamic arguments. The key assumption is the capillarity approximation: clusters of all sizes are assumed to have the same surface tension as bulk liquid.","category":"section"},{"location":"nucleation/#State-Variables","page":"Nucleation","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Aerosol\nusing OrdinaryDiffEq\nusing Plots\n\nsys = Nucleation()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [ModelingToolkit.get_unit(v) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"nucleation/#Parameters","page":"Nucleation","title":"Parameters","text":"pars = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in pars],\n    :Units => [ModelingToolkit.get_unit(p) for p in pars],\n    :Description => [ModelingToolkit.getdescription(p) for p in pars]\n)","category":"section"},{"location":"nucleation/#Equations","page":"Nucleation","title":"Equations","text":"The system implements the following equations from Seinfeld & Pandis (2006):\n\neqs = equations(sys)","category":"section"},{"location":"nucleation/#Core-Equations","page":"Nucleation","title":"Core Equations","text":"The saturation ratio (Eq. 11.1) is the ratio of partial pressure to saturation vapor pressure:\n\nS = fracp_Ap_A^s(T)\n\nThe critical cluster size (Eq. 11.35) is determined by the competition between bulk and surface terms:\n\ni^* = left(frac2theta3ln Sright)^3\n\nwhere θ is the dimensionless surface tension parameter (Eq. 11.27):\n\ntheta = frac(36pi)^13 v_1^23 sigmak_B T\n\nThe critical radius (Eq. 11.52) follows from the Kelvin equation:\n\nr^* = frac2sigma v_1k_B T ln S\n\nThe free energy barrier (Eq. 11.53) is:\n\nDelta G^* = frac16pi3 fracv_1^2 sigma^3(k_B T ln S)^2\n\nThe classical nucleation rate (Eq. 11.47) gives the rate of new particle formation:\n\nJ = sqrtfrac2sigmapi m_1 fracv_1 N_1^2S expleft(-frac16pi3 fracv_1^2 sigma^3(k_B T)^3 (ln S)^2right)","category":"section"},{"location":"nucleation/#Analysis","page":"Nucleation","title":"Analysis","text":"","category":"section"},{"location":"nucleation/#Validation-Against-Table-11.1:-Critical-Cluster-Properties-for-Water","page":"Nucleation","title":"Validation Against Table 11.1: Critical Cluster Properties for Water","text":"The following analysis reproduces Table 11.1 from Seinfeld & Pandis (2006), showing critical cluster properties for water at 273 K and 298 K.\n\nusing OrdinaryDiffEq\n\n# Water properties from Table 11.1\nσ_273 = 75.6e-3  # N/m at 273 K\nσ_298 = 72.0e-3  # N/m at 298 K\nv_1 = 2.99e-29   # m³/molecule\n\nsys = CriticalCluster()\ncompiled = mtkcompile(sys)\n\n# Calculate for 273 K\nresults_273 = []\nfor S in [2, 3, 4, 5]\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => 273.0,\n            compiled.S => Float64(S),\n            compiled.σ => σ_273,\n            compiled.v_1 => v_1\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    r_star_angstrom = sol[compiled.r_star][1] * 1e10  # Convert to Å\n    i_star = sol[compiled.i_star][1]\n    push!(results_273, (\n        S = S, r_star = round(r_star_angstrom, digits = 1), i_star = round(Int, i_star)))\nend\n\n# Calculate for 298 K\nresults_298 = []\nfor S in [2, 3, 4, 5]\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => 298.0,\n            compiled.S => Float64(S),\n            compiled.σ => σ_298,\n            compiled.v_1 => v_1\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    r_star_angstrom = sol[compiled.r_star][1] * 1e10\n    i_star = sol[compiled.i_star][1]\n    push!(results_298, (\n        S = S, r_star = round(r_star_angstrom, digits = 1), i_star = round(Int, i_star)))\nend\n\n# Display results as a table\nprintln(\"Table 11.1: Critical Number and Radius for Water Droplets\")\nprintln(\"=\"^70)\nprintln(\"        T = 273 K                    T = 298 K\")\nprintln(\"S    r* (Å)    i*                r* (Å)    i*\")\nprintln(\"-\"^70)\nfor (r273, r298) in zip(results_273, results_298)\n    println(\"$(r273.S)    $(r273.r_star)       $(r273.i_star)                 $(r298.r_star)       $(r298.i_star)\")\nend\n\n# Expected values from Table 11.1\nprintln(\"\\nExpected values from Seinfeld & Pandis Table 11.1:\")\nprintln(\"T=273K: S=2: r*=17.3Å, i*=726; S=3: r*=10.9Å, i*=182; S=4: r*=8.7Å, i*=87; S=5: r*=7.5Å, i*=58\")\nprintln(\"T=298K: S=2: r*=15.1Å, i*=482; S=3: r*=9.5Å, i*=121; S=4: r*=7.6Å, i*=60; S=5: r*=6.5Å, i*=39\")","category":"section"},{"location":"nucleation/#Validation-Against-Table-11.4:-Nucleation-Rates-for-Water","page":"Nucleation","title":"Validation Against Table 11.4: Nucleation Rates for Water","text":"This reproduces Table 11.4 from Seinfeld & Pandis (2006), showing nucleation rates for water at 293 K.\n\n# Water properties at 293 K from Table 11.4\nσ_293 = 72.75e-3      # N/m\nv_1 = 2.99e-29        # m³/molecule\nm_1 = 2.99e-26        # kg/molecule\np_sat_293 = 2336.5    # Pa\n\nsys = Nucleation()\ncompiled = mtkcompile(sys)\n\nprintln(\"Table 11.4: Homogeneous Nucleation Rate and Critical Cluster Size for Water at T = 293 K\")\nprintln(\"=\"^80)\nprintln(\"S      i*      J (cm⁻³s⁻¹)           Expected J\")\nprintln(\"-\"^80)\n\nexpected_J = Dict(2 => 5.02e-54, 3 => 1.76e-6, 4 => 1.05e6, 5 => 1.57e11,\n    6 => 1.24e14, 7 => 8.99e15, 8 => 1.79e17, 9 => 1.65e18, 10 => 9.17e18)\n\nfor S in [2, 3, 4, 5, 6, 7, 8, 9, 10]\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => 293.0,\n            compiled.p_A => Float64(S) * p_sat_293,\n            compiled.p_A_s => p_sat_293,\n            compiled.σ => σ_293,\n            compiled.v_1 => v_1,\n            compiled.m_1 => m_1\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    J = sol[compiled.J][1] * 1e-6  # Convert from m⁻³s⁻¹ to cm⁻³s⁻¹\n    i_star = sol[compiled.i_star][1]\n    println(\"$(S)      $(round(Int, i_star))      $(round(J, sigdigits=3))           $(expected_J[S])\")\nend","category":"section"},{"location":"nucleation/#Figure:-Critical-Cluster-Size-vs.-Saturation-Ratio","page":"Nucleation","title":"Figure: Critical Cluster Size vs. Saturation Ratio","text":"This figure shows how the critical cluster size decreases with increasing saturation ratio, demonstrating why nucleation \"switches on\" sharply at a threshold supersaturation.\n\nusing Plots\n\nS_range = 1.5:0.1:10.0\ni_stars = Float64[]\nr_stars = Float64[]\n\nsys = CriticalCluster()\ncompiled = mtkcompile(sys)\n\nfor S in S_range\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => 293.0,\n            compiled.S => S,\n            compiled.σ => 72.75e-3,\n            compiled.v_1 => 2.99e-29\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    push!(i_stars, sol[compiled.i_star][1])\n    push!(r_stars, sol[compiled.r_star][1] * 1e10)  # Convert to Å\nend\n\np1 = plot(\n    S_range, i_stars, xlabel = \"Saturation Ratio S\", ylabel = \"Critical Cluster Size i*\",\n    label = \"i*\", lw = 2, legend = :topright, yscale = :log10,\n    title = \"Critical Cluster Size vs. Saturation Ratio (T=293K)\")\n\np2 = plot(\n    S_range, r_stars, xlabel = \"Saturation Ratio S\", ylabel = \"Critical Radius r* (Å)\",\n    label = \"r*\", lw = 2, legend = :topright,\n    title = \"Critical Radius vs. Saturation Ratio (T=293K)\")\n\nplot(p1, p2, layout = (1, 2), size = (900, 400))","category":"section"},{"location":"nucleation/#Figure:-Nucleation-Rate-vs.-Saturation-Ratio-(analogous-to-Table-11.4)","page":"Nucleation","title":"Figure: Nucleation Rate vs. Saturation Ratio (analogous to Table 11.4)","text":"This figure illustrates the extreme sensitivity of nucleation rate to saturation ratio.\n\nS_range = 2.0:0.5:10.0\nJ_rates = Float64[]\n\nsys = Nucleation()\ncompiled = mtkcompile(sys)\n\nfor S in S_range\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => 293.0,\n            compiled.p_A => S * 2336.5,\n            compiled.p_A_s => 2336.5,\n            compiled.σ => 72.75e-3,\n            compiled.v_1 => 2.99e-29,\n            compiled.m_1 => 2.99e-26\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    J = sol[compiled.J][1] * 1e-6  # Convert to cm⁻³s⁻¹\n    push!(J_rates, max(J, 1e-60))  # Floor at 1e-60 for log scale\nend\n\nplot(\n    S_range, J_rates, xlabel = \"Saturation Ratio S\", ylabel = \"Nucleation Rate J (cm⁻³s⁻¹)\",\n    label = \"J\", lw = 2, yscale = :log10,\n    title = \"Classical Nucleation Rate vs. Saturation Ratio (Water at 293K)\",\n    ylims = (1e-60, 1e25), legend = :bottomright)","category":"section"},{"location":"nucleation/#Temperature-Dependence-of-Critical-Properties","page":"Nucleation","title":"Temperature Dependence of Critical Properties","text":"This analysis shows how temperature affects critical cluster properties at a fixed saturation ratio.\n\nT_range = 250.0:5.0:320.0\nS = 4.0\n\ni_stars_T = Float64[]\nr_stars_T = Float64[]\n\n# Approximate temperature-dependent surface tension: σ ≈ 75.6 - 0.1454*(T-273) mN/m\nσ_func(T) = (75.6 - 0.1454 * (T - 273)) * 1e-3\n\nsys = CriticalCluster()\ncompiled = mtkcompile(sys)\n\nfor T in T_range\n    prob = ODEProblem(compiled,\n        Dict(\n            compiled.T => T,\n            compiled.S => S,\n            compiled.σ => σ_func(T),\n            compiled.v_1 => 2.99e-29\n        ),\n        (0.0, 1.0))\n    sol = solve(prob, Tsit5())\n    push!(i_stars_T, sol[compiled.i_star][1])\n    push!(r_stars_T, sol[compiled.r_star][1] * 1e10)\nend\n\np1 = plot(\n    T_range, i_stars_T, xlabel = \"Temperature (K)\", ylabel = \"Critical Cluster Size i*\",\n    label = \"i*\", lw = 2, title = \"Critical Cluster Size vs. Temperature (S=4)\")\n\np2 = plot(\n    T_range, r_stars_T, xlabel = \"Temperature (K)\", ylabel = \"Critical Radius r* (Å)\",\n    label = \"r*\", lw = 2, title = \"Critical Radius vs. Temperature (S=4)\")\n\nplot(p1, p2, layout = (1, 2), size = (900, 400))","category":"section"},{"location":"nucleation/#Key-Behaviors","page":"Nucleation","title":"Key Behaviors","text":"","category":"section"},{"location":"nucleation/#Saturation-Ratio-Dependence","page":"Nucleation","title":"Saturation Ratio Dependence","text":"The nucleation rate is extremely sensitive to the saturation ratio S:\n\nAt S < 2, nucleation is essentially zero for atmospheric conditions\nThe transition from negligible to significant nucleation occurs over a narrow range of S\nAt high S (> 5), the rate increases by many orders of magnitude per unit increase in S","category":"section"},{"location":"nucleation/#Temperature-Dependence","page":"Nucleation","title":"Temperature Dependence","text":"Temperature affects nucleation through multiple pathways:\n\nHigher T reduces the free energy barrier, increasing J\nHigher T increases vapor pressure, affecting S\nSurface tension typically decreases with T","category":"section"},{"location":"nucleation/#Critical-Cluster-Size","page":"Nucleation","title":"Critical Cluster Size","text":"The critical cluster size i* decreases with increasing S:\n\nAt low S, very large clusters are needed before they become stable\nAt high S, even small clusters can grow spontaneously\nThis explains why nucleation \"switches on\" sharply at a threshold S","category":"section"},{"location":"nucleation/#Limitations","page":"Nucleation","title":"Limitations","text":"Capillarity approximation: The model assumes clusters of all sizes have bulk liquid surface tension, which becomes inaccurate for small clusters (i* < 20-30).\nSingle-component only: This implementation covers homogeneous single-component nucleation. Binary nucleation (e.g., H₂SO₄-H₂O) requires additional equations not yet implemented.\nSteady-state assumption: The classical nucleation rate assumes the cluster distribution has reached steady state.\nNo kinetic effects: The model does not account for non-equilibrium effects or condensation/evaporation kinetics beyond the equilibrium rate constants.","category":"section"},{"location":"nucleation/#Aerosol.Nucleation","page":"Nucleation","title":"Aerosol.Nucleation","text":"Nucleation(; name=:Nucleation)\n\nA component representing homogeneous nucleation of a single-component vapor following classical nucleation theory from Seinfeld & Pandis (2006), Chapter 11.\n\nThis component calculates the nucleation rate, critical cluster size, and critical radius based on the saturation ratio, temperature, and species properties.\n\nVariables\n\nS: Saturation ratio (dimensionless), ratio of partial pressure to saturation vapor pressure\nJ: Nucleation rate (molecules/(m³·s))\ni_star: Critical cluster size (molecules)\nr_star: Critical cluster radius (m)\nΔG_star: Free energy barrier (J)\nθ: Dimensionless surface tension parameter\n\nParameters\n\nT: Temperature (K)\np_A: Partial pressure of condensing species (Pa)\np_A_s: Saturation vapor pressure (Pa)\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\n\nReferences\n\nSeinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 11, pp. 489-536.\n\n\n\n\n\n","category":"function"},{"location":"nucleation/#Aerosol.CriticalCluster","page":"Nucleation","title":"Aerosol.CriticalCluster","text":"CriticalCluster(; name=:CriticalCluster)\n\nA standalone component for computing critical cluster properties without the full nucleation rate calculation. Useful for parameter sensitivity studies.\n\nThis implements equations 11.35, 11.52, and 11.53 from Seinfeld & Pandis (2006).\n\nVariables\n\ni_star: Critical cluster size (molecules)\nr_star: Critical cluster radius (m)\nΔG_star: Free energy barrier (J)\nθ: Dimensionless surface tension parameter\n\nParameters\n\nT: Temperature (K)\nS: Saturation ratio\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\n\n\n\n\n\n","category":"function"},{"location":"nucleation/#Aerosol.ClassicalNucleationRate","page":"Nucleation","title":"Aerosol.ClassicalNucleationRate","text":"ClassicalNucleationRate(; name=:ClassicalNucleationRate)\n\nA simplified component that computes only the classical nucleation rate (Eq. 11.47) from Seinfeld & Pandis (2006). This is a minimal component for use when critical cluster properties are not needed.\n\nVariables\n\nJ: Nucleation rate (molecules/(m³·s))\n\nParameters\n\nT: Temperature (K)\nS: Saturation ratio\nN_1: Monomer number concentration (molecules/m³)\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\n\n\n\n\n\n","category":"function"},{"location":"nucleation/#Aerosol.WaterProperties","page":"Nucleation","title":"Aerosol.WaterProperties","text":"WaterProperties(; name=:WaterProperties)\n\nA component providing temperature-dependent physical properties of water for nucleation calculations following the data from Seinfeld & Pandis (2006), Table 11.1 and 11.4.\n\nVariables\n\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\np_sat: Saturation vapor pressure (Pa)\n\nParameters\n\nT: Temperature (K)\n\nReferences\n\nSeinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics, Chapter 11.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Organic-Atmospheric-Aerosols","page":"Organic Aerosol","title":"Organic Atmospheric Aerosols","text":"","category":"section"},{"location":"organic_aerosol/#Overview","page":"Organic Aerosol","title":"Overview","text":"This module implements key equations from Chapter 14 of Seinfeld and Pandis (2006) for organic atmospheric aerosol modeling, including:\n\nThe EC tracer method for estimating secondary organic carbon\nGas-particle partitioning models for SOA formation (noninteracting, absorptive, two-product)\nAdsorption isotherms (Langmuir, BET, FHH)\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.","category":"section"},{"location":"organic_aerosol/#Implementation","page":"Organic Aerosol","title":"Implementation","text":"","category":"section"},{"location":"organic_aerosol/#EC-Tracer-Method-(Section-14.3.2)","page":"Organic Aerosol","title":"EC Tracer Method (Section 14.3.2)","text":"The EC tracer method estimates secondary organic carbon from measurements of total OC and EC.\n\nusing Aerosol\nusing ModelingToolkit\nusing DataFrames, Symbolics, DynamicQuantities\n\nsys = ECTracerMethod()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape=false)) for v in vars],\n    :Units => [string(dimension(ModelingToolkit.get_unit(v))) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)\n\nequations(sys)","category":"section"},{"location":"organic_aerosol/#Noninteracting-SOA-(Section-14.5.2)","page":"Organic Aerosol","title":"Noninteracting SOA (Section 14.5.2)","text":"Gas-particle partitioning for a compound that condenses as a pure phase.\n\nsys_ni = NoninteractingSOA()\nvars = unknowns(sys_ni)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape=false)) for v in vars],\n    :Units => [string(dimension(ModelingToolkit.get_unit(v))) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)\n\nequations(sys_ni)","category":"section"},{"location":"organic_aerosol/#Absorptive-Partitioning-(Section-14.5.2)","page":"Organic Aerosol","title":"Absorptive Partitioning (Section 14.5.2)","text":"SOA formation by absorption into a preexisting organic aerosol phase.\n\nsys_ap = AbsorptivePartitioning()\nvars = unknowns(sys_ap)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape=false)) for v in vars],\n    :Units => [string(dimension(ModelingToolkit.get_unit(v))) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)\n\nequations(sys_ap)","category":"section"},{"location":"organic_aerosol/#Two-Product-SOA-Model-(Section-14.5.2)","page":"Organic Aerosol","title":"Two-Product SOA Model (Section 14.5.2)","text":"The Odum et al. (1996) two-product model for SOA formation.\n\nsys_tp = TwoProductSOA()\nvars = unknowns(sys_tp)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape=false)) for v in vars],\n    :Units => [string(dimension(ModelingToolkit.get_unit(v))) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)\n\nequations(sys_tp)","category":"section"},{"location":"organic_aerosol/#Table-14.12:-Two-Product-SOA-Model-Parameters","page":"Organic Aerosol","title":"Table 14.12: Two-Product SOA Model Parameters","text":"Parameters for the two-product model from Seinfeld and Pandis (2006), Table 14.12. Default values correspond to α-pinene/OH oxidation.\n\nParent ROG Oxidant α₁ α₂ c₁° (μg/m³) c₂° (μg/m³)\nToluene OH 0.071 0.138 18.9 526\nXylenes OH 0.038 0.167 23.8 714\nα-pinene OH 0.038 0.326 5.8 250\nα-pinene O₃ 0.125 0.102 11.4 12.7\nβ-pinene OH 0.13 0.041 22.7 204\nβ-pinene O₃ 0.21 0.49 5.1 333\nΔ³-carene OH 0.054 0.517 23.2 238\nΔ³-carene O₃ 0.128 0.068 7.8 14.7\nΔ³-carene NO₃ 0.743 0.257 113 120\nCaryophyllene OH 1.0 - 23 -\nHumulene OH 1.0 - 20 -\n\nNote: Molar stoichiometric yields (α) are derived assuming that the precursor and the SOA species have the same molecular weight. Saturation mixing ratios (c°) are based on experiments at around 310 K. Source: Griffin et al. (1999).\n\nThe saturation concentrations c₁° and c₂° in the table are in μg/m³. The implementation uses SI units (kg/m³), so multiply by 10⁻⁹ when setting parameters.","category":"section"},{"location":"organic_aerosol/#Adsorption-Isotherms-(Section-14.5.3)","page":"Organic Aerosol","title":"Adsorption Isotherms (Section 14.5.3)","text":"sys_lang = LangmuirAdsorption()\nequations(sys_lang)\n\nsys_bet = BETAdsorption()\nequations(sys_bet)\n\nsys_fhh = FHHAdsorption()\nequations(sys_fhh)","category":"section"},{"location":"organic_aerosol/#Analysis","page":"Organic Aerosol","title":"Analysis","text":"","category":"section"},{"location":"organic_aerosol/#Noninteracting-SOA:-Aerosol-Yield-vs-Reacted-ROG","page":"Organic Aerosol","title":"Noninteracting SOA: Aerosol Yield vs Reacted ROG","text":"This figure demonstrates the threshold behavior of noninteracting SOA formation. Below the threshold ΔROG, all product remains in the gas phase. Above it, the aerosol yield increases with increasing reacted ROG.\n\nusing NonlinearSolve, Plots\n\nsys_ni = NoninteractingSOA()\nsys_ni_nns = ModelingToolkit.toggle_namespacing(sys_ni, false)\nssys_ni = mtkcompile(sys_ni; inputs=[sys_ni_nns.ΔROG])\n\n# Compute threshold from default parameters\nR = 8.314; T = 298.0; p_i = 1.01325e-5; M_i = 0.180; M_ROG = 0.150; a_i = 0.05\nthreshold = p_i * M_ROG / (a_i * R * T)\n\n# Sweep ΔROG from 0 to 20× threshold\nΔROG_vals = range(0, 20 * threshold, length=200)\nY_vals = Float64[]\nfor drog in ΔROG_vals\n    prob = NonlinearProblem(ssys_ni, Dict(\n        ssys_ni.ΔROG => drog,\n        ssys_ni.c_eq => 1e-10, ssys_ni.c_total => 1e-10,\n        ssys_ni.c_aer => 1e-10, ssys_ni.c_gas => 1e-10,\n        ssys_ni.ΔROG_threshold => 1e-10,\n        ssys_ni.X_p => 0.5, ssys_ni.Y => 0.01))\n    sol = solve(prob)\n    push!(Y_vals, sol[ssys_ni.Y])\nend\n\nplot(ΔROG_vals ./ threshold, Y_vals,\n    xlabel=\"ΔROG / ΔROG*\", ylabel=\"Aerosol Mass Yield Y\",\n    title=\"Noninteracting SOA: Yield vs Reacted ROG\",\n    label=\"Y (Eq. 14.16)\", legend=:bottomright, lw=2)\nvline!([1.0], label=\"Threshold ΔROG*\", ls=:dash, color=:red)","category":"section"},{"location":"organic_aerosol/#Absorptive-Partitioning:-Effect-of-Preexisting-OA","page":"Organic Aerosol","title":"Absorptive Partitioning: Effect of Preexisting OA","text":"When preexisting organic aerosol is present, there is no threshold for SOA formation. The aerosol mass fraction X_p depends on the ratio of absorbing medium concentration to vapor pressure.\n\nsys_ap = AbsorptivePartitioning()\nsys_ap_nns = ModelingToolkit.toggle_namespacing(sys_ap, false)\nssys_ap = mtkcompile(sys_ap; inputs=[sys_ap_nns.ΔROG])\n\n# Sweep m_0 (preexisting OA) from 0.1 to 100 μg/m³\nm0_vals = 10 .^ range(-10, -7, length=100)  # kg/m³\nXp_vals = Float64[]\nfor m0 in m0_vals\n    prob = NonlinearProblem(ssys_ap, Dict(\n        ssys_ap.ΔROG => 50e-9,\n        ssys_ap.c_aer => 1e-10, ssys_ap.X_p => 0.5, ssys_ap.Y => 0.01,\n        ssys_ap.m_0 => m0))\n    sol = solve(prob)\n    push!(Xp_vals, sol[ssys_ap.X_p])\nend\n\nplot(m0_vals * 1e9, Xp_vals,\n    xlabel=\"Preexisting OA m₀ (μg/m³)\", ylabel=\"Mass Fraction in Aerosol X_p\",\n    title=\"Absorptive Partitioning: X_p vs m₀ (Eq. 14.25)\",\n    label=\"X_p\", xscale=:log10, lw=2, legend=:bottomright)","category":"section"},{"location":"organic_aerosol/#Two-Product-Model:-Odum-Yield-Curve","page":"Organic Aerosol","title":"Two-Product Model: Odum Yield Curve","text":"The two-product model (Odum et al., 1996) shows that aerosol yield increases with increasing organic aerosol concentration. This nonlinear behavior is captured by Equation 14.43.\n\nsys_tp = TwoProductSOA()\nsys_tp_nns = ModelingToolkit.toggle_namespacing(sys_tp, false)\nssys_tp = mtkcompile(sys_tp; inputs=[sys_tp_nns.ΔROG])\n\n# Default α-pinene/OH parameters\na_1 = 0.038; a_2 = 0.326\nc_sat_1 = 5.8e-9; c_sat_2 = 250.0e-9  # kg/m³\n\n# Sweep ΔROG and plot Y vs c_aer (Odum plot)\nΔROG_vals = 10 .^ range(-10, -6, length=100)  # kg/m³\nc_aer_vals = Float64[]\nY_vals = Float64[]\n\nfor drog in ΔROG_vals\n    prob = NonlinearProblem(ssys_tp, Dict(\n        ssys_tp.ΔROG => drog,\n        ssys_tp.c_aer => drog * 0.1,\n        ssys_tp.Y => 0.1, ssys_tp.ΔROG_threshold => 1e-9))\n    sol = solve(prob)\n    push!(c_aer_vals, sol[ssys_tp.c_aer])\n    push!(Y_vals, sol[ssys_tp.Y])\nend\n\nplot(c_aer_vals * 1e9, Y_vals,\n    xlabel=\"Organic Aerosol m₀ (μg/m³)\", ylabel=\"Aerosol Yield Y\",\n    title=\"Two-Product Model: Yield vs Organic Aerosol (Eq. 14.43)\",\n    label=\"α-pinene/OH\", xscale=:log10, lw=2, legend=:bottomright)","category":"section"},{"location":"organic_aerosol/#Langmuir-Adsorption-Isotherm","page":"Organic Aerosol","title":"Langmuir Adsorption Isotherm","text":"The Langmuir isotherm shows saturation behavior at high pressures.\n\nsys_lang = LangmuirAdsorption()\nsys_lang_nns = ModelingToolkit.toggle_namespacing(sys_lang, false)\nssys_lang = mtkcompile(sys_lang; inputs=[sys_lang_nns.p])\n\np_vals = 10 .^ range(-3, 3, length=200)\nV_vals = Float64[]\nfor pv in p_vals\n    prob = NonlinearProblem(ssys_lang, Dict(ssys_lang.p => pv, ssys_lang.V => 0.5))\n    sol = solve(prob)\n    push!(V_vals, sol[ssys_lang.V])\nend\n\nplot(p_vals, V_vals,\n    xlabel=\"Pressure p (Pa)\", ylabel=\"Adsorbed Volume V (m³)\",\n    title=\"Langmuir Adsorption Isotherm (Eq. 14.44)\",\n    label=\"V/V_m\", xscale=:log10, lw=2, legend=:bottomright)\nhline!([1.0], label=\"V_m (monolayer)\", ls=:dash, color=:red)","category":"section"},{"location":"organic_aerosol/#Comparison-of-BET-and-Langmuir-Isotherms","page":"Organic Aerosol","title":"Comparison of BET and Langmuir Isotherms","text":"The BET isotherm extends the Langmuir model to multilayer adsorption. At low saturation ratios, both isotherms agree; at higher values, BET predicts additional adsorption layers.\n\nsys_bet = BETAdsorption()\nsys_bet_nns = ModelingToolkit.toggle_namespacing(sys_bet, false)\nssys_bet = mtkcompile(sys_bet; inputs=[sys_bet_nns.S])\n\nS_vals = range(0.01, 0.95, length=200)\nV_bet = Float64[]\nV_lang = Float64[]\nc_BET = 10.0\n\nfor sv in S_vals\n    # BET\n    prob_bet = NonlinearProblem(ssys_bet, Dict(ssys_bet.S => sv, ssys_bet.V => 1.0))\n    sol_bet = solve(prob_bet)\n    push!(V_bet, sol_bet[ssys_bet.V])\n\n    # Equivalent Langmuir: b*p = c_BET*S\n    prob_lang = NonlinearProblem(ssys_lang, Dict(ssys_lang.p => c_BET * sv, ssys_lang.V => 0.5))\n    sol_lang = solve(prob_lang)\n    push!(V_lang, sol_lang[ssys_lang.V])\nend\n\nplot(S_vals, V_bet, label=\"BET (c=10)\", lw=2,\n    xlabel=\"Saturation Ratio S\", ylabel=\"V / V_m\",\n    title=\"BET vs Langmuir Isotherms\")\nplot!(S_vals, V_lang, label=\"Langmuir (b·p = c·S)\", lw=2, ls=:dash)\nhline!([1.0], label=\"Monolayer\", ls=:dot, color=:gray)","category":"section"},{"location":"organic_aerosol/#Aerosol.ECTracerMethod","page":"Organic Aerosol","title":"Aerosol.ECTracerMethod","text":"ECTracerMethod(; name=:ECTracerMethod)\n\nThe elemental carbon (EC) tracer method for estimating secondary organic carbon (OC) concentrations from measurements of total OC and EC.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.3.2, Equations 14.1-14.4.\n\nPrimary OC is estimated as the sum of combustion-related OC (proportional to EC via the OC_EC_ratio) and noncombustion OC (OC_NC). Secondary OC is the remainder.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.NoninteractingSOA","page":"Organic Aerosol","title":"Aerosol.NoninteractingSOA","text":"NoninteractingSOA(; name=:NoninteractingSOA)\n\nGas-particle partitioning model for a secondary organic aerosol (SOA) compound that does not interact with preexisting aerosol components. The compound exists in the aerosol phase as pure compound, so gas-aerosol equilibrium is reached when the gas-phase concentration equals the saturation concentration.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.6-14.18.\n\nThe aerosol concentration is zero until the reacted ROG exceeds the threshold ΔROG*_i = p°_i M_ROG / (a_i R T), after which the excess condenses.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.AbsorptivePartitioning","page":"Organic Aerosol","title":"Aerosol.AbsorptivePartitioning","text":"AbsorptivePartitioning(; name=:AbsorptivePartitioning)\n\nGas-particle partitioning model for SOA formation by absorption into a preexisting organic aerosol phase, assuming an ideal solution. There is no threshold for SOA formation; secondary aerosol forms as soon as the ROG starts reacting.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.19-14.26.\n\nUses the dilute approximation c_{aer,i} << m_0 (Eq. 14.23), valid when no single compound dominates the organic aerosol composition.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.TwoProductSOA","page":"Organic Aerosol","title":"Aerosol.TwoProductSOA","text":"TwoProductSOA(; name=:TwoProductSOA)\n\nThe two-product model for secondary organic aerosol (SOA) formation, developed by Odum et al. (1996). This model represents the complex mixture of oxidation products from a reactive organic gas (ROG) as two lumped surrogate products that form an ideal solution.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.27-14.43.\n\nThe key equation (14.43) gives the overall aerosol mass yield:\n\nY = c_aer * (a₁/(c_aer + c₁°) + a₂/(c_aer + c₂°))\n\nwhere a_i are stoichiometric yields and c_i° are saturation concentrations.\n\nParameters from Table 14.12 are provided for multiple VOC precursors.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\nSee also: Odum, J. R. et al. (1996). Gas/Particle Partitioning and Secondary Organic Aerosol Yields. Environ. Sci. Technol., 30, 2580-2585.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.LangmuirAdsorption","page":"Organic Aerosol","title":"Aerosol.LangmuirAdsorption","text":"LangmuirAdsorption(; name=:LangmuirAdsorption)\n\nLangmuir adsorption isotherm for the formation of a monolayer of adsorbed molecules on particle surfaces. Assumes all adsorption sites are equivalent, no horizontal interactions, and uniform heat of adsorption.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.44.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.BETAdsorption","page":"Organic Aerosol","title":"Aerosol.BETAdsorption","text":"BETAdsorption(; name=:BETAdsorption)\n\nBET (Brunauer-Emmett-Teller) adsorption isotherm for multilayer adsorption. Extends the Langmuir model to include formation of additional molecular layers, assuming each adsorbed molecule can serve as an adsorption site for the next layer.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.45.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"organic_aerosol/#Aerosol.FHHAdsorption","page":"Organic Aerosol","title":"Aerosol.FHHAdsorption","text":"FHHAdsorption(; name=:FHHAdsorption)\n\nFHH (Frenkel-Halsey-Hill) adsorption isotherm, appropriate for conditions near saturation where the BET theory breaks down. Relates the logarithm of the supersaturation ratio to the adsorbed volume.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.46.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Mass-Transfer-to-Atmospheric-Particles","page":"Mass Transfer","title":"Mass Transfer to Atmospheric Particles","text":"","category":"section"},{"location":"mass_transfer/#Overview","page":"Mass Transfer","title":"Overview","text":"This module implements the fundamental equations describing mass transfer between gas and particle phases in the atmosphere. The treatment covers three transport regimes based on the Knudsen number (Kn = λ/Rp, ratio of mean free path to particle radius):\n\nContinuum regime (Kn ≪ 1): Applicable to large particles where Fick's law of diffusion governs transport\nKinetic regime (Kn ≫ 1): Applicable to small particles where molecular kinetic theory governs transport\nTransition regime (Kn ~ 1): Requires interpolation formulas bridging the two limiting cases\n\nThe implementation includes:\n\nTransition regime correction factors (Fuchs-Sutugin, Dahneke)\nMaxwellian flux for particle growth/evaporation\nMass transfer coefficients for gas-particle exchange\nCharacteristic timescales for various mass transport processes\nAqueous-phase chemistry and mass transport coupling\n\nReference: Seinfeld, J.H. and Pandis, S.N. (2006) \"Atmospheric Chemistry and Physics: From Air Pollution to Climate Change\", 2nd Edition, John Wiley & Sons, Chapter 12, pp. 537-587.","category":"section"},{"location":"mass_transfer/#Implementation","page":"Mass Transfer","title":"Implementation","text":"","category":"section"},{"location":"mass_transfer/#Transition-Regime-Mass-Transfer","page":"Mass Transfer","title":"Transition Regime Mass Transfer","text":"The Fuchs-Sutugin formula is the most widely used expression for mass transfer across the full range of Knudsen numbers:\n\nusing Aerosol\nusing ModelingToolkit\nimport ModelingToolkit: mtkcompile\nusing NonlinearSolve\nusing Plots\n\n# Create the Fuchs-Sutugin system\nsys = FuchsSutugin()\ncompiled = mtkcompile(sys)\n\n# Calculate correction factor across Knudsen number range\nKn_range = 10 .^ range(-2, 2, length = 100)\nf_FS_α1 = Float64[]\nf_FS_α01 = Float64[]\nf_FS_α001 = Float64[]\n\nfor Kn in Kn_range\n    prob = NonlinearProblem(compiled, Dict(compiled.Kn => Kn, compiled.α => 1.0))\n    push!(f_FS_α1, solve(prob)[compiled.f_FS])\n\n    prob = NonlinearProblem(compiled, Dict(compiled.Kn => Kn, compiled.α => 0.1))\n    push!(f_FS_α01, solve(prob)[compiled.f_FS])\n\n    prob = NonlinearProblem(compiled, Dict(compiled.Kn => Kn, compiled.α => 0.01))\n    push!(f_FS_α001, solve(prob)[compiled.f_FS])\nend\n\nplot(Kn_range, f_FS_α1, label = \"α = 1.0\", xscale = :log10,\n    xlabel = \"Knudsen Number (Kn)\", ylabel = \"J/Jc (Correction Factor)\",\n    title = \"Fuchs-Sutugin Transition Regime Correction\")\nplot!(Kn_range, f_FS_α01, label = \"α = 0.1\")\nplot!(Kn_range, f_FS_α001, label = \"α = 0.01\")\nsavefig(\"fuchs_sutugin.svg\");\nnothing # hide\n\n(Image: Fuchs-Sutugin correction factor)\n\nThe correction factor approaches 1 in the continuum limit (Kn → 0) and decreases in the kinetic regime (Kn → ∞). Lower accommodation coefficients (α) reduce the mass transfer rate.","category":"section"},{"location":"mass_transfer/#State-Variables","page":"Mass Transfer","title":"State Variables","text":"using DataFrames, Symbolics, DynamicQuantities\n\nsys = MassTransfer()\nvars = ModelingToolkit.unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(DynamicQuantities.dimension(ModelingToolkit.get_unit(v)))\n               for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"mass_transfer/#Parameters","page":"Mass Transfer","title":"Parameters","text":"params = ModelingToolkit.parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(DynamicQuantities.dimension(ModelingToolkit.get_unit(p)))\n               for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"mass_transfer/#Equations","page":"Mass Transfer","title":"Equations","text":"equations(sys)","category":"section"},{"location":"mass_transfer/#Characteristic-Timescales","page":"Mass Transfer","title":"Characteristic Timescales","text":"The module also provides components for calculating characteristic timescales of various mass transport processes:","category":"section"},{"location":"mass_transfer/#Timescale-Comparison","page":"Mass Transfer","title":"Timescale Comparison","text":"using Aerosol\n\n# Calculate timescales for a 10 μm droplet\nsys_dg = GasDiffusionTimescale()\nsys_da = AqueousDiffusionTimescale()\n\ncompiled_dg = mtkcompile(sys_dg)\ncompiled_da = mtkcompile(sys_da)\n\nR_p = 1.0e-5  # 10 μm\nD_g = 2.0e-5  # m²/s (gas-phase diffusivity)\nD_aq = 1.0e-9  # m²/s (aqueous-phase diffusivity)\n\nprob_dg = NonlinearProblem(compiled_dg, Dict(compiled_dg.R_p => R_p, compiled_dg.D_g => D_g))\nτ_dg = solve(prob_dg)[compiled_dg.τ_dg]\n\nprob_da = NonlinearProblem(compiled_da, Dict(compiled_da.R_p => R_p, compiled_da.D_aq => D_aq))\nτ_da = solve(prob_da)[compiled_da.τ_da]\n\nprintln(\"Gas-phase diffusion timescale: $(round(τ_dg * 1e6, digits=2)) μs\")\nprintln(\"Aqueous-phase diffusion timescale: $(round(τ_da * 1e3, digits=2)) ms\")\nprintln(\"Ratio τ_da/τ_dg: $(round(τ_da/τ_dg, digits=0))\")","category":"section"},{"location":"mass_transfer/#Aqueous-Phase-Chemistry-Coupling","page":"Mass Transfer","title":"Aqueous-Phase Chemistry Coupling","text":"For droplet chemistry applications, the module provides components for mass transport limitations and coupled gas-aqueous dynamics:","category":"section"},{"location":"mass_transfer/#Mass-Transport-Limitation-Criteria","page":"Mass Transfer","title":"Mass Transport Limitation Criteria","text":"The following example calculates the limiting reaction rates below which mass transport does not limit aqueous-phase chemistry:\n\nusing Aerosol\n\nsys = MassTransportLimitation()\ncompiled = mtkcompile(sys)\n\n# Parameters for a 10 μm droplet at 298 K\nprob = NonlinearProblem(compiled,\n    Dict(\n        compiled.R_p => 1.0e-5, compiled.D_g => 2.0e-5, compiled.D_aq => 1.0e-9,\n        compiled.T => 298.15, compiled.α => 1.0, compiled.M_A => 0.029))\nsol = solve(prob)\n\nprintln(\"Gas-phase diffusion limit for k₁H*: $(sol[compiled.k1H_gas_limit]) mol/(m³·Pa·s)\")\nprintln(\"Aqueous-phase diffusion limit for k₁: $(sol[compiled.k1_aq_limit]) s⁻¹\")\nprintln(\"Interfacial transport limit for k₁H*: $(sol[compiled.k1H_interface_limit]) mol/(m³·Pa·s)\")","category":"section"},{"location":"mass_transfer/#Analysis","page":"Mass Transfer","title":"Analysis","text":"","category":"section"},{"location":"mass_transfer/#Comparison-of-Transition-Regime-Formulas","page":"Mass Transfer","title":"Comparison of Transition Regime Formulas","text":"Figure 12.2 in Seinfeld & Pandis compares different transition regime formulas. Here we compare Fuchs-Sutugin and Dahneke:\n\nsys_fs = FuchsSutugin()\nsys_d = Dahneke()\ncompiled_fs = mtkcompile(sys_fs)\ncompiled_d = mtkcompile(sys_d)\n\nKn_range = 10 .^ range(-2, 2, length = 100)\nf_FS = Float64[]\nf_D = Float64[]\n\nfor Kn in Kn_range\n    prob_fs = NonlinearProblem(compiled_fs, Dict(compiled_fs.Kn => Kn, compiled_fs.α => 1.0))\n    push!(f_FS, solve(prob_fs)[compiled_fs.f_FS])\n\n    prob_d = NonlinearProblem(compiled_d, Dict(compiled_d.Kn => Kn, compiled_d.α => 1.0))\n    push!(f_D, solve(prob_d)[compiled_d.f_D])\nend\n\nplot(Kn_range, f_FS, label = \"Fuchs-Sutugin\", xscale = :log10,\n    xlabel = \"Knudsen Number (Kn)\", ylabel = \"J/Jc\",\n    title = \"Comparison of Transition Regime Formulas (α = 1)\")\nplot!(Kn_range, f_D, label = \"Dahneke\", linestyle = :dash)\nsavefig(\"transition_comparison.svg\");\nnothing # hide\n\n(Image: Transition regime formula comparison)\n\nBoth formulas agree in the limiting regimes but show slight differences in the transition regime (Kn ~ 1).","category":"section"},{"location":"mass_transfer/#Particle-Size-Dependence","page":"Mass Transfer","title":"Particle Size Dependence","text":"The mass transfer regime depends strongly on particle size through the Knudsen number:\n\nsys = MassTransfer()\ncompiled = mtkcompile(sys)\n\n# Calculate for particle diameters from 10 nm to 10 μm\nD_p_range = 10 .^ range(-8, -5, length = 50)  # meters\nR_p_range = D_p_range ./ 2\n\nKn_vals = Float64[]\nf_FS_vals = Float64[]\n\nfor R_p in R_p_range\n    prob = NonlinearProblem(compiled,\n        Dict(\n            compiled.R_p => R_p, compiled.α => 1.0,\n            compiled.c_inf => 1.0e-6, compiled.c_s => 0.0))\n    sol = solve(prob)\n    push!(Kn_vals, sol[compiled.Kn])\n    push!(f_FS_vals, sol[compiled.f_FS])\nend\n\nplot(D_p_range .* 1e6, Kn_vals, label = \"Knudsen Number\", xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\", ylabel = \"Kn or J/Jc\",\n    title = \"Particle Size Dependence\")\nplot!(D_p_range .* 1e6, f_FS_vals, label = \"J/Jc (Fuchs-Sutugin)\")\nhline!([1.0], label = \"Kn = 1 (transition)\", linestyle = :dash, color = :gray)\nsavefig(\"size_dependence.svg\");\nnothing # hide\n\n(Image: Particle size dependence)\n\nSmall particles (< 100 nm) are in the kinetic or transition regime where mass transfer is significantly reduced compared to the continuum limit.","category":"section"},{"location":"mass_transfer/#Aerosol.MassTransfer","page":"Mass Transfer","title":"Aerosol.MassTransfer","text":"MassTransfer(; name=:MassTransfer)\n\nComplete mass transfer model combining transition regime correction, gas-phase diffusion, and interfacial transport.\n\nThis component provides the transition-regime corrected mass flux for particle growth/evaporation, applicable across all Knudsen numbers.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Sections 12.1.1-12.1.4\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.FuchsSutugin","page":"Mass Transfer","title":"Aerosol.FuchsSutugin","text":"FuchsSutugin(; name=:FuchsSutugin)\n\nFuchs-Sutugin transition regime correction for mass transfer.\n\nThis is the most widely used formula for transition regime mass transfer due to its simplicity and accuracy across the full Knudsen number range.\n\nReturns the ratio J/Jc where Jc is the continuum regime flux.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.43 (with accommodation coefficient)\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.Dahneke","page":"Mass Transfer","title":"Aerosol.Dahneke","text":"Dahneke(; name=:Dahneke)\n\nDahneke transition regime correction for mass transfer.\n\nAn alternative interpolation formula for the transition regime.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.42\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.MaxwellianFlux","page":"Mass Transfer","title":"Aerosol.MaxwellianFlux","text":"MaxwellianFlux(; name=:MaxwellianFlux)\n\nCalculate the Maxwellian (continuum regime) molar flux to a particle.\n\nThis is the steady-state diffusive flux in the continuum regime (Kn ≪ 1).\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.12\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.MassTransferCoefficient","page":"Mass Transfer","title":"Aerosol.MassTransferCoefficient","text":"MassTransferCoefficient(; name=:MassTransferCoefficient)\n\nCalculate the combined gas-phase and interfacial mass transfer coefficient.\n\nThis coefficient accounts for both gas-phase diffusion and interfacial resistance to mass transfer.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.116\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.UptakeCoefficient","page":"Mass Transfer","title":"Aerosol.UptakeCoefficient","text":"UptakeCoefficient(; name=:UptakeCoefficient)\n\nCalculate the uptake coefficient γ for gas-particle mass transfer.\n\nThe uptake coefficient is the probability that a molecule striking the particle surface is taken up by the particle.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.121\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.GasDiffusionTimescale","page":"Mass Transfer","title":"Aerosol.GasDiffusionTimescale","text":"GasDiffusionTimescale(; name=:GasDiffusionTimescale)\n\nCharacteristic timescale for gas-phase diffusion to a particle.\n\nThis is the time required for a gas-phase concentration perturbation to diffuse to the particle surface.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.49\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.AqueousDiffusionTimescale","page":"Mass Transfer","title":"Aerosol.AqueousDiffusionTimescale","text":"AqueousDiffusionTimescale(; name=:AqueousDiffusionTimescale)\n\nCharacteristic timescale for aqueous-phase diffusion within a droplet.\n\nThis is the time for a dissolved species to diffuse throughout the droplet interior.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.75\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.InterfacialTimescale","page":"Mass Transfer","title":"Aerosol.InterfacialTimescale","text":"InterfacialTimescale(; name=:InterfacialTimescale)\n\nCharacteristic timescale to achieve equilibrium at the gas-particle interface.\n\nFor very soluble gases, the timescale is controlled by interfacial transport. For low solubility gases, the timescale is controlled by aqueous diffusion.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.61-12.62\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.ReactionTimescale","page":"Mass Transfer","title":"Aerosol.ReactionTimescale","text":"ReactionTimescale(; name=:ReactionTimescale)\n\nCharacteristic timescale for aqueous-phase chemical reactions.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.76-12.78\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.SolidEquilibrationTimescale","page":"Mass Transfer","title":"Aerosol.SolidEquilibrationTimescale","text":"SolidEquilibrationTimescale(; name=:SolidEquilibrationTimescale)\n\nCharacteristic timescale for a gas to equilibrate with solid aerosol particles.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.135, 12.139\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.AqueousEquilibrationTimescale","page":"Mass Transfer","title":"Aerosol.AqueousEquilibrationTimescale","text":"AqueousEquilibrationTimescale(; name=:AqueousEquilibrationTimescale)\n\nCharacteristic timescale for a gas to equilibrate with aqueous aerosol particles.\n\nThis accounts for the additional buffering effect of Henry's law dissolution.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.147\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.AqueousDiffusionReaction","page":"Mass Transfer","title":"Aerosol.AqueousDiffusionReaction","text":"AqueousDiffusionReaction(; name=:AqueousDiffusionReaction)\n\nCalculate the correction factor Q for aqueous-phase reaction rate when diffusion within the droplet limits the reaction.\n\nThe factor Q accounts for concentration gradients within the droplet due to fast reactions near the surface depleting reactants.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.110\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.MassTransportLimitation","page":"Mass Transfer","title":"Aerosol.MassTransportLimitation","text":"MassTransportLimitation(; name=:MassTransportLimitation)\n\nEvaluate mass transport limitation criteria for aqueous-phase chemistry.\n\nComputes the limiting values of k₁H* below which mass transport does not limit the aqueous-phase reaction rate (within 10%).\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.85, 12.86, 12.93\n\n\n\n\n\n","category":"function"},{"location":"mass_transfer/#Aerosol.DropletMassBalance","page":"Mass Transfer","title":"Aerosol.DropletMassBalance","text":"DropletMassBalance(; name=:DropletMassBalance)\n\nCoupled gas-phase and aqueous-phase mass balance for cloud droplet chemistry.\n\nThis model couples:\n\nGas-phase partial pressure evolution\nAqueous-phase concentration evolution\nMass transfer between phases\nAqueous-phase chemical reaction\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.122-12.123\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Single-Particle-Dynamics","page":"Single Particle Dynamics","title":"Single Particle Dynamics","text":"","category":"section"},{"location":"single_particle_dynamics/#Overview","page":"Single Particle Dynamics","title":"Overview","text":"This module implements equations for the dynamics of single aerosol particles, covering the fundamental physics that govern particle motion, transport, and interactions with gas molecules. These equations are essential for understanding aerosol behavior in the atmosphere, including sedimentation, diffusion, and electrical migration.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 9: Dynamics of Single Aerosol Particles, pp. 396-433. John Wiley & Sons, Inc.","category":"section"},{"location":"single_particle_dynamics/#Implementation","page":"Single Particle Dynamics","title":"Implementation","text":"The implementation provides several components that can be used individually or combined through the comprehensive SingleParticleDynamics component.","category":"section"},{"location":"single_particle_dynamics/#Key-Physical-Quantities","page":"Single Particle Dynamics","title":"Key Physical Quantities","text":"The implementation calculates the following key quantities:\n\nQuantity Symbol Equation Description\nMean free path λ Eq. 9.6 Average distance traveled by air molecules between collisions\nKnudsen number Kn Eq. 9.1 Ratio of mean free path to particle diameter\nSlip correction Cc Eq. 9.34 Correction for non-continuum effects\nRelaxation time τ Eq. 9.38 Time constant for velocity adjustment\nTerminal velocity vt Eq. 9.42 Steady-state settling velocity\nDiffusion coefficient D Eq. 9.73 Brownian diffusivity\nParticle mobility B Eq. 9.78 Mechanical mobility","category":"section"},{"location":"single_particle_dynamics/#State-Variables","page":"Single Particle Dynamics","title":"State Variables","text":"using Aerosol, ModelingToolkit, DataFrames, DynamicQuantities\n\nsys = SingleParticleDynamics()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(v) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"single_particle_dynamics/#Parameters","page":"Single Particle Dynamics","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(p) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"single_particle_dynamics/#Equations","page":"Single Particle Dynamics","title":"Equations","text":"equations(sys)","category":"section"},{"location":"single_particle_dynamics/#Analysis","page":"Single Particle Dynamics","title":"Analysis","text":"","category":"section"},{"location":"single_particle_dynamics/#Slip-Correction-Factor-vs-Particle-Size","page":"Single Particle Dynamics","title":"Slip Correction Factor vs Particle Size","text":"The Cunningham slip correction factor (Eq. 9.34) accounts for non-continuum effects when particle size approaches the mean free path of gas molecules. For particles much larger than the mean free path, Cc approaches 1 (continuum regime). For smaller particles, Cc increases significantly.\n\nusing Plots, NonlinearSolve\n\nsys = SingleParticleDynamics()\ncsys = mtkcompile(sys)\n\n# Calculate Cc for different particle sizes\nD_p_range = 10 .^ range(-9, -4, length = 50)  # 1 nm to 100 μm\nC_c_values = Float64[]\nKn_values = Float64[]\n\nfor D_p in D_p_range\n    prob = NonlinearProblem(csys, Dict(), Dict(csys.D_p => D_p))\n    sol = solve(prob)\n    push!(C_c_values, sol[csys.C_c])\n    push!(Kn_values, sol[csys.Kn])\nend\n\np1 = plot(D_p_range * 1e6, C_c_values,\n    xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"Slip Correction Factor Cc\",\n    title = \"Cunningham Slip Correction (Eq. 9.34)\",\n    legend = false, linewidth = 2)\nhline!([1.0], linestyle = :dash, color = :gray, label = \"Continuum limit\")","category":"section"},{"location":"single_particle_dynamics/#Terminal-Settling-Velocity-vs-Particle-Size","page":"Single Particle Dynamics","title":"Terminal Settling Velocity vs Particle Size","text":"The terminal settling velocity (Eq. 9.42) shows the balance between gravitational force and drag. Larger particles settle faster due to their greater mass.\n\nv_t_values = Float64[]\n\nfor D_p in D_p_range\n    prob = NonlinearProblem(csys, Dict(), Dict(csys.D_p => D_p))\n    sol = solve(prob)\n    push!(v_t_values, sol[csys.v_t])\nend\n\np2 = plot(D_p_range * 1e6, v_t_values * 100 * 3600,  # Convert to cm/h\n    xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"Terminal Velocity (cm/h)\",\n    title = \"Settling Velocity (Eq. 9.42)\",\n    legend = false, linewidth = 2)","category":"section"},{"location":"single_particle_dynamics/#Brownian-Diffusion-Coefficient-vs-Particle-Size","page":"Single Particle Dynamics","title":"Brownian Diffusion Coefficient vs Particle Size","text":"The Stokes-Einstein-Sutherland relation (Eq. 9.73) shows that smaller particles have larger diffusion coefficients, allowing them to spread more rapidly through random Brownian motion.\n\nD_B_values = Float64[]\n\nfor D_p in D_p_range\n    prob = NonlinearProblem(csys, Dict(), Dict(csys.D_p => D_p))\n    sol = solve(prob)\n    push!(D_B_values, sol[csys.D_B])\nend\n\np3 = plot(D_p_range * 1e6, D_B_values * 1e4,  # Convert to cm²/s\n    xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"Diffusion Coefficient (cm²/s)\",\n    title = \"Brownian Diffusivity (Eq. 9.73)\",\n    legend = false, linewidth = 2)","category":"section"},{"location":"single_particle_dynamics/#Comparison-of-Settling-and-Diffusion-Timescales","page":"Single Particle Dynamics","title":"Comparison of Settling and Diffusion Timescales","text":"The relative importance of gravitational settling versus Brownian diffusion depends on particle size. The characteristic timescale ratio τ_ds = 4D/vt² (Eq. 9.85) indicates which process dominates:\n\ntau_ds_values = 4 .* D_B_values ./ (v_t_values .^ 2)\n\np4 = plot(D_p_range * 1e6, tau_ds_values,\n    xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"Characteristic Time τ_ds (s)\",\n    title = \"Diffusion-Settling Timescale (Eq. 9.85)\",\n    legend = false, linewidth = 2)\nhline!([1.0], linestyle = :dash, color = :gray)","category":"section"},{"location":"single_particle_dynamics/#Summary-Plot","page":"Single Particle Dynamics","title":"Summary Plot","text":"plot(p1, p2, p3, p4, layout = (2, 2), size = (800, 600))","category":"section"},{"location":"single_particle_dynamics/#Validation-Against-Table-9.3:-Slip-Correction-Factors","page":"Single Particle Dynamics","title":"Validation Against Table 9.3: Slip Correction Factors","text":"The following compares computed slip correction factors against values from Table 9.3 in Seinfeld & Pandis (2006):\n\n# Reference values from Table 9.3\ntable_data = [\n    (0.001, 216.0),\n    (0.01, 22.2),\n    (0.1, 2.85),\n    (1.0, 1.164),\n    (10.0, 1.016),\n    (100.0, 1.0016)\n]\n\nD_p_table = [d[1] * 1e-6 for d in table_data]  # Convert μm to m\nCc_table = [d[2] for d in table_data]\n\n# Computed values\nCc_computed = Float64[]\nfor D_p in D_p_table\n    prob = NonlinearProblem(csys, Dict(), Dict(csys.D_p => D_p))\n    sol = solve(prob)\n    push!(Cc_computed, sol[csys.C_c])\nend\n\nDataFrame(\n    Symbol(\"Dp (μm)\") => [d[1] for d in table_data],\n    Symbol(\"Cc (Table 9.3)\") => Cc_table,\n    Symbol(\"Cc (Computed)\") => round.(Cc_computed, digits = 2),\n    Symbol(\"Error (%)\") => round.(abs.(Cc_computed .- Cc_table) ./ Cc_table .* 100, digits = 1)\n)","category":"section"},{"location":"single_particle_dynamics/#Flow-Regime-Classification","page":"Single Particle Dynamics","title":"Flow Regime Classification","text":"The Knudsen number determines the applicable flow regime:\n\nRegime Kn Range Description\nContinuum Kn → 0 Stokes' law applies (Cc ≈ 1)\nTransition Kn ~ 1 Slip correction required\nFree molecular Kn → ∞ Kinetic theory applies\n\nplot(D_p_range * 1e6, Kn_values,\n    xscale = :log10, yscale = :log10,\n    xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"Knudsen Number\",\n    title = \"Flow Regime Classification\",\n    legend = false, linewidth = 2)\nhline!([0.1, 10], linestyle = :dash, color = :gray, label = \"Regime boundaries\")\nannotate!([(0.001, 0.05, text(\"Continuum\", 8)),\n    (0.1, 5, text(\"Transition\", 8)),\n    (10, 500, text(\"Free Molecular\", 8))])","category":"section"},{"location":"single_particle_dynamics/#Aerosol.SingleParticleDynamics","page":"Single Particle Dynamics","title":"Aerosol.SingleParticleDynamics","text":"SingleParticleDynamics(; name=:SingleParticleDynamics)\n\nComprehensive component combining all single particle dynamics equations.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9: Dynamics of Single Aerosol Particles.\n\nThis component calculates key aerosol particle properties:\n\nMean free path of air (Eq. 9.6)\nKnudsen number (Eq. 9.1)\nCunningham slip correction factor (Eq. 9.34)\nTerminal settling velocity (Eq. 9.42)\nRelaxation time (Eq. 9.38)\nBrownian diffusion coefficient (Eq. 9.73)\nParticle mobility (Eq. 9.78)\nMean thermal speed (Eq. 9.87)\nParticle mean free path (Eq. 9.89)\nAerodynamic diameter (Eq. 9.110)\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.MeanFreePath","page":"Single Particle Dynamics","title":"Aerosol.MeanFreePath","text":"MeanFreePath(; name=:MeanFreePath)\n\nComponent for calculating the mean free path of air molecules.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.6.\n\nThe mean free path is calculated from:\n\nlambda = frac2mupsqrt8M(pi R T)\n\nwhere μ is dynamic viscosity, p is pressure, M is molecular weight, R is the gas constant, and T is temperature.\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.SlipCorrection","page":"Single Particle Dynamics","title":"Aerosol.SlipCorrection","text":"SlipCorrection(; name=:SlipCorrection)\n\nComponent for calculating the Cunningham slip correction factor.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.34.\n\nThe slip correction factor accounts for noncontinuum effects when the particle size approaches the mean free path of gas molecules:\n\nC_c = 1 + frac2lambdaD_pleftA_1 + A_2 expleft(-fracA_3 D_p2lambdaright)right\n\nwhere the constants A₁ = 1.257, A₂ = 0.4, A₃ = 1.1 are from Allen & Raabe (1982).\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.SettlingVelocity","page":"Single Particle Dynamics","title":"Aerosol.SettlingVelocity","text":"SettlingVelocity(; name=:SettlingVelocity)\n\nComponent for calculating particle terminal settling velocity and relaxation time.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.38, 9.42.\n\nThe terminal settling velocity is given by:\n\nv_t = fracD_p^2 rho_p g C_c18mu\n\nThe relaxation time (time constant for velocity adjustment) is:\n\ntau = fracrho_p D_p^2 C_c18mu\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.BrownianDiffusion","page":"Single Particle Dynamics","title":"Aerosol.BrownianDiffusion","text":"BrownianDiffusion(; name=:BrownianDiffusion)\n\nComponent for calculating Brownian diffusion properties of aerosol particles.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.73, 9.78, 9.87, 9.89.\n\nThe Stokes-Einstein-Sutherland relation gives the diffusion coefficient:\n\nD = frack T C_c3 pi mu D_p\n\nThe particle mobility is:\n\nB = fracC_c3 pi mu D_p\n\nThe mean thermal speed of the particle is:\n\nbarc_p = sqrtfrac8 k Tpi m_p\n\nThe particle mean free path is derived from D = ½ c̄p λp (Eq. 9.88):\n\nlambda_p = frac2Dbarc_p\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.ParticleMobility","page":"Single Particle Dynamics","title":"Aerosol.ParticleMobility","text":"ParticleMobility(; name=:ParticleMobility)\n\nComponent for calculating particle mechanical mobility.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.78.\n\nThe particle mobility relates external force to drift velocity:\n\nB = fracC_c3 pi mu D_p\n\nWith the Einstein relation connecting mobility to diffusion:\n\nD = B k T\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.ElectricalMobility","page":"Single Particle Dynamics","title":"Aerosol.ElectricalMobility","text":"ElectricalMobility(; name=:ElectricalMobility)\n\nComponent for calculating electrical mobility and migration velocity.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.49, 9.50, 9.51.\n\nThe electrical mobility relates particle velocity to electric field strength:\n\nB_e = fracq C_c3 pi mu D_p\n\nThe migration velocity in an electric field E is:\n\nv_e = B_e E\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.StokesNumber","page":"Single Particle Dynamics","title":"Aerosol.StokesNumber","text":"StokesNumber(; name=:StokesNumber)\n\nComponent for calculating Stokes number and stop distance.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.98, 9.101.\n\nThe stop distance is the distance a particle travels before coming to rest:\n\ns_p = tau U\n\nThe Stokes number characterizes particle inertia relative to flow:\n\nSt = fractau u_0L = fracD_p^2 rho_p C_c u_018 mu L\n\nWhen St ≫ 1, particles cannot follow fluid streamlines (inertial impaction). When St ≪ 1, particles follow fluid motion closely.\n\n\n\n\n\n","category":"function"},{"location":"single_particle_dynamics/#Aerosol.AerodynamicDiameter","page":"Single Particle Dynamics","title":"Aerosol.AerodynamicDiameter","text":"AerodynamicDiameter(; name=:AerodynamicDiameter)\n\nComponent for calculating equivalent particle diameters.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.102, 9.106, 9.108, 9.110, 9.114.\n\nThe volume equivalent diameter is the diameter of a sphere with the same volume:\n\nD_ve = left(frac6 V_ppiright)^13\n\nThe aerodynamic diameter is defined for a sphere of unit density (1000 kg/m³) with the same settling velocity:\n\nD_ca = D_p sqrtfracrho_prho_p^circ sqrtfracC_c(D_p)C_c(D_ca)\n\nIn the continuum regime (large particles), this simplifies to:\n\nD_ca approx D_p sqrtfracrho_prho_p^circ\n\nThe electrical mobility equivalent diameter relates to mobility measurement:\n\nD_em = D_ve chi fracC_c(D_em)C_c(D_ve)\n\n\n\n\n\n","category":"function"},{"location":"api/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"api/#API-Documentation","page":"API","title":"API Documentation","text":"","category":"section"},{"location":"api/#Aerosol.ATM_TO_PA","page":"API","title":"Aerosol.ATM_TO_PA","text":"Standard atmosphere in Pa, used for converting Henry's law constants from M/atm to M/Pa.\n\n\n\n\n\n","category":"constant"},{"location":"api/#Aerosol.R_GAS_J","page":"API","title":"Aerosol.R_GAS_J","text":"Gas constant in J mol^-1 K^-1 for van't Hoff equation\n\n\n\n\n\n","category":"constant"},{"location":"api/#Aerosol.R_GAS_PA","page":"API","title":"Aerosol.R_GAS_PA","text":"Gas constant in Pa L mol^-1 K^-1 for Henry's law calculations. R = 8.314 J/(mol·K) = 8.314 Pa·m³/(mol·K) = 8314.0 Pa·L/(mol·K) / 1000 Actually R in L·atm/(mol·K) = 0.08205; in L·Pa/(mol·K) = 0.08205 * 101325 = 8314.46\n\n\n\n\n\n","category":"constant"},{"location":"api/#Aerosol.T_REF","page":"API","title":"Aerosol.T_REF","text":"Reference temperature for Henry's law constants (K)\n\n\n\n\n\n","category":"constant"},{"location":"api/#Aerosol.AbsorptivePartitioning-Tuple{}","page":"API","title":"Aerosol.AbsorptivePartitioning","text":"AbsorptivePartitioning(; name=:AbsorptivePartitioning)\n\nGas-particle partitioning model for SOA formation by absorption into a preexisting organic aerosol phase, assuming an ideal solution. There is no threshold for SOA formation; secondary aerosol forms as soon as the ROG starts reacting.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.19-14.26.\n\nUses the dilute approximation c_{aer,i} << m_0 (Eq. 14.23), valid when no single compound dominates the organic aerosol composition.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AerodynamicDiameter-Tuple{}","page":"API","title":"Aerosol.AerodynamicDiameter","text":"AerodynamicDiameter(; name=:AerodynamicDiameter)\n\nComponent for calculating equivalent particle diameters.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.102, 9.106, 9.108, 9.110, 9.114.\n\nThe volume equivalent diameter is the diameter of a sphere with the same volume:\n\nD_ve = left(frac6 V_ppiright)^13\n\nThe aerodynamic diameter is defined for a sphere of unit density (1000 kg/m³) with the same settling velocity:\n\nD_ca = D_p sqrtfracrho_prho_p^circ sqrtfracC_c(D_p)C_c(D_ca)\n\nIn the continuum regime (large particles), this simplifies to:\n\nD_ca approx D_p sqrtfracrho_prho_p^circ\n\nThe electrical mobility equivalent diameter relates to mobility measurement:\n\nD_em = D_ve chi fracC_c(D_em)C_c(D_ve)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AerosolDistribution","page":"API","title":"Aerosol.AerosolDistribution","text":"AerosolDistribution(n_modes=3; name=:AerosolDistribution)\n\nMulti-modal lognormal aerosol size distribution following the parameterization of Seinfeld and Pandis (2006), Chapter 8, \"Properties of the Atmospheric Aerosol\", in Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, John Wiley & Sons.\n\nThe model represents the aerosol number, surface area, and volume distributions as a sum of n_modes lognormal modes (Eq. 8.54). Each mode i is characterized by three parameters:\n\nN[i]: total number concentration of mode i\nD_g[i]: geometric median diameter of mode i\nlogσ[i]: log10 of the geometric standard deviation of mode i\n\nThe implementation also includes the vertical mass profile (Eq. 8.55).\n\nDefault parameter values correspond to the \"Urban\" distribution from Table 8.3.\n\n\n\n\n\n","category":"function"},{"location":"api/#Aerosol.AerosolDynamics-Tuple{}","page":"API","title":"Aerosol.AerosolDynamics","text":"AerosolDynamics(; name=:AerosolDynamics)\n\nA combined system for modeling aerosol population dynamics including condensation growth and coagulation processes.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13.\n\nThis system provides:\n\nCondensation growth rate calculation\nBrownian coagulation coefficient (Fuchs form)\nMonodisperse coagulation dynamics\n\nThe General Dynamic Equation (Eq. 13.86) combines these processes:\n\nfracpartial n(vt)partial t = left(fracpartial npartial tright)_coag + left(fracpartial npartial tright)_cond + J_0delta(v-v_0) + S(v) - R(v)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AerosolLayerRadiativeForcing-Tuple{}","page":"API","title":"Aerosol.AerosolLayerRadiativeForcing","text":"AerosolLayerRadiativeForcing(; name=:AerosolLayerRadiativeForcing)\n\nAerosol layer radiative forcing model from Seinfeld & Pandis (2006) Chapter 24.\n\nThis component calculates the change in outgoing radiative flux due to an aerosol layer using the scattering-absorbing model from Section 24.1. It computes the reflection and transmission coefficients, the total reflectance of the aerosol-surface system, and the change in planetary albedo.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 24, Equations 24.1-24.10.\n\nParameters\n\nF_0: Incident solar flux (W m⁻²)\nτ: Aerosol optical depth (dimensionless)\nω: Single-scattering albedo (dimensionless)\nβ: Upscatter fraction (dimensionless)\nR_s: Surface albedo (dimensionless)\nA_c: Cloud fraction (dimensionless)\nT_a: Atmospheric transmittance (dimensionless)\n\nVariables (computed)\n\nr_aer: Fraction of light reflected upward by aerosol (dimensionless)\nt_aer: Fraction of light transmitted through aerosol (dimensionless)\nR_as: Total reflectance of aerosol-surface system (dimensionless)\nΔR_p: Change in planetary albedo (dimensionless)\nΔF: Change in outgoing radiative flux (W m⁻²)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AqueousDiffusionReaction-Tuple{}","page":"API","title":"Aerosol.AqueousDiffusionReaction","text":"AqueousDiffusionReaction(; name=:AqueousDiffusionReaction)\n\nCalculate the correction factor Q for aqueous-phase reaction rate when diffusion within the droplet limits the reaction.\n\nThe factor Q accounts for concentration gradients within the droplet due to fast reactions near the surface depleting reactants.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.110\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AqueousDiffusionTimescale-Tuple{}","page":"API","title":"Aerosol.AqueousDiffusionTimescale","text":"AqueousDiffusionTimescale(; name=:AqueousDiffusionTimescale)\n\nCharacteristic timescale for aqueous-phase diffusion within a droplet.\n\nThis is the time for a dissolved species to diffuse throughout the droplet interior.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.75\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AqueousEquilibrationTimescale-Tuple{}","page":"API","title":"Aerosol.AqueousEquilibrationTimescale","text":"AqueousEquilibrationTimescale(; name=:AqueousEquilibrationTimescale)\n\nCharacteristic timescale for a gas to equilibrate with aqueous aerosol particles.\n\nThis accounts for the additional buffering effect of Henry's law dissolution.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.147\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.AqueousEquilibria-Tuple{}","page":"API","title":"Aerosol.AqueousEquilibria","text":"AqueousEquilibria(; name=:AqEquilibria)\n\nCombined aqueous equilibria system for atmospheric cloud droplet chemistry.\n\nThis component combines all individual equilibrium systems into a single comprehensive system that can be used for cloud chemistry calculations.\n\nSubsystems:\n\nwater_eq: Water autoionization\nco2_eq: CO2/bicarbonate/carbonate equilibria\nso2_eq: SO2/bisulfite/sulfite (S(IV)) equilibria\nnh3_eq: NH3/ammonium equilibria\nhno3_eq: HNO3/nitrate equilibria\nh2o2_eq: H2O2 equilibria\no3_eq: O3 dissolution\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.BETAdsorption-Tuple{}","page":"API","title":"Aerosol.BETAdsorption","text":"BETAdsorption(; name=:BETAdsorption)\n\nBET (Brunauer-Emmett-Teller) adsorption isotherm for multilayer adsorption. Extends the Langmuir model to include formation of additional molecular layers, assuming each adsorbed molecule can serve as an adsorption site for the next layer.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.45.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.BrownianCoagulationCoefficient-Tuple{}","page":"API","title":"Aerosol.BrownianCoagulationCoefficient","text":"BrownianCoagulationCoefficient(; name=:BrownianCoagulationCoefficient)\n\nCompute the Brownian coagulation coefficient using the Fuchs form, which is valid across the continuum, transition, and free-molecular regimes.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Table 13.1.\n\nThe Fuchs form of the coagulation coefficient is:\n\nK_12 = 2pi(D_1 + D_2)(D_p1 + D_p2) left( fracD_p1 + D_p2D_p1 + D_p2 + 2sqrtg_1^2 + g_2^2 + frac8(D_1 + D_2)sqrtbarc_1^2 + barc_2^2(D_p1 + D_p2) right)^-1\n\nwhere:\n\nD_i = frack T C_c3pimu D_pi is the Brownian diffusion coefficient\nbarc_i = sqrtfrac8 k Tpi m_i is the mean thermal velocity\nell_i = frac8 D_ipi barc_i is the particle mean free path\ng_i = frac13 D_pi ell_ileft(D_pi + ell_i)^3 - (D_pi^2 + ell_i^2)^32right - D_pi\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.BrownianDiffusion-Tuple{}","page":"API","title":"Aerosol.BrownianDiffusion","text":"BrownianDiffusion(; name=:BrownianDiffusion)\n\nComponent for calculating Brownian diffusion properties of aerosol particles.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.73, 9.78, 9.87, 9.89.\n\nThe Stokes-Einstein-Sutherland relation gives the diffusion coefficient:\n\nD = frack T C_c3 pi mu D_p\n\nThe particle mobility is:\n\nB = fracC_c3 pi mu D_p\n\nThe mean thermal speed of the particle is:\n\nbarc_p = sqrtfrac8 k Tpi m_p\n\nThe particle mean free path is derived from D = ½ c̄p λp (Eq. 9.88):\n\nlambda_p = frac2Dbarc_p\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CO2Equilibria-Tuple{}","page":"API","title":"Aerosol.CO2Equilibria","text":"CO2Equilibria(; name=:CO2Eq)\n\nCO2 dissolution and dissociation equilibria with temperature dependence.\n\nImplements:\n\nEq 7.14-7.16: CO2(g) <-> CO2.H2O <-> H+ + HCO3- <-> H+ + CO3^2-\nEq 7.17: HCO2 = [CO2.H2O] / pCO2\nEq 7.18: K_c1 = [H+][HCO3-] / [CO2.H2O]\nEq 7.19: K_c2 = [H+][CO3^2-] / [HCO3-]\nEq 7.20-7.22: Species concentrations\nEq 7.24: HCO2 = HCO2 * (1 + Kc1/[H+] + Kc1K_c2/[H+]^2)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_CO2: Partial pressure of CO2 (Pa)\nCO2_aq: [CO2.H2O] concentration (mol/m³)\nHCO3_minus: Bicarbonate concentration (mol/m³)\nCO3_2minus: Carbonate concentration (mol/m³)\nC_total: Total dissolved inorganic carbon (mol/m³)\nHCO2eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ClassicalNucleationRate-Tuple{}","page":"API","title":"Aerosol.ClassicalNucleationRate","text":"ClassicalNucleationRate(; name=:ClassicalNucleationRate)\n\nA simplified component that computes only the classical nucleation rate (Eq. 11.47) from Seinfeld & Pandis (2006). This is a minimal component for use when critical cluster properties are not needed.\n\nVariables\n\nJ: Nucleation rate (molecules/(m³·s))\n\nParameters\n\nT: Temperature (K)\nS: Saturation ratio\nN_1: Monomer number concentration (molecules/m³)\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudAlbedo-Tuple{}","page":"API","title":"Aerosol.CloudAlbedo","text":"CloudAlbedo(; name=:CloudAlbedo)\n\nComponent to calculate cloud albedo from optical depth using the two-stream approximation.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.1: Rc = τc / (τ_c + γ)    (Eq. 24.38, simplified form for g = 0.85)\n\nwhere γ = 7.7 for an asymmetry factor g = 0.85 (typical for cloud droplets).\n\nThe general two-stream approximation (Eq. 24.37) is: Rc = √3(1-g)τc / (2 + √3(1-g)τ_c)\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.1, Equations 24.37-24.38.\n\nParameters\n\nτ_c: Cloud optical depth (dimensionless)\ng: Asymmetry factor (dimensionless, default 0.85)\n\nVariables (computed)\n\nR_c: Cloud albedo (dimensionless)\nγ: Denominator coefficient for two-stream approximation (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudAlbedoSensitivity-Tuple{}","page":"API","title":"Aerosol.CloudAlbedoSensitivity","text":"CloudAlbedoSensitivity(; name=:CloudAlbedoSensitivity)\n\nComponent to calculate the sensitivity of cloud albedo to cloud droplet number concentration (Twomey susceptibility).\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.2: dRc/dN = Rc(1-Rc)/(3N)    (Eq. 24.40) dRc/d(ln N) = R_c(1-R_c)/3  (Eq. 24.41, Twomey susceptibility)\n\nThe maximum susceptibility occurs at R_c = 0.5.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.2, Equations 24.39-24.42.\n\nParameters\n\nR_c: Cloud albedo (dimensionless)\nN: Cloud droplet number concentration (m⁻³)\n\nVariables (computed)\n\ndRc_dN: Sensitivity of cloud albedo to CDNC (m³)\nS: Twomey susceptibility dR_c/d(ln N) (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudChemistry-Tuple{}","page":"API","title":"Aerosol.CloudChemistry","text":"CloudChemistry(; name=:CloudChem)\n\nComprehensive cloud droplet chemistry system combining all equilibria and S(IV) oxidation kinetics.\n\nThis is the main component for modeling atmospheric aqueous-phase chemistry. It combines:\n\nWater autoionization equilibrium\nCO2/bicarbonate/carbonate equilibria\nSO2/bisulfite/sulfite (S(IV)) equilibria\nNH3/ammonium equilibria\nHNO3/nitrate equilibria\nH2O2 equilibria\nO3 dissolution\nS(IV) oxidation kinetics (O3, H2O2, Fe, Mn pathways)\n\nThe pH is determined from the electroneutrality condition (Eq 7.114): [H+] + [NH4+] = [OH-] + [HCO3-] + 2[CO3^2-] + [HSO3-] + 2[SO3^2-] + [NO3-] + [Cl-] + 2[SO4^2-]\n\nParameters:\n\nL: Liquid water content (g/m³)\nxi_SO2: SO2 mixing ratio for lifetime calculations (dimensionless)\n\nInput Variables (partial pressures and metal concentrations):\n\nT: Temperature (K)\np_CO2: CO2 partial pressure (Pa)\np_SO2: SO2 partial pressure (Pa)\np_NH3: NH3 partial pressure (Pa)\np_HNO3: HNO3 partial pressure (Pa)\np_H2O2: H2O2 partial pressure (Pa)\np_O3: O3 partial pressure (Pa)\nFe_III: Fe(III) concentration in droplet (mol/m³)\nMn_II: Mn(II) concentration in droplet (mol/m³)\nCl_minus: Chloride concentration (mol/m³)\nSO4_2minus: Sulfate concentration (mol/m³)\n\nOutput Variables:\n\npH: Droplet pH (dimensionless)\nH_plus: H+ concentration (mol/m³)\nAll aqueous species concentrations\nS(IV) oxidation rates    # Create subsystems for equilibria\nSulfate production rate\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudChemistryFixedpH-Tuple{}","page":"API","title":"Aerosol.CloudChemistryFixedpH","text":"CloudChemistryFixedpH(; name=:CloudChemFixedpH)\n\nSimplified cloud chemistry system with pH as an input parameter.\n\nThis variant takes pH as an input rather than calculating it from electroneutrality. This is useful for:\n\nSensitivity studies varying pH\nCases where additional ions (not modeled) affect pH\nQuick calculations without solving the full equilibrium\n\nParameters:\n\nL: Liquid water content (g m^-3)\nxi_SO2: SO2 mixing ratio for lifetime calculations (dimensionless)\n\nInput Variables:\n\nT: Temperature (K)\npH_input: Input pH value (dimensionless)\nAll partial pressures and metal concentrations    # Create subsystems for equilibria\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudChemistryODE-Tuple{}","page":"API","title":"Aerosol.CloudChemistryODE","text":"CloudChemistryODE(; name=:CloudChemODE)\n\nDynamic cloud chemistry system with time evolution of sulfate.\n\nThis system tracks the time evolution of sulfate concentration as S(IV) is oxidized to S(VI). It can be integrated using OrdinaryDiffEq.\n\nThe system includes:\n\nAll equilibria (assumed fast, instantaneous)\nS(IV) oxidation kinetics (rate-limiting)\nSulfate accumulation\n\nState Variable:\n\nSO4_2minus: Sulfate concentration (mol/m³), evolves with time\n\nParameters and other variables same as CloudChemistryFixedpH.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CloudOpticalDepth-Tuple{}","page":"API","title":"Aerosol.CloudOpticalDepth","text":"CloudOpticalDepth(; name=:CloudOpticalDepth)\n\nComponent to calculate cloud optical depth from liquid water content and droplet number concentration.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.1: τc = h * (9πL²N / 2ρw²)^(1/3)    (Eq. 24.36)\n\nThis relates cloud optical depth to cloud thickness (h), liquid water content (L), and cloud droplet number concentration (N).\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.1, Equations 24.34-24.36.\n\nParameters\n\nh: Cloud thickness (m)\nL: Liquid water content (kg m⁻³)\nN: Cloud droplet number concentration (m⁻³)\n\nConstants\n\nρ_w: Density of water (kg m⁻³)\n\nVariables (computed)\n\nτ_c: Cloud optical depth (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CriticalCluster-Tuple{}","page":"API","title":"Aerosol.CriticalCluster","text":"CriticalCluster(; name=:CriticalCluster)\n\nA standalone component for computing critical cluster properties without the full nucleation rate calculation. Useful for parameter sensitivity studies.\n\nThis implements equations 11.35, 11.52, and 11.53 from Seinfeld & Pandis (2006).\n\nVariables\n\ni_star: Critical cluster size (molecules)\nr_star: Critical cluster radius (m)\nΔG_star: Free energy barrier (J)\nθ: Dimensionless surface tension parameter\n\nParameters\n\nT: Temperature (K)\nS: Saturation ratio\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.CriticalSingleScatteringAlbedo-Tuple{}","page":"API","title":"Aerosol.CriticalSingleScatteringAlbedo","text":"CriticalSingleScatteringAlbedo(; name=:CriticalSingleScatteringAlbedo)\n\nComponent to calculate the critical single-scattering albedo (ω_crit) at which an aerosol layer transitions from cooling to heating the climate system.\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Equation 24.15: ωcrit = 2*Rs / (2R_s + β(1-R_s)²)\n\nWhen ω > ωcrit, the aerosol causes net cooling (increased reflection). When ω < ωcrit, the aerosol causes net heating (absorption dominates).\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.2.\n\nParameters\n\nR_s: Surface albedo (dimensionless)\nβ: Upscatter fraction (dimensionless)\n\nVariables (computed)\n\nω_crit: Critical single-scattering albedo (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.Dahneke-Tuple{}","page":"API","title":"Aerosol.Dahneke","text":"Dahneke(; name=:Dahneke)\n\nDahneke transition regime correction for mass transfer.\n\nAn alternative interpolation formula for the transition regime.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.42\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.DesertAerosol-Tuple{}","page":"API","title":"Aerosol.DesertAerosol","text":"DesertAerosol(; name=:DesertAerosol)\n\nDesert aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=726 cm⁻³, Dg=0.002 μm, log σ=0.247)\nMode 2: (N=114 cm⁻³, Dg=0.038 μm, log σ=0.770)\nMode 3: (N=0.178 cm⁻³, Dg=21.60 μm, log σ=0.438)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.DiameterGrowthRate-Tuple{}","page":"API","title":"Aerosol.DiameterGrowthRate","text":"DiameterGrowthRate(; name=:DiameterGrowthRate)\n\nCompute the diameter growth rate due to condensation in the continuum regime.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.11-13.13.\n\nThe diameter growth rate is given by:\n\nI_D = fracdD_pdt = frac4 D_i M_iR T D_p rho_p (p_i - p_eqi)\n\nIn the continuum regime with constant supersaturation (A = constant), this simplifies to:\n\nI_D = fracAD_p\n\nwhere A = frac4 D_i M_iR T rho_p (p_i - p_eqi).\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.DiscreteCoagulation-Tuple{Int64}","page":"API","title":"Aerosol.DiscreteCoagulation","text":"DiscreteCoagulation(n_bins::Int; name=:DiscreteCoagulation)\n\nModel the discrete coagulation equation for a monodisperse initial distribution with constant coagulation coefficient.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.59, 13.71.\n\nThe discrete coagulation equation for k-mers is:\n\nfracdN_kdt = frac12 sum_j=1^k-1 K_jk-j N_j N_k-j - N_k sum_j=1^infty K_kj N_j\n\nFor a constant coagulation coefficient K and monodisperse initial condition (all particles initially monomers), the analytical solution is:\n\nN_k(t) = fracN_0 (ttau_c)^k-11 + ttau_c^k+1\n\nArguments:\n\nn_bins::Int: Number of size bins (k-mer sizes to track)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.DropletMassBalance-Tuple{}","page":"API","title":"Aerosol.DropletMassBalance","text":"DropletMassBalance(; name=:DropletMassBalance)\n\nCoupled gas-phase and aqueous-phase mass balance for cloud droplet chemistry.\n\nThis model couples:\n\nGas-phase partial pressure evolution\nAqueous-phase concentration evolution\nMass transfer between phases\nAqueous-phase chemical reaction\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.122-12.123\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ECTracerMethod-Tuple{}","page":"API","title":"Aerosol.ECTracerMethod","text":"ECTracerMethod(; name=:ECTracerMethod)\n\nThe elemental carbon (EC) tracer method for estimating secondary organic carbon (OC) concentrations from measurements of total OC and EC.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.3.2, Equations 14.1-14.4.\n\nPrimary OC is estimated as the sum of combustion-related OC (proportional to EC via the OC_EC_ratio) and noncombustion OC (OC_NC). Secondary OC is the remainder.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.EffectiveHenrysLaw-Tuple{}","page":"API","title":"Aerosol.EffectiveHenrysLaw","text":"EffectiveHenrysLaw(; name=:EffectiveHenrys)\n\nEffective Henry's law constant accounting for aqueous dissociation.\n\nFor species that dissociate in water, the effective Henry's law constant H* is larger than the intrinsic Henry's law constant H because dissociation products contribute to the total dissolved amount.\n\nImplements:\n\nEq 7.24: HCO2 = HCO2 * (1 + Kc1/[H+] + Kc1K_c2/[H+]^2)\nEq 7.41: HSO2 = HSO2 * (1 + Ks1/[H+] + Ks1K_s2/[H+]^2)\nEq 7.61: H*HNO3 ~ HHNO3 * K_n1 / [H+]\n\nParameters:\n\nH_intrinsic: Intrinsic Henry's law constant (mol/m³/Pa)\nK_1: First dissociation constant (mol/m³)\nK_2: Second dissociation constant (mol/m³), set to 0 for monoprotic acids\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m³)\nH_eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ElectricalMobility-Tuple{}","page":"API","title":"Aerosol.ElectricalMobility","text":"ElectricalMobility(; name=:ElectricalMobility)\n\nComponent for calculating electrical mobility and migration velocity.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.49, 9.50, 9.51.\n\nThe electrical mobility relates particle velocity to electric field strength:\n\nB_e = fracq C_c3 pi mu D_p\n\nThe migration velocity in an electric field E is:\n\nv_e = B_e E\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ElementalCarbon-Tuple{}","page":"API","title":"Aerosol.ElementalCarbon","text":"A holder for elemental carbon concentrations. By default it does not include any dynamics.\n\nDefault density is from: https://doi.org/10.5194/acp-23-4327-2023\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.FHHAdsorption-Tuple{}","page":"API","title":"Aerosol.FHHAdsorption","text":"FHHAdsorption(; name=:FHHAdsorption)\n\nFHH (Frenkel-Halsey-Hill) adsorption isotherm, appropriate for conditions near saturation where the BET theory breaks down. Relates the logarithm of the supersaturation ratio to the adsorbed volume.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.46.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.FreeTroposphereAerosol-Tuple{}","page":"API","title":"Aerosol.FreeTroposphereAerosol","text":"FreeTroposphereAerosol(; name=:FreeTroposphereAerosol)\n\nFree troposphere aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=129 cm⁻³, Dg=0.007 μm, log σ=0.645)\nMode 2: (N=59.7 cm⁻³, Dg=0.250 μm, log σ=0.253)\nMode 3: (N=63.5 cm⁻³, Dg=0.520 μm, log σ=0.425)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.FuchsSutugin-Tuple{}","page":"API","title":"Aerosol.FuchsSutugin","text":"FuchsSutugin(; name=:FuchsSutugin)\n\nFuchs-Sutugin transition regime correction for mass transfer.\n\nThis is the most widely used formula for transition regime mass transfer due to its simplicity and accuracy across the full Knudsen number range.\n\nReturns the ratio J/Jc where Jc is the continuum regime flux.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.43 (with accommodation coefficient)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.GasDiffusionTimescale-Tuple{}","page":"API","title":"Aerosol.GasDiffusionTimescale","text":"GasDiffusionTimescale(; name=:GasDiffusionTimescale)\n\nCharacteristic timescale for gas-phase diffusion to a particle.\n\nThis is the time required for a gas-phase concentration perturbation to diffuse to the particle surface.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.49\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.H2O2Equilibria-Tuple{}","page":"API","title":"Aerosol.H2O2Equilibria","text":"H2O2Equilibria(; name=:H2O2Eq)\n\nH2O2 dissolution and (weak) dissociation equilibria.\n\nImplements:\n\nHH2O2 = [H2O2(aq)] / pH2O2 = 1e5 M/atm at 298 K\nK_h1 = [H+][HO2-] / [H2O2(aq)] = 2.2e-12 M (very weak, usually neglected)\n\nNote: H2O2 is a very weak acid and dissociation is typically neglected.\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_H2O2: Partial pressure of H2O2 (Pa)\nH2O2_aq: Aqueous H2O2 concentration (mol/m³)\nHO2_minus: Hydroperoxide anion concentration (mol/m³)\nH2O2_total: Total dissolved hydrogen peroxide (mol/m³)\nHH2O2eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.HNO3Equilibria-Tuple{}","page":"API","title":"Aerosol.HNO3Equilibria","text":"HNO3Equilibria(; name=:HNO3Eq)\n\nHNO3 dissolution and dissociation equilibria.\n\nImplements:\n\nEq 7.53-7.54: HNO3(g) <-> HNO3(aq) <-> H+ + NO3-\nHHNO3 = [HNO3(aq)] / pHNO3 = 2.1e5 M/atm at 298 K\nK_n1 = [H+][NO3-] / [HNO3(aq)] = 15.4 M at 298 K\nEq 7.58: [NO3-] ~ HHNO3 * Kn1 / [H+] * p_HNO3 (for complete dissociation)\nEq 7.61: H*HNO3 ~ HHNO3 * K_n1 / [H+] = 3.2e6 / [H+]\n\nNote: HNO3 is a strong acid and essentially completely dissociates in water.\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_HNO3: Partial pressure of HNO3 (Pa)\nHNO3_aq: Undissociated HNO3 concentration (mol/m³)\nNO3_minus: Nitrate concentration (mol/m³)\nHNO3_total: Total dissolved nitric acid (mol/m³)\nHHNO3eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.HenrysLaw-Tuple{}","page":"API","title":"Aerosol.HenrysLaw","text":"HenrysLaw(; name=:HenrysLaw)\n\nBasic Henry's law equilibrium at fixed temperature.\n\nImplements Eq 7.3: [A(aq)] = HA * pA\n\nParameters:\n\nH_A: Henry's law constant (mol/m³/Pa)\n\nVariables:\n\np_A: Partial pressure of gas A (Pa)\nC_aq: Aqueous concentration (mol/m³)\n\nThis component establishes the equilibrium relationship between gas-phase partial pressure and aqueous-phase concentration.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.HenrysLawTemperature-Tuple{}","page":"API","title":"Aerosol.HenrysLawTemperature","text":"HenrysLawTemperature(; name=:HenrysLawTemp)\n\nTemperature-dependent Henry's law equilibrium.\n\nImplements:\n\nEq 7.3: [A(aq)] = HA(T) * pA\nEq 7.5: HA(T) = HA(Tref) * exp((ΔHA/R) * (1/T_ref - 1/T))\n\nParameters:\n\nH_298: Henry's law constant at 298 K (mol/m³/Pa)\ndH_diss: Heat of dissolution (J/mol)\n\nVariables:\n\nT: Temperature (K)\np_A: Partial pressure (Pa)\nC_aq: Aqueous concentration (mol/m³)\nH_T: Temperature-corrected Henry's law constant (mol/m³/Pa)\n\nAlso calculates:\n\nw_L: Liquid water mixing ratio (dimensionless, vol/vol)\nf_A: Distribution factor (dimensionless)\nX_aq: Aqueous fraction (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.IndirectAerosolForcing-Tuple{}","page":"API","title":"Aerosol.IndirectAerosolForcing","text":"IndirectAerosolForcing(; name=:IndirectAerosolForcing)\n\nComponent to calculate the indirect radiative forcing from aerosol effects on cloud albedo (first indirect effect, or Twomey effect).\n\nFrom Seinfeld & Pandis (2006) Chapter 24, Section 24.8.2: ΔFc = -F0 * Ac * Ta² * ΔRc    (Eq. 24.43) ΔRc = Rc*(1-Rc)/3 * Δln(N)      (Eq. 24.42)\n\nThis gives the change in shortwave forcing due to changes in cloud albedo caused by changes in cloud droplet number concentration.\n\nReference: Seinfeld, J. H., and Pandis, S. N. (2006). Atmospheric Chemistry and Physics, Chapter 24, Section 24.8.2, Equations 24.42-24.43.\n\nParameters\n\nF_0: Incident solar flux (W m⁻²)\nA_c: Cloud fraction (dimensionless)\nT_a: Atmospheric transmittance (dimensionless)\nR_c: Cloud albedo (dimensionless)\nΔln_N: Fractional change in CDNC, Δln(N) = ΔN/N (dimensionless)\n\nVariables (computed)\n\nΔR_c: Change in cloud albedo (dimensionless)\nΔF_c: Change in shortwave forcing (W m⁻²)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.InterfacialTimescale-Tuple{}","page":"API","title":"Aerosol.InterfacialTimescale","text":"InterfacialTimescale(; name=:InterfacialTimescale)\n\nCharacteristic timescale to achieve equilibrium at the gas-particle interface.\n\nFor very soluble gases, the timescale is controlled by interfacial transport. For low solubility gases, the timescale is controlled by aqueous diffusion.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.61-12.62\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.KnudsenNumber-Tuple{}","page":"API","title":"Aerosol.KnudsenNumber","text":"KnudsenNumber(; name=:KnudsenNumber)\n\nCalculate the Knudsen number, the ratio of mean free path to particle radius.\n\nThe Knudsen number determines the transport regime:\n\nKn ≪ 1: Continuum regime (Fick's law applies)\nKn ≫ 1: Kinetic regime (molecular kinetics applies)\nKn ~ 1: Transition regime (interpolation formulas needed)\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.31\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.LangmuirAdsorption-Tuple{}","page":"API","title":"Aerosol.LangmuirAdsorption","text":"LangmuirAdsorption(; name=:LangmuirAdsorption)\n\nLangmuir adsorption isotherm for the formation of a monolayer of adsorbed molecules on particle surfaces. Assumes all adsorption sites are equivalent, no horizontal interactions, and uniform heat of adsorption.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.3, Equation 14.44.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MarineAerosol-Tuple{}","page":"API","title":"Aerosol.MarineAerosol","text":"MarineAerosol(; name=:MarineAerosol)\n\nMarine aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=133 cm⁻³, Dg=0.008 μm, log σ=0.657)\nMode 2: (N=66.6 cm⁻³, Dg=0.266 μm, log σ=0.210)\nMode 3: (N=3.1 cm⁻³, Dg=0.58 μm, log σ=0.396)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MassTransfer-Tuple{}","page":"API","title":"Aerosol.MassTransfer","text":"MassTransfer(; name=:MassTransfer)\n\nComplete mass transfer model combining transition regime correction, gas-phase diffusion, and interfacial transport.\n\nThis component provides the transition-regime corrected mass flux for particle growth/evaporation, applicable across all Knudsen numbers.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Sections 12.1.1-12.1.4\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MassTransferCoefficient-Tuple{}","page":"API","title":"Aerosol.MassTransferCoefficient","text":"MassTransferCoefficient(; name=:MassTransferCoefficient)\n\nCalculate the combined gas-phase and interfacial mass transfer coefficient.\n\nThis coefficient accounts for both gas-phase diffusion and interfacial resistance to mass transfer.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.116\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MassTransportLimitation-Tuple{}","page":"API","title":"Aerosol.MassTransportLimitation","text":"MassTransportLimitation(; name=:MassTransportLimitation)\n\nEvaluate mass transport limitation criteria for aqueous-phase chemistry.\n\nComputes the limiting values of k₁H* below which mass transport does not limit the aqueous-phase reaction rate (within 10%).\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.85, 12.86, 12.93\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MaxwellianFlux-Tuple{}","page":"API","title":"Aerosol.MaxwellianFlux","text":"MaxwellianFlux(; name=:MaxwellianFlux)\n\nCalculate the Maxwellian (continuum regime) molar flux to a particle.\n\nThis is the steady-state diffusive flux in the continuum regime (Kn ≪ 1).\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.12\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MeanFreePath-Tuple{}","page":"API","title":"Aerosol.MeanFreePath","text":"MeanFreePath(; name=:MeanFreePath)\n\nComponent for calculating the mean free path of air molecules.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.6.\n\nThe mean free path is calculated from:\n\nlambda = frac2mupsqrt8M(pi R T)\n\nwhere μ is dynamic viscosity, p is pressure, M is molecular weight, R is the gas constant, and T is temperature.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MeanMolecularSpeed-Tuple{}","page":"API","title":"Aerosol.MeanMolecularSpeed","text":"MeanMolecularSpeed(; name=:MeanMolecularSpeed)\n\nCalculate the mean molecular speed of gas molecules using kinetic theory.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.24\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.MonodisperseCoagulation-Tuple{}","page":"API","title":"Aerosol.MonodisperseCoagulation","text":"MonodisperseCoagulation(; name=:MonodisperseCoagulation)\n\nModel the evolution of total aerosol number concentration for a monodisperse aerosol undergoing Brownian coagulation with a constant coagulation coefficient.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.65-13.67.\n\nThe governing equation is:\n\nfracdNdt = -frac12 K N^2(t)\n\nwith analytical solution:\n\nN(t) = fracN_01 + ttau_c\n\nwhere tau_c = frac2K N_0 is the characteristic coagulation time.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.NH3Equilibria-Tuple{}","page":"API","title":"Aerosol.NH3Equilibria","text":"NH3Equilibria(; name=:NH3Eq)\n\nNH3 dissolution and dissociation equilibria with temperature dependence.\n\nImplements:\n\nEq 7.46-7.47: NH3(g) <-> NH3.H2O <-> NH4+ + OH-\nEq 7.48: HNH3 = [NH3.H2O] / pNH3\nEq 7.49: K_a1 = [NH4+][OH-] / [NH3.H2O]\nEq 7.50: [NH4+] = (HNH3 * Ka1 / Kw) * pNH3 * [H+]\nEq 7.51: [NH3T] = HNH3 * pNH3 * (1 + Ka1*[H+]/K_w)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\nOH_minus: Hydroxide ion concentration (mol/m³)\nK_w: Water dissociation constant (mol²/m⁶)\np_NH3: Partial pressure of NH3 (Pa)\nNH3_aq: [NH3.H2O] concentration (mol/m³)\nNH4_plus: Ammonium concentration (mol/m³)\nNH3_total: Total dissolved ammonia (mol/m³)\nHNH3eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.NoninteractingSOA-Tuple{}","page":"API","title":"Aerosol.NoninteractingSOA","text":"NoninteractingSOA(; name=:NoninteractingSOA)\n\nGas-particle partitioning model for a secondary organic aerosol (SOA) compound that does not interact with preexisting aerosol components. The compound exists in the aerosol phase as pure compound, so gas-aerosol equilibrium is reached when the gas-phase concentration equals the saturation concentration.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.6-14.18.\n\nThe aerosol concentration is zero until the reacted ROG exceeds the threshold ΔROG*_i = p°_i M_ROG / (a_i R T), after which the excess condenses.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.Nucleation-Tuple{}","page":"API","title":"Aerosol.Nucleation","text":"Nucleation(; name=:Nucleation)\n\nA component representing homogeneous nucleation of a single-component vapor following classical nucleation theory from Seinfeld & Pandis (2006), Chapter 11.\n\nThis component calculates the nucleation rate, critical cluster size, and critical radius based on the saturation ratio, temperature, and species properties.\n\nVariables\n\nS: Saturation ratio (dimensionless), ratio of partial pressure to saturation vapor pressure\nJ: Nucleation rate (molecules/(m³·s))\ni_star: Critical cluster size (molecules)\nr_star: Critical cluster radius (m)\nΔG_star: Free energy barrier (J)\nθ: Dimensionless surface tension parameter\n\nParameters\n\nT: Temperature (K)\np_A: Partial pressure of condensing species (Pa)\np_A_s: Saturation vapor pressure (Pa)\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\n\nReferences\n\nSeinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 11, pp. 489-536.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.O3Equilibria-Tuple{}","page":"API","title":"Aerosol.O3Equilibria","text":"O3Equilibria(; name=:O3Eq)\n\nO3 dissolution equilibrium with temperature dependence.\n\nO3 does not dissociate in water, so only Henry's law applies.\n\nVariables:\n\nT: Temperature (K)\np_O3: Partial pressure of O3 (Pa)\nO3_aq: Aqueous O3 concentration (mol/m³)\nH_O3: Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ParticleGrowthRate-Tuple{}","page":"API","title":"Aerosol.ParticleGrowthRate","text":"ParticleGrowthRate(; name=:ParticleGrowthRate)\n\nCalculate the rate of particle radius change due to condensation/evaporation.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.14\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ParticleMobility-Tuple{}","page":"API","title":"Aerosol.ParticleMobility","text":"ParticleMobility(; name=:ParticleMobility)\n\nComponent for calculating particle mechanical mobility.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.78.\n\nThe particle mobility relates external force to drift velocity:\n\nB = fracC_c3 pi mu D_p\n\nWith the Einstein relation connecting mobility to diffusion:\n\nD = B k T\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.PolarAerosol-Tuple{}","page":"API","title":"Aerosol.PolarAerosol","text":"PolarAerosol(; name=:PolarAerosol)\n\nPolar aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=21.7 cm⁻³, Dg=0.138 μm, log σ=0.245)\nMode 2: (N=0.186 cm⁻³, Dg=0.75 μm, log σ=0.300)\nMode 3: (N=3×10⁻⁴ cm⁻³, Dg=8.6 μm, log σ=0.291)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ReactionTimescale-Tuple{}","page":"API","title":"Aerosol.ReactionTimescale","text":"ReactionTimescale(; name=:ReactionTimescale)\n\nCharacteristic timescale for aqueous-phase chemical reactions.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.76-12.78\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.RemoteContinentalAerosol-Tuple{}","page":"API","title":"Aerosol.RemoteContinentalAerosol","text":"RemoteContinentalAerosol(; name=:RemoteContinentalAerosol)\n\nRemote continental aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=3200 cm⁻³, Dg=0.020 μm, log σ=0.161)\nMode 2: (N=2900 cm⁻³, Dg=0.116 μm, log σ=0.217)\nMode 3: (N=0.300 cm⁻³, Dg=1.800 μm, log σ=0.380)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.RuralAerosol-Tuple{}","page":"API","title":"Aerosol.RuralAerosol","text":"RuralAerosol(; name=:RuralAerosol)\n\nRural aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=6.65×10³ cm⁻³, Dg=0.015 μm, log σ=0.225)\nMode 2: (N=147 cm⁻³, Dg=0.054 μm, log σ=0.557)\nMode 3: (N=1990 cm⁻³, Dg=0.084 μm, log σ=0.266)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SO2Equilibria-Tuple{}","page":"API","title":"Aerosol.SO2Equilibria","text":"SO2Equilibria(; name=:SO2Eq)\n\nSO2 dissolution and dissociation equilibria with temperature dependence. This is the S(IV) system.\n\nImplements:\n\nEq 7.30-7.32: SO2(g) <-> SO2.H2O <-> H+ + HSO3- <-> H+ + SO3^2-\nEq 7.33: HSO2 = [SO2.H2O] / pSO2\nEq 7.34: K_s1 = [H+][HSO3-] / [SO2.H2O]\nEq 7.35: K_s2 = [H+][SO3^2-] / [HSO3-]\nEq 7.36-7.38: S(IV) species concentrations\nEq 7.39: [S(IV)] = [SO2.H2O] + [HSO3-] + [SO3^2-]\nEq 7.40: [S(IV)] = HSO2 * pSO2 * (1 + Ks1/[H+] + Ks1*K_s2/[H+]^2)\nEq 7.41: HS(IV) = HSO2 * (1 + Ks1/[H+] + Ks1K_s2/[H+]^2)\nEq 7.43-7.45: S(IV) mole fractions (alpha values)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_SO2: Partial pressure of SO2 (Pa)\nSO2_aq: [SO2.H2O] concentration (mol/m³)\nHSO3_minus: Bisulfite concentration (mol/m³)\nSO3_2minus: Sulfite concentration (mol/m³)\nSIVtotal: Total S(IV) concentration (mol/m³)\nHSO2eff: Effective Henry's law constant (mol/m³/Pa)\nalpha_0: Mole fraction of SO2.H2O (dimensionless)\nalpha_1: Mole fraction of HSO3- (dimensionless)\nalpha_2: Mole fraction of SO3^2- (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SettlingVelocity-Tuple{}","page":"API","title":"Aerosol.SettlingVelocity","text":"SettlingVelocity(; name=:SettlingVelocity)\n\nComponent for calculating particle terminal settling velocity and relaxation time.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.38, 9.42.\n\nThe terminal settling velocity is given by:\n\nv_t = fracD_p^2 rho_p g C_c18mu\n\nThe relaxation time (time constant for velocity adjustment) is:\n\ntau = fracrho_p D_p^2 C_c18mu\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SingleParticleDynamics-Tuple{}","page":"API","title":"Aerosol.SingleParticleDynamics","text":"SingleParticleDynamics(; name=:SingleParticleDynamics)\n\nComprehensive component combining all single particle dynamics equations.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9: Dynamics of Single Aerosol Particles.\n\nThis component calculates key aerosol particle properties:\n\nMean free path of air (Eq. 9.6)\nKnudsen number (Eq. 9.1)\nCunningham slip correction factor (Eq. 9.34)\nTerminal settling velocity (Eq. 9.42)\nRelaxation time (Eq. 9.38)\nBrownian diffusion coefficient (Eq. 9.73)\nParticle mobility (Eq. 9.78)\nMean thermal speed (Eq. 9.87)\nParticle mean free path (Eq. 9.89)\nAerodynamic diameter (Eq. 9.110)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SlipCorrection-Tuple{}","page":"API","title":"Aerosol.SlipCorrection","text":"SlipCorrection(; name=:SlipCorrection)\n\nComponent for calculating the Cunningham slip correction factor.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eq. 9.34.\n\nThe slip correction factor accounts for noncontinuum effects when the particle size approaches the mean free path of gas molecules:\n\nC_c = 1 + frac2lambdaD_pleftA_1 + A_2 expleft(-fracA_3 D_p2lambdaright)right\n\nwhere the constants A₁ = 1.257, A₂ = 0.4, A₃ = 1.1 are from Allen & Raabe (1982).\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SolidEquilibrationTimescale-Tuple{}","page":"API","title":"Aerosol.SolidEquilibrationTimescale","text":"SolidEquilibrationTimescale(; name=:SolidEquilibrationTimescale)\n\nCharacteristic timescale for a gas to equilibrate with solid aerosol particles.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eqs. 12.135, 12.139\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.StokesNumber-Tuple{}","page":"API","title":"Aerosol.StokesNumber","text":"StokesNumber(; name=:StokesNumber)\n\nComponent for calculating Stokes number and stop distance.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 9, Eqs. 9.98, 9.101.\n\nThe stop distance is the distance a particle travels before coming to rest:\n\ns_p = tau U\n\nThe Stokes number characterizes particle inertia relative to flow:\n\nSt = fractau u_0L = fracD_p^2 rho_p C_c u_018 mu L\n\nWhen St ≫ 1, particles cannot follow fluid streamlines (inertial impaction). When St ≪ 1, particles follow fluid motion closely.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormation-Tuple{}","page":"API","title":"Aerosol.SulfateFormation","text":"SulfateFormation(; name=:SulfateForm)\n\nCombined S(IV) to S(VI) oxidation kinetics including all pathways.\n\nSubsystems:\n\no3_ox: O3 oxidation pathway\nh2o2_ox: H2O2 oxidation pathway\nfe_ox: Fe(III)-catalyzed oxidation\nmn_ox: Mn(II)-catalyzed oxidation\nfemn_ox: Fe/Mn synergistic oxidation\n\nVariables:\n\nR_total: Total S(IV) oxidation rate (mol/m^3/s)\nSVIproduction: Sulfate production rate (mol/m^3/s)\n\nAlso calculates rate conversion factors (Section 7.4):\n\nRppbhr: Rate in ppb hr^-1 (Eq 7.75)\nRpercenthr: Rate in % hr^-1 (Eq 7.76)\ntau_SO2: SO2 lifetime (s) (Eq 7.78)    # Create subsystems\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormationFe-Tuple{}","page":"API","title":"Aerosol.SulfateFormationFe","text":"SulfateFormationFe(; name=:SulfateFe)\n\nS(IV) oxidation by O2 catalyzed by Fe(III) in aqueous phase.\n\nThe rate expression depends strongly on pH:\n\nFor pH 0-3.6 (Eq 7.92): R_Fe = k[Fe(III)][S(IV)] / [H+], k = 6 s^-1\n\nFor pH ~4.0 (Eq 7.93): R_Fe = 1e9 * [S(IV)] * [Fe(III)]^2\n\nFor pH 5.0-6.0 (Eq 7.94): R_Fe = 1e-3 * [S(IV)]\n\nFor pH 7.0 (Eq 7.95): R_Fe = 1e-4 * [S(IV)]\n\nThis implementation uses a simplified approach with the low-pH rate law, which is most relevant for typical cloud droplet conditions.\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m^3)\nFe_III: Fe(III) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nR_Fe: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormationFeMn-Tuple{}","page":"API","title":"Aerosol.SulfateFormationFeMn","text":"SulfateFormationFeMn(; name=:SulfateFeMn)\n\nS(IV) oxidation by O2 with Fe/Mn synergism.\n\nImplements Eq 7.102: R = 750[Mn(II)][S(IV)] + 2600[Fe(III)][S(IV)] + 1.0e10[Mn(II)][Fe(III)]*[S(IV)]\n\nThe synergistic term (10^10 coefficient) represents the greatly enhanced oxidation rate when both Fe(III) and Mn(II) are present.\n\nVariables:\n\nMn_II: Mn(II) concentration (mol/m^3)\nFe_III: Fe(III) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nRMnterm: Mn-only contribution (mol/m^3/s)\nRFeterm: Fe-only contribution (mol/m^3/s)\nRsynergyterm: Synergistic contribution (mol/m^3/s)\nR_FeMn: Total oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormationH2O2-Tuple{}","page":"API","title":"Aerosol.SulfateFormationH2O2","text":"SulfateFormationH2O2(; name=:SulfateH2O2)\n\nS(IV) oxidation by H2O2 in aqueous phase.\n\nImplements Eq 7.84: R_H2O2 = k[H+][H2O2][HSO3-] / (1 + K[H+])\n\nwhere:\n\nk = 7.5e7 M^-2 s^-1\nK = 13 M^-1\n\nThis reaction is relatively pH-independent due to the [H+] terms canceling, making it important across a wide pH range.\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m^3)\nH2O2_aq: Aqueous H2O2 concentration (mol/m^3)\nHSO3_minus: Bisulfite concentration (mol/m^3)\nR_H2O2: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormationMn-Tuple{}","page":"API","title":"Aerosol.SulfateFormationMn","text":"SulfateFormationMn(; name=:SulfateMn)\n\nS(IV) oxidation by O2 catalyzed by Mn(II) in aqueous phase.\n\nThe rate expression depends on S(IV) concentration:\n\nFor high S(IV) (>100 uM) (Eq 7.98): R_Mn = k0 * [Mn]^2  (zero-order in S(IV))\n\nFor low S(IV) (<1 uM) (Eq 7.101): R_Mn = k0 * [Mn] * [S(IV)], k0 = 1000 M^-1 s^-1\n\nThis implementation uses the low S(IV) rate law, which is first-order in both Mn and S(IV).\n\nVariables:\n\nMn_II: Mn(II) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nR_Mn: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.SulfateFormationO3-Tuple{}","page":"API","title":"Aerosol.SulfateFormationO3","text":"SulfateFormationO3(; name=:SulfateO3)\n\nS(IV) oxidation by O3 in aqueous phase.\n\nImplements Eq 7.79-7.80: R_O3 = (k0[SO2.H2O] + k1[HSO3-] + k2*[SO3^2-]) * [O3(aq)]\n\nwhere:\n\nk0 = 2.4e4 M^-1 s^-1 (SO2.H2O + O3)\nk1 = 3.7e5 M^-1 s^-1 (HSO3- + O3)\nk2 = 1.5e9 M^-1 s^-1 (SO3^2- + O3)\n\nThe reaction is fast at high pH due to the large k2 value for SO3^2-.\n\nVariables:\n\nSO2_aq: [SO2.H2O] concentration (mol/m^3)\nHSO3_minus: [HSO3-] concentration (mol/m^3)\nSO3_2minus: [SO3^2-] concentration (mol/m^3)\nO3_aq: [O3(aq)] concentration (mol/m^3)\nR_O3: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.TwoProductSOA-Tuple{}","page":"API","title":"Aerosol.TwoProductSOA","text":"TwoProductSOA(; name=:TwoProductSOA)\n\nThe two-product model for secondary organic aerosol (SOA) formation, developed by Odum et al. (1996). This model represents the complex mixture of oxidation products from a reactive organic gas (ROG) as two lumped surrogate products that form an ideal solution.\n\nFrom Seinfeld and Pandis (2006), Chapter 14, Section 14.5.2, Equations 14.27-14.43.\n\nThe key equation (14.43) gives the overall aerosol mass yield:\n\nY = c_aer * (a₁/(c_aer + c₁°) + a₂/(c_aer + c₂°))\n\nwhere a_i are stoichiometric yields and c_i° are saturation concentrations.\n\nParameters from Table 14.12 are provided for multiple VOC precursors.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 14. John Wiley & Sons, Inc.\n\nSee also: Odum, J. R. et al. (1996). Gas/Particle Partitioning and Secondary Organic Aerosol Yields. Environ. Sci. Technol., 30, 2580-2585.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.UptakeCoefficient-Tuple{}","page":"API","title":"Aerosol.UptakeCoefficient","text":"UptakeCoefficient(; name=:UptakeCoefficient)\n\nCalculate the uptake coefficient γ for gas-particle mass transfer.\n\nThe uptake coefficient is the probability that a molecule striking the particle surface is taken up by the particle.\n\nReference: Seinfeld & Pandis (2006) Chapter 12, Eq. 12.121\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.UrbanAerosol-Tuple{}","page":"API","title":"Aerosol.UrbanAerosol","text":"UrbanAerosol(; name=:UrbanAerosol)\n\nUrban aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: nucleation mode (N=9.93×10⁴ cm⁻³, Dg=0.013 μm, log σ=0.245)\nMode 2: Aitken mode (N=1.11×10³ cm⁻³, Dg=0.014 μm, log σ=0.666)\nMode 3: accumulation mode (N=3.64×10⁴ cm⁻³, Dg=0.050 μm, log σ=0.337)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.WaterEquilibrium-Tuple{}","page":"API","title":"Aerosol.WaterEquilibrium","text":"WaterEquilibrium(; name=:WaterEq)\n\nWater autoionization equilibrium with temperature dependence.\n\nImplements:\n\nEq 7.10-7.12: H2O <-> H+ + OH-\nEq 7.13: pH = -log10[H+]\nTable 7.4: Kw(T) = Kw(298) * exp((-dH/R) * (1/T - 1/298))\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\nOH_minus: Hydroxide ion concentration (mol/m³)\nK_w: Water dissociation constant (mol²/m⁶)\npH: Negative log of H+ concentration (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.WaterProperties-Tuple{}","page":"API","title":"Aerosol.WaterProperties","text":"WaterProperties(; name=:WaterProperties)\n\nA component providing temperature-dependent physical properties of water for nucleation calculations following the data from Seinfeld & Pandis (2006), Table 11.1 and 11.4.\n\nVariables\n\nσ: Surface tension (N/m)\nv_1: Molecular volume (m³/molecule)\nm_1: Molecular mass (kg/molecule)\np_sat: Saturation vapor pressure (Pa)\n\nParameters\n\nT: Temperature (K)\n\nReferences\n\nSeinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics, Chapter 11.\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.aqueous_fraction-NTuple{4, Any}","page":"API","title":"Aerosol.aqueous_fraction","text":"aqueous_fraction(H, R, T, w_L)\n\nCalculate the fraction of species in aqueous phase (Eq 7.9).\n\nArguments:\n\nH: Henry's law constant (mol/L/Pa)\nR: Gas constant (8314.46 Pa L mol^-1 K^-1)\nT: Temperature (K)\nw_L: Liquid water mixing ratio (vol/vol)\n\nReturns:\n\nX_aq: Fraction in aqueous phase (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.distribution_factor-NTuple{4, Any}","page":"API","title":"Aerosol.distribution_factor","text":"distribution_factor(H, R, T, w_L)\n\nCalculate the distribution factor f_A (Eq 7.7).\n\nArguments:\n\nH: Henry's law constant (mol/L/Pa)\nR: Gas constant (8314.46 Pa L mol^-1 K^-1)\nT: Temperature (K)\nw_L: Liquid water mixing ratio (vol/vol)\n\nReturns:\n\nf_A: Distribution factor (dimensionless)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.effective_henrys_constant-NTuple{4, Any}","page":"API","title":"Aerosol.effective_henrys_constant","text":"effective_henrys_constant(H, K1, K2, H_plus)\n\nCalculate effective Henry's law constant accounting for dissociation.\n\nArguments:\n\nH: Intrinsic Henry's law constant (mol/L/Pa)\nK1: First dissociation constant (mol/L)\nK2: Second dissociation constant (mol/L), use 0 for monoprotic\nH_plus: Hydrogen ion concentration (mol/L)\n\nReturns:\n\nH_eff: Effective Henry's law constant (mol/L/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.henrys_constant_at_T-Tuple{Any, Any, Any}","page":"API","title":"Aerosol.henrys_constant_at_T","text":"henrys_constant_at_T(H_298, dH_diss, T)\n\nCalculate Henry's law constant at temperature T using van't Hoff equation (Eq 7.5).\n\nArguments:\n\nH_298: Henry's law constant at 298 K (mol/L/Pa)\ndH_diss: Heat of dissolution (J/mol)\nT: Temperature (K)\n\nReturns:\n\nH_T: Henry's law constant at temperature T (mol/L/Pa)\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.rate_to_percent_hr-NTuple{4, Any}","page":"API","title":"Aerosol.rate_to_percent_hr","text":"rate_to_percent_hr(R_a, L, T, xi_SO2; p_total=101325.0)\n\nConvert aqueous-phase rate to percent conversion rate (Eq 7.76).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\nxi_SO2: SO2 mixing ratio (dimensionless)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nRate in %/hr\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.rate_to_ppb_hr-Tuple{Any, Any, Any}","page":"API","title":"Aerosol.rate_to_ppb_hr","text":"rate_to_ppb_hr(R_a, L, T; p_total=101325.0)\n\nConvert aqueous-phase rate to atmospheric mixing ratio rate (Eq 7.75).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nRate in ppb/hr\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.so2_lifetime-NTuple{4, Any}","page":"API","title":"Aerosol.so2_lifetime","text":"so2_lifetime(R_a, L, T, xi_SO2; p_total=101325.0)\n\nCalculate SO2 lifetime in seconds (Eq 7.78).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\nxi_SO2: SO2 mixing ratio (dimensionless)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nSO2 lifetime in seconds\n\n\n\n\n\n","category":"method"},{"location":"api/#Aerosol.ISORROPIA.Isorropia","page":"API","title":"Aerosol.ISORROPIA.Isorropia","text":"Isorropia(kwargs...)\n\nAn implementation of ISORROPIA II, a model for the thermodynamic equilibrium of gas-aerosol interactions, as described in:\n\nFountoukis, C. and Nenes, A., 2007. ISORROPIA II: a computationally efficient thermodynamic equilibrium model for K+–Ca 2+–Mg 2+–NH 4+–Na+–SO 4 2−–NO 3−–Cl−–H 2 O aerosols. Atmospheric Chemistry and Physics, 7(17), pp.4639-4659.\n\n\n\n\n\n","category":"constant"},{"location":"size_distribution/#Aerosol-Size-Distribution","page":"Size Distribution","title":"Aerosol Size Distribution","text":"","category":"section"},{"location":"size_distribution/#Overview","page":"Size Distribution","title":"Overview","text":"This module implements the multi-modal lognormal aerosol size distribution parameterization described in Chapter 8 (\"Properties of the Atmospheric Aerosol\") of Seinfeld and Pandis (2006).\n\nThe aerosol particle size distribution is represented as a sum of lognormal modes (Eq. 8.54), where each mode is characterized by a number concentration N_i, geometric median diameter D_gi, and geometric standard deviation sigma_gi. This parameterization is widely used to represent the number, surface area, and volume distributions of atmospheric aerosol populations across different environments.\n\nReference: Seinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, John Wiley & Sons, Chapter 8, pp. 350–395.","category":"section"},{"location":"size_distribution/#Implementation","page":"Size Distribution","title":"Implementation","text":"The AerosolDistribution component represents a multi-modal lognormal distribution with the following key equations:\n\nNumber distribution (Eq. 8.54): fracdNdlog D_p = sum_i fracN_isqrt2pilogsigma_gi expleft(-frac(log D_p - log D_gi)^22log^2sigma_giright)\nSurface area distribution (Eq. 8.49/8.50): Same form with surface area median diameter D_si = D_giexp(2ln^2sigma_gi)\nVolume distribution (Eq. 8.52/8.53): Same form with volume median diameter D_vi = D_giexp(3ln^2sigma_gi)\nVertical mass profile (Eq. 8.55): M(z) = M(0)exp(-zH_p)\n\nSeven predefined aerosol distribution types are provided from Table 8.3, each with three lognormal modes calibrated to represent typical atmospheric conditions.","category":"section"},{"location":"size_distribution/#State-Variables","page":"Size Distribution","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, Aerosol, DynamicQuantities\n\nsys = AerosolDistribution(3)\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"size_distribution/#Parameters","page":"Size Distribution","title":"Parameters","text":"pars = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in pars],\n    :Units => [dimension(ModelingToolkit.get_unit(p)) for p in pars],\n    :Description => [ModelingToolkit.getdescription(p) for p in pars]\n)","category":"section"},{"location":"size_distribution/#Equations","page":"Size Distribution","title":"Equations","text":"eqs = equations(sys)","category":"section"},{"location":"size_distribution/#Table-8.3:-Model-Aerosol-Distributions","page":"Size Distribution","title":"Table 8.3: Model Aerosol Distributions","text":"The following table reproduces Table 8.3 from Seinfeld and Pandis (2006), showing the parameters for seven model aerosol distributions expressed as the sum of three lognormal modes. Units: N in cm⁻³, D_p in μm.\n\nusing DataFrames\n\n# Table 8.3 data (in original units from the book)\ntable_data = [\n    (\"Urban\", 9.93e4, 0.013, 0.245, 1.11e3, 0.014, 0.666, 3.64e4, 0.050, 0.337),\n    (\"Marine\", 133, 0.008, 0.657, 66.6, 0.266, 0.210, 3.1, 0.58, 0.396),\n    (\"Rural\", 6650, 0.015, 0.225, 147, 0.054, 0.557, 1990, 0.084, 0.266),\n    (\"Remote continental\", 3200, 0.020, 0.161, 2900, 0.116, 0.217, 0.3, 1.8, 0.380),\n    (\"Free troposphere\", 129, 0.007, 0.645, 59.7, 0.250, 0.253, 63.5, 0.52, 0.425),\n    (\"Polar\", 21.7, 0.138, 0.245, 0.186, 0.75, 0.300, 3e-4, 8.6, 0.291),\n    (\"Desert\", 726, 0.002, 0.247, 114, 0.038, 0.770, 0.178, 21.6, 0.438)\n]\n\nDataFrame(\n    :Type => [d[1] for d in table_data],\n    Symbol(\"N₁ (cm⁻³)\") => [d[2] for d in table_data],\n    Symbol(\"Dₚ₁ (μm)\") => [d[3] for d in table_data],\n    Symbol(\"log σ₁\") => [d[4] for d in table_data],\n    Symbol(\"N₂ (cm⁻³)\") => [d[5] for d in table_data],\n    Symbol(\"Dₚ₂ (μm)\") => [d[6] for d in table_data],\n    Symbol(\"log σ₂\") => [d[7] for d in table_data],\n    Symbol(\"N₃ (cm⁻³)\") => [d[8] for d in table_data],\n    Symbol(\"Dₚ₃ (μm)\") => [d[9] for d in table_data],\n    Symbol(\"log σ₃\") => [d[10] for d in table_data]\n)","category":"section"},{"location":"size_distribution/#Analysis","page":"Size Distribution","title":"Analysis","text":"# Helper to get the base name of a symbolic variable (part after last ₊),\n# and strip the (t) suffix if present.\nfunction get_base_name(sym)\n    name = string(Symbolics.tosymbol(sym, escape = false))\n    name = contains(name, \"₊\") ? split(name, \"₊\")[end] : name\n    name = replace(name, r\"\\(t\\)$\" => \"\")\n    return name\nend\n\n# Helper to evaluate a system equation's RHS by substituting parameter values.\n# Handles namespaced variables by matching the actual symbols in the equation RHS.\nfunction eval_eq(sys, var, param_vals)\n    var_base = get_base_name(var)\n\n    # Find the equation for this variable\n    matching_eqs = filter(equations(sys)) do eq\n        lhs_base = get_base_name(eq.lhs)\n        return lhs_base == var_base\n    end\n    eq = only(matching_eqs)\n\n    # Get all variables that appear in the RHS\n    rhs_vars = Symbolics.get_variables(eq.rhs)\n\n    # Build substitution dict by matching RHS variables with:\n    # 1. System defaults (for constants like π_c, ln10)\n    # 2. User-provided values (matching by string representation)\n    subs = Dict{Any, Any}()\n    defs = ModelingToolkit.defaults(sys)\n\n    for rv in rhs_vars\n        rv_str = string(rv)\n\n        # Check system defaults\n        for (k, v) in defs\n            k_str = string(k)\n            if rv_str == k_str || endswith(k_str, \"₊\" * rv_str)\n                subs[rv] = v\n            end\n        end\n\n        # Check user-provided values (these override defaults)\n        for (k, v) in param_vals\n            k_str = string(k)\n            if rv_str == k_str || endswith(k_str, \"₊\" * rv_str)\n                subs[rv] = v\n            end\n        end\n    end\n\n    result = Symbolics.substitute(eq.rhs, subs)\n    return Float64(result)\nend\nnothing # hide","category":"section"},{"location":"size_distribution/#Urban-Aerosol-Distribution-(Figure-8.14)","page":"Size Distribution","title":"Urban Aerosol Distribution (Figure 8.14)","text":"The urban aerosol distribution from Table 8.3 shows three distinct modes: a nucleation mode, an Aitken mode, and an accumulation mode.\n\nusing Plots\n\nurban = UrbanAerosol()\n\n# Evaluate the system's n_N_o equation over a range of diameters\nD_p_range = 10 .^ range(log10(1e-9), log10(100e-6), length = 500)\nn_N_total = map(D_p_range) do D_p_val\n    eval_eq(urban, urban.n_N_o, Dict(urban.D_p => D_p_val))\nend\n\n# Also evaluate individual mode contributions using single-mode systems\nmode_contributions = [zeros(length(D_p_range)) for _ in 1:3]\ndefs = ModelingToolkit.defaults(urban)\nfor i in 1:3\n    n_key = only(filter(k -> contains(string(k), \"N[$i]\"), collect(keys(defs))))\n    d_key = only(filter(k -> contains(string(k), \"D_g[$i]\"), collect(keys(defs))))\n    s_key = only(filter(k -> contains(string(k), \"logσ[$i]\"), collect(keys(defs))))\n    mode_sys = AerosolDistribution(1; name = Symbol(\"mode_$i\"))\n    for (j, D_p_val) in enumerate(D_p_range)\n        mode_contributions[i][j] = eval_eq(mode_sys,\n            mode_sys.n_N_o,\n            Dict(\n                mode_sys.N[1] => defs[n_key],\n                mode_sys.D_g[1] => defs[d_key],\n                mode_sys.logσ[1] => defs[s_key],\n                mode_sys.D_p => D_p_val\n            ))\n    end\nend\n\n# Convert to cm^-3 for plotting (standard convention)\np = plot(D_p_range * 1e6, n_N_total / 1e6,\n    xscale = :log10, xlabel = \"Particle Diameter (μm)\",\n    ylabel = \"dN/d(log Dp) (cm⁻³)\",\n    label = \"Total\", linewidth = 2, color = :black,\n    title = \"Urban Aerosol Size Distribution (Table 8.3)\")\nfor i in 1:3\n    plot!(p, D_p_range * 1e6, mode_contributions[i] / 1e6,\n        label = \"Mode $i\", linestyle = :dash)\nend\np","category":"section"},{"location":"size_distribution/#Comparison-of-All-Aerosol-Types-(Figures-8.14–8.20)","page":"Size Distribution","title":"Comparison of All Aerosol Types (Figures 8.14–8.20)","text":"The following figure compares the number distributions for all seven aerosol environment types from Table 8.3.\n\ndist_constructors = [\n    (\"Desert\", DesertAerosol),\n    (\"Free troposphere\", FreeTroposphereAerosol),\n    (\"Marine\", MarineAerosol),\n    (\"Polar\", PolarAerosol),\n    (\"Remote continental\", RemoteContinentalAerosol),\n    (\"Rural\", RuralAerosol),\n    (\"Urban\", UrbanAerosol)\n]\n\nD_p_range = 10 .^ range(log10(1e-9), log10(100e-6), length = 500)\np = plot(xlabel = \"Particle Diameter (μm)\", ylabel = \"dN/d(log Dp) (cm⁻³)\",\n    xscale = :log10, yscale = :log10, legend = :topright,\n    title = \"Model Aerosol Size Distributions (Table 8.3)\",\n    ylims = (1e-3, 1e6))\n\nfor (env_name, constructor) in dist_constructors\n    dist_sys = constructor()\n    n_N = map(D_p_range) do D_p_val\n        eval_eq(dist_sys, dist_sys.n_N_o, Dict(dist_sys.D_p => D_p_val))\n    end\n    # Convert from m^-3 to cm^-3 for plotting\n    plot!(p, D_p_range * 1e6, n_N / 1e6, label = env_name, linewidth = 1.5)\nend\np","category":"section"},{"location":"size_distribution/#Volume-Distributions","page":"Size Distribution","title":"Volume Distributions","text":"The volume distribution emphasizes larger particles and is important for understanding aerosol mass loading. For each mode, the volume distribution peaks at the volume median diameter D_vi = D_giexp(3ln^2sigma_gi) (Eq. 8.53).\n\n# Urban volume distribution using the system's n_V_o equation\nurban = UrbanAerosol()\nD_p_range = 10 .^ range(log10(1e-9), log10(100e-6), length = 500)\n\nn_V_total = map(D_p_range) do D_p_val\n    eval_eq(urban, urban.n_V_o, Dict(urban.D_p => D_p_val))\nend\n\np = plot(xlabel = \"Particle Diameter (μm)\", ylabel = \"dV/d(log Dp) (μm³/cm³)\",\n    xscale = :log10, title = \"Urban Aerosol Volume Distribution\",\n    legend = :topright)\n\n# Convert from m³/m³ to μm³/cm³: m³→μm³ is ×1e18, m⁻³→cm⁻³ is ÷1e6, net ×1e12\nplot!(p, D_p_range * 1e6, n_V_total * 1e12, label = \"Total\", linewidth = 2, color = :black)\np","category":"section"},{"location":"size_distribution/#Vertical-Mass-Profile-(Eq.-8.55)","page":"Size Distribution","title":"Vertical Mass Profile (Eq. 8.55)","text":"The vertical variation of aerosol mass concentration follows an exponential decay with a characteristic scale height H_p.\n\n# Evaluate the system's M_z equation for different scale heights\nsys = AerosolDistribution(3)\nz_range = range(0, 10000, length = 100)\nH_p_values = [500, 1000, 2000, 5000]\n\nbase_params = Dict(\n    sys.N[1] => 1e11, sys.D_g[1] => 1e-7, sys.logσ[1] => 0.3,\n    sys.N[2] => 1e10, sys.D_g[2] => 1e-6, sys.logσ[2] => 0.3,\n    sys.N[3] => 1e9, sys.D_g[3] => 1e-5, sys.logσ[3] => 0.3,\n    sys.D_p => 1e-7\n)\n\np = plot(xlabel = \"M(z)/M(0)\", ylabel = \"Altitude (m)\",\n    title = \"Vertical Aerosol Mass Profile (Eq. 8.55)\",\n    legend = :topright)\n\nfor H_p in H_p_values\n    M_ratio = map(z_range) do z_val\n        eval_eq(sys, sys.M_z, merge(base_params, Dict(sys.z => z_val, sys.H_p => Float64(H_p))))\n    end\n    plot!(p, M_ratio, z_range, label = \"Hp = $H_p m\", linewidth = 1.5)\nend\np","category":"section"},{"location":"size_distribution/#Aerosol.AerosolDistribution","page":"Size Distribution","title":"Aerosol.AerosolDistribution","text":"AerosolDistribution(n_modes=3; name=:AerosolDistribution)\n\nMulti-modal lognormal aerosol size distribution following the parameterization of Seinfeld and Pandis (2006), Chapter 8, \"Properties of the Atmospheric Aerosol\", in Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, John Wiley & Sons.\n\nThe model represents the aerosol number, surface area, and volume distributions as a sum of n_modes lognormal modes (Eq. 8.54). Each mode i is characterized by three parameters:\n\nN[i]: total number concentration of mode i\nD_g[i]: geometric median diameter of mode i\nlogσ[i]: log10 of the geometric standard deviation of mode i\n\nThe implementation also includes the vertical mass profile (Eq. 8.55).\n\nDefault parameter values correspond to the \"Urban\" distribution from Table 8.3.\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.UrbanAerosol","page":"Size Distribution","title":"Aerosol.UrbanAerosol","text":"UrbanAerosol(; name=:UrbanAerosol)\n\nUrban aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: nucleation mode (N=9.93×10⁴ cm⁻³, Dg=0.013 μm, log σ=0.245)\nMode 2: Aitken mode (N=1.11×10³ cm⁻³, Dg=0.014 μm, log σ=0.666)\nMode 3: accumulation mode (N=3.64×10⁴ cm⁻³, Dg=0.050 μm, log σ=0.337)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.MarineAerosol","page":"Size Distribution","title":"Aerosol.MarineAerosol","text":"MarineAerosol(; name=:MarineAerosol)\n\nMarine aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=133 cm⁻³, Dg=0.008 μm, log σ=0.657)\nMode 2: (N=66.6 cm⁻³, Dg=0.266 μm, log σ=0.210)\nMode 3: (N=3.1 cm⁻³, Dg=0.58 μm, log σ=0.396)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.RuralAerosol","page":"Size Distribution","title":"Aerosol.RuralAerosol","text":"RuralAerosol(; name=:RuralAerosol)\n\nRural aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=6.65×10³ cm⁻³, Dg=0.015 μm, log σ=0.225)\nMode 2: (N=147 cm⁻³, Dg=0.054 μm, log σ=0.557)\nMode 3: (N=1990 cm⁻³, Dg=0.084 μm, log σ=0.266)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.RemoteContinentalAerosol","page":"Size Distribution","title":"Aerosol.RemoteContinentalAerosol","text":"RemoteContinentalAerosol(; name=:RemoteContinentalAerosol)\n\nRemote continental aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=3200 cm⁻³, Dg=0.020 μm, log σ=0.161)\nMode 2: (N=2900 cm⁻³, Dg=0.116 μm, log σ=0.217)\nMode 3: (N=0.300 cm⁻³, Dg=1.800 μm, log σ=0.380)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.FreeTroposphereAerosol","page":"Size Distribution","title":"Aerosol.FreeTroposphereAerosol","text":"FreeTroposphereAerosol(; name=:FreeTroposphereAerosol)\n\nFree troposphere aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=129 cm⁻³, Dg=0.007 μm, log σ=0.645)\nMode 2: (N=59.7 cm⁻³, Dg=0.250 μm, log σ=0.253)\nMode 3: (N=63.5 cm⁻³, Dg=0.520 μm, log σ=0.425)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.PolarAerosol","page":"Size Distribution","title":"Aerosol.PolarAerosol","text":"PolarAerosol(; name=:PolarAerosol)\n\nPolar aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=21.7 cm⁻³, Dg=0.138 μm, log σ=0.245)\nMode 2: (N=0.186 cm⁻³, Dg=0.75 μm, log σ=0.300)\nMode 3: (N=3×10⁻⁴ cm⁻³, Dg=8.6 μm, log σ=0.291)\n\n\n\n\n\n","category":"function"},{"location":"size_distribution/#Aerosol.DesertAerosol","page":"Size Distribution","title":"Aerosol.DesertAerosol","text":"DesertAerosol(; name=:DesertAerosol)\n\nDesert aerosol size distribution from Table 8.3 of Seinfeld and Pandis (2006).\n\nThree lognormal modes with parameters:\n\nMode 1: (N=726 cm⁻³, Dg=0.002 μm, log σ=0.247)\nMode 2: (N=114 cm⁻³, Dg=0.038 μm, log σ=0.770)\nMode 3: (N=0.178 cm⁻³, Dg=21.60 μm, log σ=0.438)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aqueous-Chemistry","page":"Aqueous Chemistry","title":"Aqueous Chemistry","text":"","category":"section"},{"location":"aqueous_chemistry/#Overview","page":"Aqueous Chemistry","title":"Overview","text":"Atmospheric aqueous-phase chemistry module implementing equations from Seinfeld & Pandis Chapter 7: \"Atmospheric Aqueous-Phase Chemistry\".\n\nAqueous-phase chemistry occurs in cloud droplets, fog droplets, and deliquesced aerosol particles. These processes are critical for:\n\nFormation of secondary aerosol components (especially sulfate)\npH regulation in atmospheric water\nRedistribution of species between gas and aqueous phases\nOxidation of dissolved gases\n\nThis module provides ModelingToolkit.jl systems for:\n\nHenry's law gas-liquid equilibrium\nAqueous dissociation equilibria (CO2, SO2, NH3, HNO3, H2O2, O3)\nS(IV) to S(VI) oxidation kinetics\nCombined cloud droplet chemistry\n\nReference: Seinfeld, J.H. and Pandis, S.N., \"Atmospheric Chemistry and Physics: From Air Pollution to Climate Change\", 3rd Edition, Wiley, 2016, Chapter 7.","category":"section"},{"location":"aqueous_chemistry/#Implementation","page":"Aqueous Chemistry","title":"Implementation","text":"All pressures use SI units (Pa). Henry's law constants from the textbook (M/atm) are internally converted to M/Pa by dividing by 101325. Concentrations are in mol/L, temperatures in K.","category":"section"},{"location":"aqueous_chemistry/#Henry's-Law-Components","page":"Aqueous Chemistry","title":"Henry's Law Components","text":"Henry's law describes the equilibrium partitioning of gases between the gas phase and aqueous phase.","category":"section"},{"location":"aqueous_chemistry/#Aqueous-Equilibria","page":"Aqueous Chemistry","title":"Aqueous Equilibria","text":"","category":"section"},{"location":"aqueous_chemistry/#Sulfate-Formation-(S(IV)-Oxidation)","page":"Aqueous Chemistry","title":"Sulfate Formation (S(IV) Oxidation)","text":"","category":"section"},{"location":"aqueous_chemistry/#Cloud-Chemistry-Systems","page":"Aqueous Chemistry","title":"Cloud Chemistry Systems","text":"","category":"section"},{"location":"aqueous_chemistry/#Utility-Functions","page":"Aqueous Chemistry","title":"Utility Functions","text":"","category":"section"},{"location":"aqueous_chemistry/#State-Variables","page":"Aqueous Chemistry","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Aerosol\n\nsys = CloudChemistry()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"aqueous_chemistry/#Parameters","page":"Aqueous Chemistry","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [dimension(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"aqueous_chemistry/#Equations","page":"Aqueous Chemistry","title":"Equations","text":"eqs = equations(sys)","category":"section"},{"location":"aqueous_chemistry/#Analysis","page":"Aqueous Chemistry","title":"Analysis","text":"","category":"section"},{"location":"aqueous_chemistry/#S(IV)-Mole-Fraction-Diagram","page":"Aqueous Chemistry","title":"S(IV) Mole Fraction Diagram","text":"The distribution of S(IV) species (SO₂·H₂O, HSO₃⁻, SO₃²⁻) depends on pH. The mole fractions (alpha values) are computed from the equilibrium constants (S&P Eq. 7.43-7.45).\n\nusing Plots\n\nK_s1 = Aerosol.K_S1_298\nK_s2 = Aerosol.K_S2_298\n\npH_range = range(0, 10, length = 200)\nalpha_0 = zeros(length(pH_range))\nalpha_1 = zeros(length(pH_range))\nalpha_2 = zeros(length(pH_range))\n\nfor (i, pH) in enumerate(pH_range)\n    H_plus = 10.0^(-pH)\n    denom = H_plus^2 + K_s1 * H_plus + K_s1 * K_s2\n    alpha_0[i] = H_plus^2 / denom\n    alpha_1[i] = K_s1 * H_plus / denom\n    alpha_2[i] = K_s1 * K_s2 / denom\nend\n\nplot(pH_range, alpha_0, label = \"α₀ (SO₂·H₂O)\", lw = 2)\nplot!(pH_range, alpha_1, label = \"α₁ (HSO₃⁻)\", lw = 2)\nplot!(pH_range, alpha_2, label = \"α₂ (SO₃²⁻)\", lw = 2)\nxlabel!(\"pH\")\nylabel!(\"Mole fraction\")\ntitle!(\"S(IV) Species Distribution (S&P Fig. 7.7)\")","category":"section"},{"location":"aqueous_chemistry/#Effective-Henry's-Law-Constant-vs-pH","page":"Aqueous Chemistry","title":"Effective Henry's Law Constant vs pH","text":"The effective Henry's law constant H* for SO₂ increases with pH due to dissociation of dissolved SO₂ (S&P Eq. 7.41).\n\nATM = Aerosol.ATM_TO_PA\nH_SO2_298 = 1.23 / ATM  # M/Pa\n\npH_range = range(0, 8, length = 200)\nH_eff_vals = zeros(length(pH_range))\nH_eff_atm = zeros(length(pH_range))\n\nfor (i, pH) in enumerate(pH_range)\n    H_plus = 10.0^(-pH)\n    H_eff_vals[i] = effective_henrys_constant(H_SO2_298, K_s1, K_s2, H_plus)\n    H_eff_atm[i] = H_eff_vals[i] * ATM  # Convert back to M/atm for display\nend\n\nplot(pH_range, H_eff_atm, lw = 2, yscale = :log10, label = \"H* SO₂\")\nhline!([1.23], ls = :dash, label = \"H (intrinsic)\", color = :gray)\nxlabel!(\"pH\")\nylabel!(\"H* (M/atm)\")\ntitle!(\"Effective Henry's Law Constant for SO₂ (S&P Eq. 7.41)\")","category":"section"},{"location":"aqueous_chemistry/#S(IV)-Oxidation-Rates-vs-pH","page":"Aqueous Chemistry","title":"S(IV) Oxidation Rates vs pH","text":"Comparison of the three main S(IV) oxidation pathways as a function of pH. This figure illustrates the pH-dependent dominance of different oxidants (cf. S&P Section 7.5).\n\nATM = Aerosol.ATM_TO_PA\nH_SO2 = 1.23 / ATM\nH_O3 = 1.1e-2 / ATM\nH_H2O2 = 1.0e5 / ATM\nK_s1 = Aerosol.K_S1_298\nK_s2 = Aerosol.K_S2_298\n\n# Typical atmospheric conditions\np_SO2 = 1e-9 * ATM  # 1 ppb\np_O3 = 50e-9 * ATM  # 50 ppb\np_H2O2 = 1e-9 * ATM # 1 ppb\n\npH_range = range(1, 7, length = 200)\nR_o3 = zeros(length(pH_range))\nR_h2o2 = zeros(length(pH_range))\n\nk0 = Aerosol.K0_O3\nk1 = Aerosol.K1_O3\nk2 = Aerosol.K2_O3\nk_h2o2 = 7.5e7\nK_eq = 13.0\n\nfor (i, pH) in enumerate(pH_range)\n    H_plus = 10.0^(-pH)\n    SO2_aq = H_SO2 * p_SO2\n    HSO3_m = K_s1 * SO2_aq / H_plus\n    SO3_2m = K_s2 * HSO3_m / H_plus\n    O3_aq = H_O3 * p_O3\n    H2O2_aq = H_H2O2 * p_H2O2\n\n    R_o3[i] = (k0 * SO2_aq + k1 * HSO3_m + k2 * SO3_2m) * O3_aq\n    R_h2o2[i] = k_h2o2 * H_plus * H2O2_aq * HSO3_m / (1 + K_eq * H_plus)\nend\n\nplot(pH_range, R_o3, label = \"O₃ pathway\", lw = 2, yscale = :log10)\nplot!(pH_range, R_h2o2, label = \"H₂O₂ pathway\", lw = 2)\nxlabel!(\"pH\")\nylabel!(\"Rate (mol/L/s)\")\ntitle!(\"S(IV) Oxidation Rates vs pH (S&P Section 7.5)\")","category":"section"},{"location":"aqueous_chemistry/#Temperature-Dependence-of-Henry's-Law-Constants","page":"Aqueous Chemistry","title":"Temperature Dependence of Henry's Law Constants","text":"Henry's law constants increase at lower temperatures for all species (exothermic dissolution), following the van't Hoff equation (S&P Eq. 7.5).\n\nATM = Aerosol.ATM_TO_PA\nT_range = range(273, 313, length = 100)\nspecies_list = [:SO2, :CO2, :NH3, :H2O2, :O3]\nlabels = [\"SO₂\", \"CO₂\", \"NH₃\", \"H₂O₂\", \"O₃\"]\n\nplt = plot(yscale = :log10)\nfor (sp, lab) in zip(species_list, labels)\n    H_298 = Aerosol.HENRY_CONSTANTS_298[sp]\n    dH = Aerosol.DELTA_H_DISSOLUTION[sp]\n    H_vals = [henrys_constant_at_T(H_298, dH, T) * ATM for T in T_range]\n    plot!(plt, collect(T_range), H_vals, label = lab, lw = 2)\nend\nxlabel!(plt, \"Temperature (K)\")\nylabel!(plt, \"H (M/atm)\")\ntitle!(plt, \"Henry's Law Constants vs Temperature (S&P Eq. 7.5)\")\nplt","category":"section"},{"location":"aqueous_chemistry/#Aerosol.CloudChemistry","page":"Aqueous Chemistry","title":"Aerosol.CloudChemistry","text":"CloudChemistry(; name=:CloudChem)\n\nComprehensive cloud droplet chemistry system combining all equilibria and S(IV) oxidation kinetics.\n\nThis is the main component for modeling atmospheric aqueous-phase chemistry. It combines:\n\nWater autoionization equilibrium\nCO2/bicarbonate/carbonate equilibria\nSO2/bisulfite/sulfite (S(IV)) equilibria\nNH3/ammonium equilibria\nHNO3/nitrate equilibria\nH2O2 equilibria\nO3 dissolution\nS(IV) oxidation kinetics (O3, H2O2, Fe, Mn pathways)\n\nThe pH is determined from the electroneutrality condition (Eq 7.114): [H+] + [NH4+] = [OH-] + [HCO3-] + 2[CO3^2-] + [HSO3-] + 2[SO3^2-] + [NO3-] + [Cl-] + 2[SO4^2-]\n\nParameters:\n\nL: Liquid water content (g/m³)\nxi_SO2: SO2 mixing ratio for lifetime calculations (dimensionless)\n\nInput Variables (partial pressures and metal concentrations):\n\nT: Temperature (K)\np_CO2: CO2 partial pressure (Pa)\np_SO2: SO2 partial pressure (Pa)\np_NH3: NH3 partial pressure (Pa)\np_HNO3: HNO3 partial pressure (Pa)\np_H2O2: H2O2 partial pressure (Pa)\np_O3: O3 partial pressure (Pa)\nFe_III: Fe(III) concentration in droplet (mol/m³)\nMn_II: Mn(II) concentration in droplet (mol/m³)\nCl_minus: Chloride concentration (mol/m³)\nSO4_2minus: Sulfate concentration (mol/m³)\n\nOutput Variables:\n\npH: Droplet pH (dimensionless)\nH_plus: H+ concentration (mol/m³)\nAll aqueous species concentrations\nS(IV) oxidation rates    # Create subsystems for equilibria\nSulfate production rate\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.HenrysLaw","page":"Aqueous Chemistry","title":"Aerosol.HenrysLaw","text":"HenrysLaw(; name=:HenrysLaw)\n\nBasic Henry's law equilibrium at fixed temperature.\n\nImplements Eq 7.3: [A(aq)] = HA * pA\n\nParameters:\n\nH_A: Henry's law constant (mol/m³/Pa)\n\nVariables:\n\np_A: Partial pressure of gas A (Pa)\nC_aq: Aqueous concentration (mol/m³)\n\nThis component establishes the equilibrium relationship between gas-phase partial pressure and aqueous-phase concentration.\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.HenrysLawTemperature","page":"Aqueous Chemistry","title":"Aerosol.HenrysLawTemperature","text":"HenrysLawTemperature(; name=:HenrysLawTemp)\n\nTemperature-dependent Henry's law equilibrium.\n\nImplements:\n\nEq 7.3: [A(aq)] = HA(T) * pA\nEq 7.5: HA(T) = HA(Tref) * exp((ΔHA/R) * (1/T_ref - 1/T))\n\nParameters:\n\nH_298: Henry's law constant at 298 K (mol/m³/Pa)\ndH_diss: Heat of dissolution (J/mol)\n\nVariables:\n\nT: Temperature (K)\np_A: Partial pressure (Pa)\nC_aq: Aqueous concentration (mol/m³)\nH_T: Temperature-corrected Henry's law constant (mol/m³/Pa)\n\nAlso calculates:\n\nw_L: Liquid water mixing ratio (dimensionless, vol/vol)\nf_A: Distribution factor (dimensionless)\nX_aq: Aqueous fraction (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.EffectiveHenrysLaw","page":"Aqueous Chemistry","title":"Aerosol.EffectiveHenrysLaw","text":"EffectiveHenrysLaw(; name=:EffectiveHenrys)\n\nEffective Henry's law constant accounting for aqueous dissociation.\n\nFor species that dissociate in water, the effective Henry's law constant H* is larger than the intrinsic Henry's law constant H because dissociation products contribute to the total dissolved amount.\n\nImplements:\n\nEq 7.24: HCO2 = HCO2 * (1 + Kc1/[H+] + Kc1K_c2/[H+]^2)\nEq 7.41: HSO2 = HSO2 * (1 + Ks1/[H+] + Ks1K_s2/[H+]^2)\nEq 7.61: H*HNO3 ~ HHNO3 * K_n1 / [H+]\n\nParameters:\n\nH_intrinsic: Intrinsic Henry's law constant (mol/m³/Pa)\nK_1: First dissociation constant (mol/m³)\nK_2: Second dissociation constant (mol/m³), set to 0 for monoprotic acids\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m³)\nH_eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.WaterEquilibrium","page":"Aqueous Chemistry","title":"Aerosol.WaterEquilibrium","text":"WaterEquilibrium(; name=:WaterEq)\n\nWater autoionization equilibrium with temperature dependence.\n\nImplements:\n\nEq 7.10-7.12: H2O <-> H+ + OH-\nEq 7.13: pH = -log10[H+]\nTable 7.4: Kw(T) = Kw(298) * exp((-dH/R) * (1/T - 1/298))\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\nOH_minus: Hydroxide ion concentration (mol/m³)\nK_w: Water dissociation constant (mol²/m⁶)\npH: Negative log of H+ concentration (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.CO2Equilibria","page":"Aqueous Chemistry","title":"Aerosol.CO2Equilibria","text":"CO2Equilibria(; name=:CO2Eq)\n\nCO2 dissolution and dissociation equilibria with temperature dependence.\n\nImplements:\n\nEq 7.14-7.16: CO2(g) <-> CO2.H2O <-> H+ + HCO3- <-> H+ + CO3^2-\nEq 7.17: HCO2 = [CO2.H2O] / pCO2\nEq 7.18: K_c1 = [H+][HCO3-] / [CO2.H2O]\nEq 7.19: K_c2 = [H+][CO3^2-] / [HCO3-]\nEq 7.20-7.22: Species concentrations\nEq 7.24: HCO2 = HCO2 * (1 + Kc1/[H+] + Kc1K_c2/[H+]^2)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_CO2: Partial pressure of CO2 (Pa)\nCO2_aq: [CO2.H2O] concentration (mol/m³)\nHCO3_minus: Bicarbonate concentration (mol/m³)\nCO3_2minus: Carbonate concentration (mol/m³)\nC_total: Total dissolved inorganic carbon (mol/m³)\nHCO2eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SO2Equilibria","page":"Aqueous Chemistry","title":"Aerosol.SO2Equilibria","text":"SO2Equilibria(; name=:SO2Eq)\n\nSO2 dissolution and dissociation equilibria with temperature dependence. This is the S(IV) system.\n\nImplements:\n\nEq 7.30-7.32: SO2(g) <-> SO2.H2O <-> H+ + HSO3- <-> H+ + SO3^2-\nEq 7.33: HSO2 = [SO2.H2O] / pSO2\nEq 7.34: K_s1 = [H+][HSO3-] / [SO2.H2O]\nEq 7.35: K_s2 = [H+][SO3^2-] / [HSO3-]\nEq 7.36-7.38: S(IV) species concentrations\nEq 7.39: [S(IV)] = [SO2.H2O] + [HSO3-] + [SO3^2-]\nEq 7.40: [S(IV)] = HSO2 * pSO2 * (1 + Ks1/[H+] + Ks1*K_s2/[H+]^2)\nEq 7.41: HS(IV) = HSO2 * (1 + Ks1/[H+] + Ks1K_s2/[H+]^2)\nEq 7.43-7.45: S(IV) mole fractions (alpha values)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_SO2: Partial pressure of SO2 (Pa)\nSO2_aq: [SO2.H2O] concentration (mol/m³)\nHSO3_minus: Bisulfite concentration (mol/m³)\nSO3_2minus: Sulfite concentration (mol/m³)\nSIVtotal: Total S(IV) concentration (mol/m³)\nHSO2eff: Effective Henry's law constant (mol/m³/Pa)\nalpha_0: Mole fraction of SO2.H2O (dimensionless)\nalpha_1: Mole fraction of HSO3- (dimensionless)\nalpha_2: Mole fraction of SO3^2- (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.NH3Equilibria","page":"Aqueous Chemistry","title":"Aerosol.NH3Equilibria","text":"NH3Equilibria(; name=:NH3Eq)\n\nNH3 dissolution and dissociation equilibria with temperature dependence.\n\nImplements:\n\nEq 7.46-7.47: NH3(g) <-> NH3.H2O <-> NH4+ + OH-\nEq 7.48: HNH3 = [NH3.H2O] / pNH3\nEq 7.49: K_a1 = [NH4+][OH-] / [NH3.H2O]\nEq 7.50: [NH4+] = (HNH3 * Ka1 / Kw) * pNH3 * [H+]\nEq 7.51: [NH3T] = HNH3 * pNH3 * (1 + Ka1*[H+]/K_w)\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\nOH_minus: Hydroxide ion concentration (mol/m³)\nK_w: Water dissociation constant (mol²/m⁶)\np_NH3: Partial pressure of NH3 (Pa)\nNH3_aq: [NH3.H2O] concentration (mol/m³)\nNH4_plus: Ammonium concentration (mol/m³)\nNH3_total: Total dissolved ammonia (mol/m³)\nHNH3eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.HNO3Equilibria","page":"Aqueous Chemistry","title":"Aerosol.HNO3Equilibria","text":"HNO3Equilibria(; name=:HNO3Eq)\n\nHNO3 dissolution and dissociation equilibria.\n\nImplements:\n\nEq 7.53-7.54: HNO3(g) <-> HNO3(aq) <-> H+ + NO3-\nHHNO3 = [HNO3(aq)] / pHNO3 = 2.1e5 M/atm at 298 K\nK_n1 = [H+][NO3-] / [HNO3(aq)] = 15.4 M at 298 K\nEq 7.58: [NO3-] ~ HHNO3 * Kn1 / [H+] * p_HNO3 (for complete dissociation)\nEq 7.61: H*HNO3 ~ HHNO3 * K_n1 / [H+] = 3.2e6 / [H+]\n\nNote: HNO3 is a strong acid and essentially completely dissociates in water.\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_HNO3: Partial pressure of HNO3 (Pa)\nHNO3_aq: Undissociated HNO3 concentration (mol/m³)\nNO3_minus: Nitrate concentration (mol/m³)\nHNO3_total: Total dissolved nitric acid (mol/m³)\nHHNO3eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.H2O2Equilibria","page":"Aqueous Chemistry","title":"Aerosol.H2O2Equilibria","text":"H2O2Equilibria(; name=:H2O2Eq)\n\nH2O2 dissolution and (weak) dissociation equilibria.\n\nImplements:\n\nHH2O2 = [H2O2(aq)] / pH2O2 = 1e5 M/atm at 298 K\nK_h1 = [H+][HO2-] / [H2O2(aq)] = 2.2e-12 M (very weak, usually neglected)\n\nNote: H2O2 is a very weak acid and dissociation is typically neglected.\n\nVariables:\n\nT: Temperature (K)\nH_plus: Hydrogen ion concentration (mol/m³)\np_H2O2: Partial pressure of H2O2 (Pa)\nH2O2_aq: Aqueous H2O2 concentration (mol/m³)\nHO2_minus: Hydroperoxide anion concentration (mol/m³)\nH2O2_total: Total dissolved hydrogen peroxide (mol/m³)\nHH2O2eff: Effective Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.O3Equilibria","page":"Aqueous Chemistry","title":"Aerosol.O3Equilibria","text":"O3Equilibria(; name=:O3Eq)\n\nO3 dissolution equilibrium with temperature dependence.\n\nO3 does not dissociate in water, so only Henry's law applies.\n\nVariables:\n\nT: Temperature (K)\np_O3: Partial pressure of O3 (Pa)\nO3_aq: Aqueous O3 concentration (mol/m³)\nH_O3: Henry's law constant (mol/m³/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.AqueousEquilibria","page":"Aqueous Chemistry","title":"Aerosol.AqueousEquilibria","text":"AqueousEquilibria(; name=:AqEquilibria)\n\nCombined aqueous equilibria system for atmospheric cloud droplet chemistry.\n\nThis component combines all individual equilibrium systems into a single comprehensive system that can be used for cloud chemistry calculations.\n\nSubsystems:\n\nwater_eq: Water autoionization\nco2_eq: CO2/bicarbonate/carbonate equilibria\nso2_eq: SO2/bisulfite/sulfite (S(IV)) equilibria\nnh3_eq: NH3/ammonium equilibria\nhno3_eq: HNO3/nitrate equilibria\nh2o2_eq: H2O2 equilibria\no3_eq: O3 dissolution\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormationO3","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormationO3","text":"SulfateFormationO3(; name=:SulfateO3)\n\nS(IV) oxidation by O3 in aqueous phase.\n\nImplements Eq 7.79-7.80: R_O3 = (k0[SO2.H2O] + k1[HSO3-] + k2*[SO3^2-]) * [O3(aq)]\n\nwhere:\n\nk0 = 2.4e4 M^-1 s^-1 (SO2.H2O + O3)\nk1 = 3.7e5 M^-1 s^-1 (HSO3- + O3)\nk2 = 1.5e9 M^-1 s^-1 (SO3^2- + O3)\n\nThe reaction is fast at high pH due to the large k2 value for SO3^2-.\n\nVariables:\n\nSO2_aq: [SO2.H2O] concentration (mol/m^3)\nHSO3_minus: [HSO3-] concentration (mol/m^3)\nSO3_2minus: [SO3^2-] concentration (mol/m^3)\nO3_aq: [O3(aq)] concentration (mol/m^3)\nR_O3: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormationH2O2","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormationH2O2","text":"SulfateFormationH2O2(; name=:SulfateH2O2)\n\nS(IV) oxidation by H2O2 in aqueous phase.\n\nImplements Eq 7.84: R_H2O2 = k[H+][H2O2][HSO3-] / (1 + K[H+])\n\nwhere:\n\nk = 7.5e7 M^-2 s^-1\nK = 13 M^-1\n\nThis reaction is relatively pH-independent due to the [H+] terms canceling, making it important across a wide pH range.\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m^3)\nH2O2_aq: Aqueous H2O2 concentration (mol/m^3)\nHSO3_minus: Bisulfite concentration (mol/m^3)\nR_H2O2: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormationFe","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormationFe","text":"SulfateFormationFe(; name=:SulfateFe)\n\nS(IV) oxidation by O2 catalyzed by Fe(III) in aqueous phase.\n\nThe rate expression depends strongly on pH:\n\nFor pH 0-3.6 (Eq 7.92): R_Fe = k[Fe(III)][S(IV)] / [H+], k = 6 s^-1\n\nFor pH ~4.0 (Eq 7.93): R_Fe = 1e9 * [S(IV)] * [Fe(III)]^2\n\nFor pH 5.0-6.0 (Eq 7.94): R_Fe = 1e-3 * [S(IV)]\n\nFor pH 7.0 (Eq 7.95): R_Fe = 1e-4 * [S(IV)]\n\nThis implementation uses a simplified approach with the low-pH rate law, which is most relevant for typical cloud droplet conditions.\n\nVariables:\n\nH_plus: Hydrogen ion concentration (mol/m^3)\nFe_III: Fe(III) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nR_Fe: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormationMn","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormationMn","text":"SulfateFormationMn(; name=:SulfateMn)\n\nS(IV) oxidation by O2 catalyzed by Mn(II) in aqueous phase.\n\nThe rate expression depends on S(IV) concentration:\n\nFor high S(IV) (>100 uM) (Eq 7.98): R_Mn = k0 * [Mn]^2  (zero-order in S(IV))\n\nFor low S(IV) (<1 uM) (Eq 7.101): R_Mn = k0 * [Mn] * [S(IV)], k0 = 1000 M^-1 s^-1\n\nThis implementation uses the low S(IV) rate law, which is first-order in both Mn and S(IV).\n\nVariables:\n\nMn_II: Mn(II) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nR_Mn: Oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormationFeMn","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormationFeMn","text":"SulfateFormationFeMn(; name=:SulfateFeMn)\n\nS(IV) oxidation by O2 with Fe/Mn synergism.\n\nImplements Eq 7.102: R = 750[Mn(II)][S(IV)] + 2600[Fe(III)][S(IV)] + 1.0e10[Mn(II)][Fe(III)]*[S(IV)]\n\nThe synergistic term (10^10 coefficient) represents the greatly enhanced oxidation rate when both Fe(III) and Mn(II) are present.\n\nVariables:\n\nMn_II: Mn(II) concentration (mol/m^3)\nFe_III: Fe(III) concentration (mol/m^3)\nSIVtotal: Total S(IV) concentration (mol/m^3)\nRMnterm: Mn-only contribution (mol/m^3/s)\nRFeterm: Fe-only contribution (mol/m^3/s)\nRsynergyterm: Synergistic contribution (mol/m^3/s)\nR_FeMn: Total oxidation rate (mol/m^3/s)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.SulfateFormation","page":"Aqueous Chemistry","title":"Aerosol.SulfateFormation","text":"SulfateFormation(; name=:SulfateForm)\n\nCombined S(IV) to S(VI) oxidation kinetics including all pathways.\n\nSubsystems:\n\no3_ox: O3 oxidation pathway\nh2o2_ox: H2O2 oxidation pathway\nfe_ox: Fe(III)-catalyzed oxidation\nmn_ox: Mn(II)-catalyzed oxidation\nfemn_ox: Fe/Mn synergistic oxidation\n\nVariables:\n\nR_total: Total S(IV) oxidation rate (mol/m^3/s)\nSVIproduction: Sulfate production rate (mol/m^3/s)\n\nAlso calculates rate conversion factors (Section 7.4):\n\nRppbhr: Rate in ppb hr^-1 (Eq 7.75)\nRpercenthr: Rate in % hr^-1 (Eq 7.76)\ntau_SO2: SO2 lifetime (s) (Eq 7.78)    # Create subsystems\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.CloudChemistryFixedpH","page":"Aqueous Chemistry","title":"Aerosol.CloudChemistryFixedpH","text":"CloudChemistryFixedpH(; name=:CloudChemFixedpH)\n\nSimplified cloud chemistry system with pH as an input parameter.\n\nThis variant takes pH as an input rather than calculating it from electroneutrality. This is useful for:\n\nSensitivity studies varying pH\nCases where additional ions (not modeled) affect pH\nQuick calculations without solving the full equilibrium\n\nParameters:\n\nL: Liquid water content (g m^-3)\nxi_SO2: SO2 mixing ratio for lifetime calculations (dimensionless)\n\nInput Variables:\n\nT: Temperature (K)\npH_input: Input pH value (dimensionless)\nAll partial pressures and metal concentrations    # Create subsystems for equilibria\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.CloudChemistryODE","page":"Aqueous Chemistry","title":"Aerosol.CloudChemistryODE","text":"CloudChemistryODE(; name=:CloudChemODE)\n\nDynamic cloud chemistry system with time evolution of sulfate.\n\nThis system tracks the time evolution of sulfate concentration as S(IV) is oxidized to S(VI). It can be integrated using OrdinaryDiffEq.\n\nThe system includes:\n\nAll equilibria (assumed fast, instantaneous)\nS(IV) oxidation kinetics (rate-limiting)\nSulfate accumulation\n\nState Variable:\n\nSO4_2minus: Sulfate concentration (mol/m³), evolves with time\n\nParameters and other variables same as CloudChemistryFixedpH.\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.effective_henrys_constant","page":"Aqueous Chemistry","title":"Aerosol.effective_henrys_constant","text":"effective_henrys_constant(H, K1, K2, H_plus)\n\nCalculate effective Henry's law constant accounting for dissociation.\n\nArguments:\n\nH: Intrinsic Henry's law constant (mol/L/Pa)\nK1: First dissociation constant (mol/L)\nK2: Second dissociation constant (mol/L), use 0 for monoprotic\nH_plus: Hydrogen ion concentration (mol/L)\n\nReturns:\n\nH_eff: Effective Henry's law constant (mol/L/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.aqueous_fraction","page":"Aqueous Chemistry","title":"Aerosol.aqueous_fraction","text":"aqueous_fraction(H, R, T, w_L)\n\nCalculate the fraction of species in aqueous phase (Eq 7.9).\n\nArguments:\n\nH: Henry's law constant (mol/L/Pa)\nR: Gas constant (8314.46 Pa L mol^-1 K^-1)\nT: Temperature (K)\nw_L: Liquid water mixing ratio (vol/vol)\n\nReturns:\n\nX_aq: Fraction in aqueous phase (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.distribution_factor","page":"Aqueous Chemistry","title":"Aerosol.distribution_factor","text":"distribution_factor(H, R, T, w_L)\n\nCalculate the distribution factor f_A (Eq 7.7).\n\nArguments:\n\nH: Henry's law constant (mol/L/Pa)\nR: Gas constant (8314.46 Pa L mol^-1 K^-1)\nT: Temperature (K)\nw_L: Liquid water mixing ratio (vol/vol)\n\nReturns:\n\nf_A: Distribution factor (dimensionless)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.henrys_constant_at_T","page":"Aqueous Chemistry","title":"Aerosol.henrys_constant_at_T","text":"henrys_constant_at_T(H_298, dH_diss, T)\n\nCalculate Henry's law constant at temperature T using van't Hoff equation (Eq 7.5).\n\nArguments:\n\nH_298: Henry's law constant at 298 K (mol/L/Pa)\ndH_diss: Heat of dissolution (J/mol)\nT: Temperature (K)\n\nReturns:\n\nH_T: Henry's law constant at temperature T (mol/L/Pa)\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.rate_to_ppb_hr","page":"Aqueous Chemistry","title":"Aerosol.rate_to_ppb_hr","text":"rate_to_ppb_hr(R_a, L, T; p_total=101325.0)\n\nConvert aqueous-phase rate to atmospheric mixing ratio rate (Eq 7.75).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nRate in ppb/hr\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.rate_to_percent_hr","page":"Aqueous Chemistry","title":"Aerosol.rate_to_percent_hr","text":"rate_to_percent_hr(R_a, L, T, xi_SO2; p_total=101325.0)\n\nConvert aqueous-phase rate to percent conversion rate (Eq 7.76).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\nxi_SO2: SO2 mixing ratio (dimensionless)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nRate in %/hr\n\n\n\n\n\n","category":"function"},{"location":"aqueous_chemistry/#Aerosol.so2_lifetime","page":"Aqueous Chemistry","title":"Aerosol.so2_lifetime","text":"so2_lifetime(R_a, L, T, xi_SO2; p_total=101325.0)\n\nCalculate SO2 lifetime in seconds (Eq 7.78).\n\nArguments:\n\nR_a: Aqueous reaction rate (mol/L/s)\nL: Liquid water content (g/m³)\nT: Temperature (K)\nxi_SO2: SO2 mixing ratio (dimensionless)\np_total: Total pressure (Pa), default 101325 (1 atm)\n\nReturns:\n\nSO2 lifetime in seconds\n\n\n\n\n\n","category":"function"},{"location":"dynamics/#Aerosol-Population-Dynamics","page":"Population Dynamics","title":"Aerosol Population Dynamics","text":"","category":"section"},{"location":"dynamics/#Overview","page":"Population Dynamics","title":"Overview","text":"This module implements aerosol population dynamics equations from Chapter 13 of Seinfeld & Pandis (2006), including condensational growth, Brownian coagulation, and the general dynamic equation.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 13, pp. 588-627.","category":"section"},{"location":"dynamics/#Implementation","page":"Population Dynamics","title":"Implementation","text":"","category":"section"},{"location":"dynamics/#Condensational-Growth","page":"Population Dynamics","title":"Condensational Growth","text":"The diameter growth rate due to condensation is given by Eq. 13.11:\n\nI_D = fracdD_pdt = frac4 D_i M_iR T D_p rho_p (p_i - p_eqi)\n\nIn the continuum regime with constant supersaturation, this simplifies to Eq. 13.13:\n\nI_D = fracAD_p\n\nwhere A = frac4 D_i M_iR T rho_p (p_i - p_eqi) is the growth parameter.\n\nThe analytical solution for particle diameter evolution (Eq. 13.21) is:\n\nD_p^2 = D_p0^2 + 2At","category":"section"},{"location":"dynamics/#State-Variables","page":"Population Dynamics","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Aerosol\n\nsys = DiameterGrowthRate()\n\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"dynamics/#Parameters","page":"Population Dynamics","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [dimension(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"dynamics/#Equations","page":"Population Dynamics","title":"Equations","text":"equations(sys)","category":"section"},{"location":"dynamics/#Analysis","page":"Population Dynamics","title":"Analysis","text":"","category":"section"},{"location":"dynamics/#Particle-Growth-Curves-(Figure-13.2)","page":"Population Dynamics","title":"Particle Growth Curves (Figure 13.2)","text":"This figure shows the growth of particles of different initial sizes due to condensation. Smaller particles grow more slowly in diameter because the growth rate is inversely proportional to particle size.\n\nusing Plots\nusing OrdinaryDiffEq\nusing ModelingToolkit: t\n\nsys = DiameterGrowthRate()\ncompiled_sys = mtkcompile(sys)\n\n# Parameters from Figure 13.2\nD_diff = 0.1e-4  # m²/s\nM_i = 0.1        # kg/mol (100 g/mol)\nΔp = 1e-4        # Pa (~1 ppb at 1 atm)\nT_val = 298.0    # K\nρ_p = 1000.0     # kg/m³\n\n# Initial diameters\nD_p0_values = [0.2e-6, 0.5e-6, 2.0e-6]  # 0.2, 0.5, 2 μm\n\ntspan = (0.0, 1200.0)  # 20 minutes\n\nplt = plot(\n    xlabel = \"Time (minutes)\",\n    ylabel = \"Diameter (μm)\",\n    title = \"Particle Growth by Condensation\",\n    legend = :topleft\n)\n\nfor D_p0 in D_p0_values\n    prob = ODEProblem(\n        compiled_sys,\n        [compiled_sys.D_p => D_p0],\n        tspan,\n        [\n            compiled_sys.D_diff => D_diff,\n            compiled_sys.M_i => M_i,\n            compiled_sys.Δp => Δp,\n            compiled_sys.T => T_val,\n            compiled_sys.ρ_p => ρ_p\n        ]\n    )\n    sol = solve(prob)\n\n    plot!(plt, sol.t ./ 60, sol[compiled_sys.D_p] .* 1e6,\n        label = \"D₀ = $(D_p0 * 1e6) μm\")\nend\n\nplt","category":"section"},{"location":"dynamics/#Brownian-Coagulation-Coefficient","page":"Population Dynamics","title":"Brownian Coagulation Coefficient","text":"The Brownian coagulation coefficient determines how fast particles of different sizes collide and stick together. The Fuchs form (Table 13.1) provides an interpolation formula that is valid across all regimes:\n\nsys_coag = BrownianCoagulationCoefficient()\n\n# Show the coagulation coefficient equations\nequations(sys_coag)\n\nThe coagulation coefficient depends strongly on particle size, with a minimum for particles of similar size in the transition regime and higher values for either very small particles (free molecular regime) or very large particles (continuum regime), or for particles of very different sizes.","category":"section"},{"location":"dynamics/#Monodisperse-Coagulation-Dynamics-(Eq.-13.65-13.67)","page":"Population Dynamics","title":"Monodisperse Coagulation Dynamics (Eq. 13.65-13.67)","text":"For a monodisperse aerosol with constant coagulation coefficient, the total number concentration evolves according to:\n\nfracdNdt = -frac12 K N^2\n\nwith analytical solution:\n\nN(t) = fracN_01 + ttau_c\n\nwhere tau_c = frac2K N_0 is the characteristic coagulation time.\n\nsys_mono = MonodisperseCoagulation()\ncompiled_mono = mtkcompile(sys_mono)\n\nN_0_val = 1e12  # 10⁶ cm⁻³ = 10¹² m⁻³\nK_val = 1e-15   # m³/s\nτ_c = 2 / (K_val * N_0_val)\n\nprob_mono = ODEProblem(\n    compiled_mono,\n    [compiled_mono.N => N_0_val],\n    (0.0, 5 * τ_c),\n    [\n        compiled_mono.K => K_val,\n        compiled_mono.N_0 => N_0_val\n    ]\n)\nsol_mono = solve(prob_mono)\n\n# Plot numerical vs analytical solution\nt_plot = range(0, 5 * τ_c, length = 100)\nN_analytical = N_0_val ./ (1 .+ t_plot ./ τ_c)\n\nplot(sol_mono.t ./ τ_c, sol_mono[compiled_mono.N] ./ N_0_val,\n    label = \"Numerical\", lw = 2,\n    xlabel = \"t / τc\",\n    ylabel = \"N / N₀\",\n    title = \"Monodisperse Coagulation (Eq. 13.66)\")\nplot!(t_plot ./ τ_c, N_analytical ./ N_0_val,\n    label = \"Analytical: N₀/(1 + t/τc)\", ls = :dash, lw = 2)","category":"section"},{"location":"dynamics/#Characteristic-Coagulation-Time","page":"Population Dynamics","title":"Characteristic Coagulation Time","text":"The characteristic coagulation time depends on both the coagulation coefficient and the initial number concentration. For atmospheric aerosols:\n\nN₀ (m⁻³) K (m³/s) τc Physical Interpretation\n10¹⁰ 10⁻¹⁵ ~55 hours Clean background\n10¹² 10⁻¹⁵ ~33 minutes Polluted urban\n10¹⁴ 10⁻¹⁵ ~20 seconds Fresh emissions","category":"section"},{"location":"dynamics/#Discrete-Coagulation-(Eq.-13.59,-13.71)","page":"Population Dynamics","title":"Discrete Coagulation (Eq. 13.59, 13.71)","text":"For an initially monodisperse aerosol, the evolution of k-mer concentrations follows the discrete coagulation equation. The analytical solution for constant K is:\n\nN_k(t) = fracN_0 (ttau_c)^k-11 + ttau_c^k+1\n\nn_bins = 8\nsys_discrete = DiscreteCoagulation(n_bins)\ncompiled_discrete = mtkcompile(sys_discrete)\n\n# Initially all monomers\nu0 = [compiled_discrete.N[1] => N_0_val]\nfor k in 2:n_bins\n    push!(u0, compiled_discrete.N[k] => 0.0)\nend\n\nprob_discrete = ODEProblem(\n    compiled_discrete,\n    u0,\n    (0.0, 3 * τ_c),\n    [\n        compiled_discrete.K => K_val,\n        compiled_discrete.N_0 => N_0_val\n    ]\n)\nsol_discrete = solve(prob_discrete)\n\n# Plot k-mer evolution\nplt_kmer = plot(\n    xlabel = \"t / τc\",\n    ylabel = \"Nk / N₀\",\n    title = \"Evolution of k-mer Concentrations (Eq. 13.71)\",\n    legend = :topright\n)\n\nfor k in 1:min(5, n_bins)\n    plot!(plt_kmer, sol_discrete.t ./ τ_c,\n        sol_discrete[compiled_discrete.N[k]] ./ N_0_val,\n        label = \"N$k\", lw = 2)\nend\n\nplt_kmer","category":"section"},{"location":"dynamics/#Conservation-Properties-(Table-13.4)","page":"Population Dynamics","title":"Conservation Properties (Table 13.4)","text":"Coagulation conserves total aerosol volume (mass) while decreasing total number. Condensation conserves number while increasing volume. This is verified numerically:\n\nProcess Number (N) Volume/Mass (V)\nCoagulation Decreases Conserved\nCondensation Conserved Increases\nCoag + Cond Decreases Increases\nNucleation Increases Increases","category":"section"},{"location":"dynamics/#Aerosol.AerosolDynamics","page":"Population Dynamics","title":"Aerosol.AerosolDynamics","text":"AerosolDynamics(; name=:AerosolDynamics)\n\nA combined system for modeling aerosol population dynamics including condensation growth and coagulation processes.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13.\n\nThis system provides:\n\nCondensation growth rate calculation\nBrownian coagulation coefficient (Fuchs form)\nMonodisperse coagulation dynamics\n\nThe General Dynamic Equation (Eq. 13.86) combines these processes:\n\nfracpartial n(vt)partial t = left(fracpartial npartial tright)_coag + left(fracpartial npartial tright)_cond + J_0delta(v-v_0) + S(v) - R(v)\n\n\n\n\n\n","category":"function"},{"location":"dynamics/#Aerosol.DiameterGrowthRate","page":"Population Dynamics","title":"Aerosol.DiameterGrowthRate","text":"DiameterGrowthRate(; name=:DiameterGrowthRate)\n\nCompute the diameter growth rate due to condensation in the continuum regime.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.11-13.13.\n\nThe diameter growth rate is given by:\n\nI_D = fracdD_pdt = frac4 D_i M_iR T D_p rho_p (p_i - p_eqi)\n\nIn the continuum regime with constant supersaturation (A = constant), this simplifies to:\n\nI_D = fracAD_p\n\nwhere A = frac4 D_i M_iR T rho_p (p_i - p_eqi).\n\n\n\n\n\n","category":"function"},{"location":"dynamics/#Aerosol.BrownianCoagulationCoefficient","page":"Population Dynamics","title":"Aerosol.BrownianCoagulationCoefficient","text":"BrownianCoagulationCoefficient(; name=:BrownianCoagulationCoefficient)\n\nCompute the Brownian coagulation coefficient using the Fuchs form, which is valid across the continuum, transition, and free-molecular regimes.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Table 13.1.\n\nThe Fuchs form of the coagulation coefficient is:\n\nK_12 = 2pi(D_1 + D_2)(D_p1 + D_p2) left( fracD_p1 + D_p2D_p1 + D_p2 + 2sqrtg_1^2 + g_2^2 + frac8(D_1 + D_2)sqrtbarc_1^2 + barc_2^2(D_p1 + D_p2) right)^-1\n\nwhere:\n\nD_i = frack T C_c3pimu D_pi is the Brownian diffusion coefficient\nbarc_i = sqrtfrac8 k Tpi m_i is the mean thermal velocity\nell_i = frac8 D_ipi barc_i is the particle mean free path\ng_i = frac13 D_pi ell_ileft(D_pi + ell_i)^3 - (D_pi^2 + ell_i^2)^32right - D_pi\n\n\n\n\n\n","category":"function"},{"location":"dynamics/#Aerosol.MonodisperseCoagulation","page":"Population Dynamics","title":"Aerosol.MonodisperseCoagulation","text":"MonodisperseCoagulation(; name=:MonodisperseCoagulation)\n\nModel the evolution of total aerosol number concentration for a monodisperse aerosol undergoing Brownian coagulation with a constant coagulation coefficient.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.65-13.67.\n\nThe governing equation is:\n\nfracdNdt = -frac12 K N^2(t)\n\nwith analytical solution:\n\nN(t) = fracN_01 + ttau_c\n\nwhere tau_c = frac2K N_0 is the characteristic coagulation time.\n\n\n\n\n\n","category":"function"},{"location":"dynamics/#Aerosol.DiscreteCoagulation","page":"Population Dynamics","title":"Aerosol.DiscreteCoagulation","text":"DiscreteCoagulation(n_bins::Int; name=:DiscreteCoagulation)\n\nModel the discrete coagulation equation for a monodisperse initial distribution with constant coagulation coefficient.\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006) Atmospheric Chemistry and Physics, 2nd Edition, Chapter 13, Eq. 13.59, 13.71.\n\nThe discrete coagulation equation for k-mers is:\n\nfracdN_kdt = frac12 sum_j=1^k-1 K_jk-j N_j N_k-j - N_k sum_j=1^infty K_kj N_j\n\nFor a constant coagulation coefficient K and monodisperse initial condition (all particles initially monomers), the analytical solution is:\n\nN_k(t) = fracN_0 (ttau_c)^k-11 + ttau_c^k+1\n\nArguments:\n\nn_bins::Int: Number of size bins (k-mer sizes to track)\n\n\n\n\n\n","category":"function"},{"location":"isorropia/#ISORROPIA","page":"ISORROPIA","title":"ISORROPIA","text":"","category":"section"},{"location":"isorropia/#Work-in-Progress","page":"ISORROPIA","title":"Work in Progress","text":"We are currently working on an implementation of ISORROPIA II, a thermodynamic equilibrium model for K⁺-Ca²⁺-Mg²⁺-NH₄⁺-Na⁺-SO₄²⁻-NO₃⁻-Cl⁻-H₂O aerosols, as described in:\n\nFountoukis, C. and Nenes, A., 2007. ISORROPIA II: a computationally efficient thermodynamic equilibrium model for K⁺–Ca²⁺–Mg²⁺–NH₄⁺–Na⁺–SO₄²⁻–NO₃⁻–Cl⁻–H₂O aerosols. Atmospheric Chemistry and Physics, 7(17), pp.4639-4659. https://doi.org/10.5194/acp-7-4639-2007\n\nThis implementation is still a work in progress and is not yet available for use. Please check back later for updates.","category":"section"},{"location":"#Aerosol.jl:-Symbolic-equation-based-aerosol-modeling","page":"Home","title":"Aerosol.jl: Symbolic equation-based aerosol modeling","text":"Documentation for Aerosol.","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"To install Aerosol.jl, use the Julia package manager:\n\nusing Pkg\nPkg.add(\"Aerosol\")","category":"section"},{"location":"#Features","page":"Home","title":"Features","text":"We are currently working on an implementation of the ISORROPIA aerosol thermodynamics model, which is still in progress.","category":"section"},{"location":"#Contributing","page":"Home","title":"Contributing","text":"...coming soon","category":"section"},{"location":"#Reproducibility","page":"Home","title":"Reproducibility","text":"<details><summary>The documentation of this EarthSciML package was built using these direct dependencies,</summary>\n\nusing Pkg # hide\nPkg.status() # hide\n\n</details>\n\n<details><summary>and using this machine and Julia version.</summary>\n\nusing InteractiveUtils # hide\nversioninfo() # hide\n\n</details>\n\n<details><summary>A more complete overview of all dependencies and their versions is also provided.</summary>\n\nusing Pkg # hide\nPkg.status(; mode = PKGMODE_MANIFEST) # hide\n\n</details>\n\nusing TOML\nusing Markdown\nversion = TOML.parse(read(\"../../Project.toml\", String))[\"version\"]\nname = TOML.parse(read(\"../../Project.toml\", String))[\"name\"]\nlink_manifest = \"https://github.com/EarthSciML/\" * name * \".jl/tree/gh-pages/v\" * version *\n                \"/assets/Manifest.toml\"\nlink_project = \"https://github.com/EarthSciML/\" * name * \".jl/tree/gh-pages/v\" * version *\n               \"/assets/Project.toml\"\nMarkdown.parse(\"\"\"You can also download the\n[manifest]($link_manifest)\nfile and the\n[project]($link_project)\nfile.\n\"\"\")","category":"section"}]
}
