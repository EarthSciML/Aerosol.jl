<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Radiative Forcing · Aerosol.jl</title><meta name="title" content="Radiative Forcing · Aerosol.jl"/><meta property="og:title" content="Radiative Forcing · Aerosol.jl"/><meta property="twitter:title" content="Radiative Forcing · Aerosol.jl"/><meta name="description" content="Documentation for Aerosol.jl."/><meta property="og:description" content="Documentation for Aerosol.jl."/><meta property="twitter:description" content="Documentation for Aerosol.jl."/><meta property="og:url" content="https://aerosol.earthsci.dev/aerosol_radiative_forcing/"/><meta property="twitter:url" content="https://aerosol.earthsci.dev/aerosol_radiative_forcing/"/><link rel="canonical" href="https://aerosol.earthsci.dev/aerosol_radiative_forcing/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Aerosol.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../dynamics/">Population Dynamics</a></li><li><a class="tocitem" href="../single_particle_dynamics/">Single Particle Dynamics</a></li><li><a class="tocitem" href="../size_distribution/">Size Distribution</a></li><li><a class="tocitem" href="../VBS/">VBS</a></li><li><a class="tocitem" href="../organic_aerosol/">Organic Aerosol</a></li><li><a class="tocitem" href="../mass_transfer/">Mass Transfer</a></li><li><a class="tocitem" href="../nucleation/">Nucleation</a></li><li><a class="tocitem" href="../aqueous_chemistry/">Aqueous Chemistry</a></li><li><span class="tocitem">Thermodynamics</span><ul><li><a class="tocitem" href="../isorropia/">ISORROPIA</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch10/">Seinfeld &amp; Pandis Ch. 10</a></li></ul></li><li class="is-active"><a class="tocitem" href>Radiative Forcing</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Physical-Interpretation"><span>Physical Interpretation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Radiative Forcing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Radiative Forcing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl/blob/main/docs/src/aerosol_radiative_forcing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Aerosol-Radiative-Forcing"><a class="docs-heading-anchor" href="#Aerosol-Radiative-Forcing">Aerosol Radiative Forcing</a><a id="Aerosol-Radiative-Forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-Radiative-Forcing" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements the aerosol radiative forcing equations from Chapter 24 (&quot;Aerosols and Climate&quot;) of Seinfeld &amp; Pandis&#39;s &quot;Atmospheric Chemistry and Physics&quot; textbook. The equations describe both direct and indirect effects of aerosols on Earth&#39;s radiation budget.</p><p><strong>Direct effects</strong> occur when aerosols scatter and absorb incoming solar radiation, modifying the planetary albedo. <strong>Indirect effects</strong> arise from aerosols acting as cloud condensation nuclei (CCN), increasing cloud droplet number concentration (CDNC) and thereby altering cloud optical properties.</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 24, pp. 1054-1091.</p><article><details class="docstring" open="true"><summary id="Aerosol.AerosolLayerRadiativeForcing"><a class="docstring-binding" href="#Aerosol.AerosolLayerRadiativeForcing"><code>Aerosol.AerosolLayerRadiativeForcing</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AerosolLayerRadiativeForcing(; name=:AerosolLayerRadiativeForcing)</code></pre><p>Aerosol layer radiative forcing model from Seinfeld &amp; Pandis (2006) Chapter 24.</p><p>This component calculates the change in outgoing radiative flux due to an aerosol layer using the scattering-absorbing model from Section 24.1. It computes the reflection and transmission coefficients, the total reflectance of the aerosol-surface system, and the change in planetary albedo.</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 24, Equations 24.1-24.10.</p><p><strong>Parameters</strong></p><ul><li><code>F_0</code>: Incident solar flux (W m⁻²)</li><li><code>τ</code>: Aerosol optical depth (dimensionless)</li><li><code>ω</code>: Single-scattering albedo (dimensionless)</li><li><code>β</code>: Upscatter fraction (dimensionless)</li><li><code>R_s</code>: Surface albedo (dimensionless)</li><li><code>A_c</code>: Cloud fraction (dimensionless)</li><li><code>T_a</code>: Atmospheric transmittance (dimensionless)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>r_aer</code>: Fraction of light reflected upward by aerosol (dimensionless)</li><li><code>t_aer</code>: Fraction of light transmitted through aerosol (dimensionless)</li><li><code>R_as</code>: Total reflectance of aerosol-surface system (dimensionless)</li><li><code>ΔR_p</code>: Change in planetary albedo (dimensionless)</li><li><code>ΔF</code>: Change in outgoing radiative flux (W m⁻²)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L4-L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.CriticalSingleScatteringAlbedo"><a class="docstring-binding" href="#Aerosol.CriticalSingleScatteringAlbedo"><code>Aerosol.CriticalSingleScatteringAlbedo</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CriticalSingleScatteringAlbedo(; name=:CriticalSingleScatteringAlbedo)</code></pre><p>Component to calculate the critical single-scattering albedo (ω_crit) at which an aerosol layer transitions from cooling to heating the climate system.</p><p>From Seinfeld &amp; Pandis (2006) Chapter 24, Equation 24.15: ω<em>crit = 2*R</em>s / (2<em>R_s + β</em>(1-R_s)²)</p><p>When ω &gt; ω<em>crit, the aerosol causes net cooling (increased reflection). When ω &lt; ω</em>crit, the aerosol causes net heating (absorption dominates).</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24, Section 24.2.</p><p><strong>Parameters</strong></p><ul><li><code>R_s</code>: Surface albedo (dimensionless)</li><li><code>β</code>: Upscatter fraction (dimensionless)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>ω_crit</code>: Critical single-scattering albedo (dimensionless)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L82-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.CloudOpticalDepth"><a class="docstring-binding" href="#Aerosol.CloudOpticalDepth"><code>Aerosol.CloudOpticalDepth</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CloudOpticalDepth(; name=:CloudOpticalDepth)</code></pre><p>Component to calculate cloud optical depth from liquid water content and droplet number concentration.</p><p>From Seinfeld &amp; Pandis (2006) Chapter 24, Section 24.8.1: τ<em>c = h * (9π<em>L²</em>N / 2ρ</em>w²)^(1/3)    (Eq. 24.36)</p><p>This relates cloud optical depth to cloud thickness (h), liquid water content (L), and cloud droplet number concentration (N).</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24, Section 24.8.1, Equations 24.34-24.36.</p><p><strong>Parameters</strong></p><ul><li><code>h</code>: Cloud thickness (m)</li><li><code>L</code>: Liquid water content (kg m⁻³)</li><li><code>N</code>: Cloud droplet number concentration (m⁻³)</li></ul><p><strong>Constants</strong></p><ul><li><code>ρ_w</code>: Density of water (kg m⁻³)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>τ_c</code>: Cloud optical depth (dimensionless)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L125-L153">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.CloudAlbedo"><a class="docstring-binding" href="#Aerosol.CloudAlbedo"><code>Aerosol.CloudAlbedo</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CloudAlbedo(; name=:CloudAlbedo)</code></pre><p>Component to calculate cloud albedo from optical depth using the two-stream approximation.</p><p>From Seinfeld &amp; Pandis (2006) Chapter 24, Section 24.8.1: R<em>c = τ</em>c / (τ_c + γ)    (Eq. 24.38, simplified form for g = 0.85)</p><p>where γ = 7.7 for an asymmetry factor g = 0.85 (typical for cloud droplets).</p><p>The general two-stream approximation (Eq. 24.37) is: R<em>c = √3<em>(1-g)</em>τ</em>c / (2 + √3<em>(1-g)</em>τ_c)</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24, Section 24.8.1, Equations 24.37-24.38.</p><p><strong>Parameters</strong></p><ul><li><code>τ_c</code>: Cloud optical depth (dimensionless)</li><li><code>g</code>: Asymmetry factor (dimensionless, default 0.85)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>R_c</code>: Cloud albedo (dimensionless)</li><li><code>γ</code>: Denominator coefficient for two-stream approximation (dimensionless)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L178-L204">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.CloudAlbedoSensitivity"><a class="docstring-binding" href="#Aerosol.CloudAlbedoSensitivity"><code>Aerosol.CloudAlbedoSensitivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CloudAlbedoSensitivity(; name=:CloudAlbedoSensitivity)</code></pre><p>Component to calculate the sensitivity of cloud albedo to cloud droplet number concentration (Twomey susceptibility).</p><p>From Seinfeld &amp; Pandis (2006) Chapter 24, Section 24.8.2: dR<em>c/dN = R</em>c<em>(1-R<em>c)/(3N)    (Eq. 24.40) dR</em>c/d(ln N) = R_c</em>(1-R_c)/3  (Eq. 24.41, Twomey susceptibility)</p><p>The maximum susceptibility occurs at R_c = 0.5.</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24, Section 24.8.2, Equations 24.39-24.42.</p><p><strong>Parameters</strong></p><ul><li><code>R_c</code>: Cloud albedo (dimensionless)</li><li><code>N</code>: Cloud droplet number concentration (m⁻³)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>dRc_dN</code>: Sensitivity of cloud albedo to CDNC (m³)</li><li><code>S</code>: Twomey susceptibility dR_c/d(ln N) (dimensionless)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L229-L253">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.IndirectAerosolForcing"><a class="docstring-binding" href="#Aerosol.IndirectAerosolForcing"><code>Aerosol.IndirectAerosolForcing</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">IndirectAerosolForcing(; name=:IndirectAerosolForcing)</code></pre><p>Component to calculate the indirect radiative forcing from aerosol effects on cloud albedo (first indirect effect, or Twomey effect).</p><p>From Seinfeld &amp; Pandis (2006) Chapter 24, Section 24.8.2: ΔF<em>c = -F</em>0 * A<em>c * T</em>a² * ΔR<em>c    (Eq. 24.43) ΔR</em>c = R<em>c*(1-R</em>c)/3 * Δln(N)      (Eq. 24.42)</p><p>This gives the change in shortwave forcing due to changes in cloud albedo caused by changes in cloud droplet number concentration.</p><p><strong>Reference</strong>: Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24, Section 24.8.2, Equations 24.42-24.43.</p><p><strong>Parameters</strong></p><ul><li><code>F_0</code>: Incident solar flux (W m⁻²)</li><li><code>A_c</code>: Cloud fraction (dimensionless)</li><li><code>T_a</code>: Atmospheric transmittance (dimensionless)</li><li><code>R_c</code>: Cloud albedo (dimensionless)</li><li><code>Δln_N</code>: Fractional change in CDNC, Δln(N) = ΔN/N (dimensionless)</li></ul><p><strong>Variables (computed)</strong></p><ul><li><code>ΔR_c</code>: Change in cloud albedo (dimensionless)</li><li><code>ΔF_c</code>: Change in shortwave forcing (W m⁻²)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/529636a9b5f9d85cf7428200cc6f87f3bf9ae482/src/aerosol_radiative_forcing.jl#L277-L305">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The module provides six <code>@component</code> functions that implement the key equations from Chapter 24:</p><ol><li><strong>AerosolLayerRadiativeForcing</strong>: Calculates the change in outgoing radiative flux due to an aerosol layer (Eqs. 24.1-24.10)</li><li><strong>CriticalSingleScatteringAlbedo</strong>: Determines the boundary between aerosol cooling and heating (Eq. 24.15)</li><li><strong>CloudOpticalDepth</strong>: Relates cloud optical depth to microphysical properties (Eq. 24.36)</li><li><strong>CloudAlbedo</strong>: Computes cloud albedo from optical depth using two-stream approximation (Eqs. 24.37-24.38)</li><li><strong>CloudAlbedoSensitivity</strong>: Quantifies the Twomey susceptibility (Eqs. 24.40-24.41)</li><li><strong>IndirectAerosolForcing</strong>: Calculates the first indirect effect of aerosols on climate (Eqs. 24.42-24.43)</li></ol><h3 id="System-Variables"><a class="docs-heading-anchor" href="#System-Variables">System Variables</a><a id="System-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#System-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using Aerosol

sys = AerosolLayerRadiativeForcing()

vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [repr(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">r_aer</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Fraction of light reflected upward by aerosol</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">t_aer</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Fraction of light transmitted through aerosol</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_as</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Total reflectance of aerosol-surface system</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ΔR_p</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Change in planetary albedo</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ΔF</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Change in outgoing radiative flux</td></tr></tbody></table></div><h3 id="System-Parameters"><a class="docs-heading-anchor" href="#System-Parameters">System Parameters</a><a id="System-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#System-Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [repr(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">τ</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Aerosol optical depth (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">β</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Upscatter fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_s</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Surface albedo (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">A_c</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Cloud fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">T_a</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Atmospheric transmittance (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">F_0</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Incident solar flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">ω</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Single-scattering albedo (dimensionless)</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{r\_aer}\left( t \right) &amp;= \left( 1 - e^{ - \tau} \right) \beta \omega \\
\mathtt{t\_aer}\left( t \right) &amp;= e^{ - \tau} + \left( 1 - e^{ - \tau} \right) \left( 1 - \beta \right) \omega \\
\mathtt{R\_as}\left( t \right) &amp;= \mathtt{r\_aer}\left( t \right) + \frac{\left( \mathtt{t\_aer}\left( t \right) \right)^{2} \mathtt{R\_s}}{1 - \mathtt{R\_s} \mathtt{r\_aer}\left( t \right)} \\
\mathtt{{\Delta}R\_p}\left( t \right) &amp;= \mathtt{T\_a}^{2} \left( 1 - \mathtt{A\_c} \right) \left(  - \mathtt{R\_s} + \mathtt{R\_as}\left( t \right) \right) \\
\mathtt{{\Delta}F}\left( t \right) &amp;= \mathtt{F\_0} \mathtt{{\Delta}R\_p}\left( t \right)
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Table-24.2:-Global-Mean-Parameters-for-Sulfate-Aerosol-Forcing"><a class="docs-heading-anchor" href="#Table-24.2:-Global-Mean-Parameters-for-Sulfate-Aerosol-Forcing">Table 24.2: Global Mean Parameters for Sulfate Aerosol Forcing</a><a id="Table-24.2:-Global-Mean-Parameters-for-Sulfate-Aerosol-Forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Table-24.2:-Global-Mean-Parameters-for-Sulfate-Aerosol-Forcing" title="Permalink"></a></h3><p>The following table presents global mean values of the parameters in Equation 24.29 for estimating direct radiative forcing by anthropogenic sulfate aerosol, along with estimated uncertainty factors (from Penner et al. 1994).</p><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Value</th><th style="text-align: left">Units</th><th style="text-align: left">Uncertainty Factor</th></tr><tr><td style="text-align: left">F₀</td><td style="text-align: left">1370</td><td style="text-align: left">W m⁻²</td><td style="text-align: left">—</td></tr><tr><td style="text-align: left">1 - Aᶜ</td><td style="text-align: left">0.4</td><td style="text-align: left">—</td><td style="text-align: left">1.1</td></tr><tr><td style="text-align: left">Tₐ</td><td style="text-align: left">0.76</td><td style="text-align: left">—</td><td style="text-align: left">1.15</td></tr><tr><td style="text-align: left">1 - Rₛ</td><td style="text-align: left">0.85</td><td style="text-align: left">—</td><td style="text-align: left">1.1</td></tr><tr><td style="text-align: left">β̄</td><td style="text-align: left">0.29</td><td style="text-align: left">—</td><td style="text-align: left">1.3</td></tr><tr><td style="text-align: left">α_{SO₄}^{RH}</td><td style="text-align: left">5ᵇ</td><td style="text-align: left">m²(g SO₄²⁻)⁻¹</td><td style="text-align: left">1.5</td></tr><tr><td style="text-align: left">f(RH)</td><td style="text-align: left">1.7</td><td style="text-align: left">—</td><td style="text-align: left">1.2</td></tr><tr><td style="text-align: left">Q_{SO₂}</td><td style="text-align: left">80</td><td style="text-align: left">Tg yr⁻¹</td><td style="text-align: left">1.15</td></tr><tr><td style="text-align: left">γ_{SO₂}</td><td style="text-align: left">0.4</td><td style="text-align: left">—</td><td style="text-align: left">1.5</td></tr><tr><td style="text-align: left">τ_{SO₄}</td><td style="text-align: left">0.02</td><td style="text-align: left">yr</td><td style="text-align: left">1.5</td></tr><tr><td style="text-align: left">A</td><td style="text-align: left">5 × 10¹⁴</td><td style="text-align: left">m²</td><td style="text-align: left">—</td></tr></table><p>ᵃThe central value, divided/multiplied by the uncertainty factor, gives the estimated range of values of the parameter. ᵇIncludes associated cations.</p><p><em>Source</em>: Penner et al. (1994).</p><h3 id="Figure-24.2:-Critical-Single-Scattering-Albedo"><a class="docs-heading-anchor" href="#Figure-24.2:-Critical-Single-Scattering-Albedo">Figure 24.2: Critical Single-Scattering Albedo</a><a id="Figure-24.2:-Critical-Single-Scattering-Albedo-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-24.2:-Critical-Single-Scattering-Albedo" title="Permalink"></a></h3><p>The critical single-scattering albedo ω<em>crit defines the boundary between aerosol-induced cooling (ω &gt; ω</em>crit) and heating (ω &lt; ω<em>crit). This depends on surface albedo R</em>s and the upscatter fraction β.</p><p>From Equation 24.15:</p><p class="math-container">\[\omega_{\text{crit}} = \frac{2R_s}{2R_s + \beta(1-R_s)^2}\]</p><pre><code class="language-julia hljs">using Plots

# Calculate critical SSA for various surface albedos and upscatter fractions
R_s_vals = 0.0:0.01:1.0
β_vals = [0.1, 0.2, 0.3, 0.4]

p = plot(
    xlabel = &quot;Surface Albedo (Rₛ)&quot;, ylabel = &quot;Critical Single-Scattering Albedo (ωcrit)&quot;,
    title = &quot;Figure 24.2: Critical SSA vs Surface Albedo&quot;,
    legend = :bottomright, ylim = (0, 1))

for β in β_vals
    ω_crit = [2 * R_s / (2 * R_s + β * (1 - R_s)^2) for R_s in R_s_vals]
    plot!(p, R_s_vals, ω_crit, label = &quot;β = $β&quot;, linewidth = 2)
end

# Mark typical values
R_s_typical = 0.15
β_typical = 0.29
ω_crit_typical = 2 * R_s_typical / (2 * R_s_typical + β_typical * (1 - R_s_typical)^2)
scatter!(p, [R_s_typical], [ω_crit_typical], markersize = 8, color = :red,
    label = &quot;Typical (Rₛ=0.15, β=0.29)&quot;)

p</code></pre><img src="91a189e2.svg" alt="Example block output"/><p>For the global mean surface albedo (R<em>s ≈ 0.15) and typical upscatter fraction (β ≈ 0.29), ω</em>crit ≈ 0.6. This means sulfate aerosols (ω ≈ 0.95) cause net cooling, while highly absorbing aerosols like black carbon can cause heating.</p><h3 id="Figure-24.16:-Cloud-Albedo-vs-Optical-Depth"><a class="docs-heading-anchor" href="#Figure-24.16:-Cloud-Albedo-vs-Optical-Depth">Figure 24.16: Cloud Albedo vs Optical Depth</a><a id="Figure-24.16:-Cloud-Albedo-vs-Optical-Depth-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-24.16:-Cloud-Albedo-vs-Optical-Depth" title="Permalink"></a></h3><p>Cloud albedo increases with optical depth according to the two-stream approximation (Eq. 24.38):</p><p class="math-container">\[R_c = \frac{\tau_c}{\tau_c + \gamma}\]</p><p>where γ ≈ 7.7 for an asymmetry factor g = 0.85.</p><pre><code class="language-julia hljs"># Cloud albedo vs optical depth
τ_c_vals = 0.0:0.5:100.0
g = 0.85
γ = 2 / (sqrt(3) * (1 - g))

R_c_vals = [τ / (τ + γ) for τ in τ_c_vals]

p = plot(τ_c_vals, R_c_vals, xlabel = &quot;Cloud Optical Depth (τc)&quot;,
    ylabel = &quot;Cloud Albedo (Rc)&quot;, title = &quot;Figure 24.16: Cloud Albedo vs Optical Depth&quot;,
    linewidth = 2, legend = false, xlim = (0, 100), ylim = (0, 1))

# Mark half-albedo point
scatter!(p, [γ], [0.5], markersize = 8, color = :red)
annotate!(p, γ + 5, 0.52, text(&quot;τc = γ ≈ 7.7\nRc = 0.5&quot;, 8, :left))

p</code></pre><img src="ffd9691e.svg" alt="Example block output"/><h3 id="Figure-24.18:-Twomey-Susceptibility"><a class="docs-heading-anchor" href="#Figure-24.18:-Twomey-Susceptibility">Figure 24.18: Twomey Susceptibility</a><a id="Figure-24.18:-Twomey-Susceptibility-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-24.18:-Twomey-Susceptibility" title="Permalink"></a></h3><p>The Twomey susceptibility quantifies how cloud albedo responds to changes in droplet number concentration (Eq. 24.41):</p><p class="math-container">\[\frac{dR_c}{d \ln N} = \frac{R_c(1-R_c)}{3}\]</p><p>Maximum susceptibility occurs at R_c = 0.5.</p><pre><code class="language-julia hljs">R_c_vals = 0.0:0.01:1.0
S_vals = [R * (1 - R) / 3 for R in R_c_vals]

p = plot(R_c_vals, S_vals, xlabel = &quot;Cloud Albedo (Rc)&quot;,
    ylabel = &quot;Susceptibility dRc/d(ln N)&quot;,
    title = &quot;Figure 24.18: Twomey Susceptibility&quot;,
    linewidth = 2, legend = false, xlim = (0, 1), ylim = (0, 0.1))

# Mark maximum
scatter!(p, [0.5], [0.5 * 0.5 / 3], markersize = 8, color = :red)
annotate!(p, 0.55, 0.085, text(&quot;Maximum at Rc = 0.5&quot;, 8, :left))

p</code></pre><img src="a3374817.svg" alt="Example block output"/><h3 id="Figure-24.17:-Cloud-Albedo-vs-Cloud-Droplet-Number-Concentration"><a class="docs-heading-anchor" href="#Figure-24.17:-Cloud-Albedo-vs-Cloud-Droplet-Number-Concentration">Figure 24.17: Cloud Albedo vs Cloud Droplet Number Concentration</a><a id="Figure-24.17:-Cloud-Albedo-vs-Cloud-Droplet-Number-Concentration-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-24.17:-Cloud-Albedo-vs-Cloud-Droplet-Number-Concentration" title="Permalink"></a></h3><p>Figure 24.17 shows cloud albedo as a function of cloud droplet number concentration at constant liquid water content (L = 0.3 g m⁻³). At constant liquid water content and cloud thickness, cloud albedo increases with increasing CDNC.</p><pre><code class="language-julia hljs"># Reproduce Figure 24.17: Cloud albedo vs CDNC
# Parameters from Figure 24.17 caption
L = 0.3e-3  # kg/m³ (0.3 g/m³)
ρ_w = 1000.0  # kg/m³
g = 0.85
γ = 2 / (sqrt(3) * (1 - g))

# Cloud thicknesses
h_vals = [50, 100, 500, 1500]  # meters

# CDNC range (cm⁻³)
N_cm3_range = 10.0:10.0:1000.0
N_range = N_cm3_range .* 1e6  # Convert to m⁻³

p = plot(xlabel = &quot;Cloud Droplet Number Concentration (cm⁻³)&quot;,
    ylabel = &quot;Cloud Albedo (Rᶜ)&quot;,
    title = &quot;Figure 24.17: Cloud Albedo vs CDNC (L = 0.3 g m⁻³)&quot;,
    xscale = :log10, legend = :bottomright, ylim = (0, 1))

for h in h_vals
    τ_c_vals = [h * (9 * π * L^2 * N / (2 * ρ_w^2))^(1/3) for N in N_range]
    R_c_vals = [τ / (τ + γ) for τ in τ_c_vals]
    plot!(p, N_cm3_range, R_c_vals, label = &quot;h = $h m&quot;, linewidth = 2)
end

p</code></pre><img src="b2105d1b.svg" alt="Example block output"/><p>This figure demonstrates the potential of aerosols to affect climate indirectly. For a cloud 50 m thick, increasing CDNC from 100 to 1000 cm⁻³ nearly doubles cloud albedo (from ~0.2 to ~0.4).</p><h3 id="Cloud-Optical-Depth-Sensitivity"><a class="docs-heading-anchor" href="#Cloud-Optical-Depth-Sensitivity">Cloud Optical Depth Sensitivity</a><a id="Cloud-Optical-Depth-Sensitivity-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-Optical-Depth-Sensitivity" title="Permalink"></a></h3><p>The relationship between cloud optical depth and cloud droplet number concentration (Eq. 24.36):</p><p class="math-container">\[\tau_c = h \left(\frac{9\pi L^2 N}{2\rho_w^2}\right)^{1/3}\]</p><p>This shows that τ_c increases with N^(1/3), meaning a 30% increase in CDNC produces approximately a 9% increase in optical depth.</p><pre><code class="language-julia hljs"># Parameters from Figure 24.17
h = 500.0  # m (cloud thickness)
L = 0.3e-3  # kg/m³ (liquid water content)
ρ_w = 1000.0  # kg/m³

N_vals = 10e6:10e6:1000e6  # m⁻³

τ_c_vals = [h * (9 * π * L^2 * N / (2 * ρ_w^2))^(1/3) for N in N_vals]

# Convert to cm⁻³ for plotting
N_cm3 = N_vals ./ 1e6

p = plot(N_cm3, τ_c_vals, xlabel = &quot;Cloud Droplet Number (cm⁻³)&quot;,
    ylabel = &quot;Cloud Optical Depth (τc)&quot;,
    title = &quot;Cloud Optical Depth vs CDNC (h=500m, L=0.3 g/m³)&quot;,
    linewidth = 2, legend = false, xscale = :log10)

p</code></pre><img src="67724e20.svg" alt="Example block output"/><h3 id="Indirect-Aerosol-Forcing"><a class="docs-heading-anchor" href="#Indirect-Aerosol-Forcing">Indirect Aerosol Forcing</a><a id="Indirect-Aerosol-Forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Indirect-Aerosol-Forcing" title="Permalink"></a></h3><p>The change in shortwave forcing due to aerosol-induced changes in cloud albedo (Eq. 24.43):</p><p class="math-container">\[\Delta F_c = -F_0 \cdot A_c \cdot T_a^2 \cdot \Delta R_c\]</p><p>where ΔR_c depends on the fractional change in CDNC through the Twomey relationship.</p><pre><code class="language-julia hljs"># Calculate forcing for different fractional changes in N
F_0 = 1370.0  # W/m²
A_c = 0.6     # Cloud fraction
T_a = 0.76   # Atmospheric transmittance
R_c = 0.5    # Cloud albedo

Δln_N_vals = 0.0:0.01:0.5  # Fractional change in N

ΔR_c_vals = [R_c * (1 - R_c) / 3 * Δln_N for Δln_N in Δln_N_vals]
ΔF_c_vals = [-F_0 * A_c * T_a^2 * ΔR_c for ΔR_c in ΔR_c_vals]

# Convert to percentage for x-axis
percent_change = (exp.(Δln_N_vals) .- 1) .* 100

p = plot(percent_change, ΔF_c_vals, xlabel = &quot;Percent Increase in CDNC (%)&quot;,
    ylabel = &quot;ΔFc (W/m²)&quot;,
    title = &quot;Indirect Aerosol Forcing vs CDNC Change&quot;,
    linewidth = 2, legend = false)

# Mark 30% increase point
idx_30 = argmin(abs.(percent_change .- 30))
scatter!(p, [percent_change[idx_30]], [ΔF_c_vals[idx_30]], markersize = 8, color = :red)
annotate!(p, 35, ΔF_c_vals[idx_30] - 1,
    text(&quot;30% increase\n≈ $(round(ΔF_c_vals[idx_30], digits=1)) W/m²&quot;, 8, :left))

p</code></pre><img src="ef8cc8d0.svg" alt="Example block output"/><h2 id="Physical-Interpretation"><a class="docs-heading-anchor" href="#Physical-Interpretation">Physical Interpretation</a><a id="Physical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation" title="Permalink"></a></h2><h3 id="Direct-Aerosol-Effects"><a class="docs-heading-anchor" href="#Direct-Aerosol-Effects">Direct Aerosol Effects</a><a id="Direct-Aerosol-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Aerosol-Effects" title="Permalink"></a></h3><p>The direct radiative forcing of aerosols depends on three key properties:</p><ol><li><p><strong>Single-scattering albedo (ω)</strong>: The fraction of extinction due to scattering vs absorption. Pure sulfate aerosols have ω ≈ 0.95-1.0, while black carbon has ω ≈ 0.2-0.3.</p></li><li><p><strong>Upscatter fraction (β)</strong>: The fraction of scattered radiation directed upward, which depends on particle size and solar zenith angle. Typical values range from 0.1-0.4.</p></li><li><p><strong>Aerosol optical depth (τ)</strong>: The integrated extinction through the aerosol layer. Typical tropospheric values are τ ≈ 0.1.</p></li></ol><h3 id="Indirect-Aerosol-Effects"><a class="docs-heading-anchor" href="#Indirect-Aerosol-Effects">Indirect Aerosol Effects</a><a id="Indirect-Aerosol-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Indirect-Aerosol-Effects" title="Permalink"></a></h3><p>The first indirect effect (Twomey effect) operates through this chain:</p><ol><li>Increased aerosol concentration → More CCN</li><li>More CCN → More cloud droplets for fixed liquid water</li><li>More droplets → Smaller droplet size</li><li>Smaller droplets → Higher cloud optical depth</li><li>Higher optical depth → Higher cloud albedo</li><li>Higher albedo → More reflected sunlight (cooling)</li></ol><p>The second indirect effect (cloud lifetime effect) involves precipitation suppression, which is not implemented in this module.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Seinfeld, J. H., and Pandis, S. N. (2006). <em>Atmospheric Chemistry and Physics</em>, Chapter 24.</li><li>Charlson, R. J., et al. (1992). Climate forcing by anthropogenic aerosols. <em>Science</em>, 255(5043), 423-430.</li><li>Twomey, S. (1977). The influence of pollution on the shortwave albedo of clouds. <em>J. Atmos. Sci.</em>, 34, 1149-1152.</li><li>Haywood, J. M., and Shine, K. P. (1995). The effect of anthropogenic sulfate and soot aerosol on the clear sky planetary radiation budget. <em>Geophys. Res. Lett.</em>, 22(5), 603-606.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../seinfeld_pandis_ch10/">« Seinfeld &amp; Pandis Ch. 10</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 21:48">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
