<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Seinfeld &amp; Pandis Ch. 10 · Aerosol.jl</title><meta name="title" content="Seinfeld &amp; Pandis Ch. 10 · Aerosol.jl"/><meta property="og:title" content="Seinfeld &amp; Pandis Ch. 10 · Aerosol.jl"/><meta property="twitter:title" content="Seinfeld &amp; Pandis Ch. 10 · Aerosol.jl"/><meta name="description" content="Documentation for Aerosol.jl."/><meta property="og:description" content="Documentation for Aerosol.jl."/><meta property="twitter:description" content="Documentation for Aerosol.jl."/><meta property="og:url" content="https://aerosol.earthsci.dev/seinfeld_pandis_ch10/"/><meta property="twitter:url" content="https://aerosol.earthsci.dev/seinfeld_pandis_ch10/"/><link rel="canonical" href="https://aerosol.earthsci.dev/seinfeld_pandis_ch10/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Aerosol.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../dynamics/">Population Dynamics</a></li><li><a class="tocitem" href="../single_particle_dynamics/">Single Particle Dynamics</a></li><li><a class="tocitem" href="../size_distribution/">Size Distribution</a></li><li><a class="tocitem" href="../VBS/">VBS</a></li><li><a class="tocitem" href="../organic_aerosol/">Organic Aerosol</a></li><li><a class="tocitem" href="../mass_transfer/">Mass Transfer</a></li><li><a class="tocitem" href="../nucleation/">Nucleation</a></li><li><a class="tocitem" href="../aqueous_chemistry/">Aqueous Chemistry</a></li><li><span class="tocitem">Thermodynamics</span><ul><li><a class="tocitem" href="../isorropia/">ISORROPIA</a></li><li class="is-active"><a class="tocitem" href>Seinfeld &amp; Pandis Ch. 10</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Functional-API-Reference"><span>Functional API Reference</span></a></li><li><a class="tocitem" href="#Module-Reference"><span>Module Reference</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Thermodynamics</a></li><li class="is-active"><a href>Seinfeld &amp; Pandis Ch. 10</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Seinfeld &amp; Pandis Ch. 10</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl/blob/main/docs/src/seinfeld_pandis_ch10.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Aerosol-Thermodynamics-(Seinfeld-and-Pandis-Ch.-10)"><a class="docs-heading-anchor" href="#Aerosol-Thermodynamics-(Seinfeld-and-Pandis-Ch.-10)">Aerosol Thermodynamics (Seinfeld &amp; Pandis Ch. 10)</a><a id="Aerosol-Thermodynamics-(Seinfeld-and-Pandis-Ch.-10)-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-Thermodynamics-(Seinfeld-and-Pandis-Ch.-10)" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements key aerosol thermodynamics equations from Chapter 10 of Seinfeld &amp; Pandis (2006). These equations govern the phase behavior, hygroscopic growth, and gas-particle partitioning of atmospheric aerosols, which are essential processes for air quality modeling and climate science.</p><p>The module provides four ModelingToolkit components:</p><ul><li><strong>KelvinEffect</strong>: Vapor pressure enhancement over curved droplet surfaces (Eq. 10.86)</li><li><strong>DRHTemperature</strong>: Temperature-dependent deliquescence relative humidity (Eq. 10.72)</li><li><strong>ZSRWaterContent</strong>: Aerosol liquid water content via the Zdanovskii-Stokes-Robinson mixing rule (Eq. 10.98)</li><li><strong>NH4NO3Equilibrium</strong>: Ammonium nitrate gas-aerosol partitioning (Eqs. 10.88, 10.91)</li></ul><p>Additionally, standalone functions are provided for all equilibrium constant calculations from Table 10.7.</p><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006) &quot;Atmospheric Chemistry and Physics: From Air Pollution to Climate Change&quot;, 2nd Edition, John Wiley &amp; Sons, Chapter 10.</p><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.KelvinEffect"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.KelvinEffect"><code>Aerosol.SeinfeldPandisCh10.KelvinEffect</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">KelvinEffect(; name=:KelvinEffect)</code></pre><p>A component that calculates the Kelvin effect on vapor pressure over curved droplet surfaces.</p><p>Implements Equation 10.86 from Seinfeld &amp; Pandis (2006):</p><p class="math-container">\[p_A = p°_A \exp\left(\frac{2\sigma M}{RT \rho_l R_p}\right)\]</p><p>where:</p><ul><li><code>p_A</code> is the vapor pressure over the droplet</li><li><code>p°_A</code> is the saturation vapor pressure over a flat surface</li><li><code>σ</code> is the surface tension</li><li><code>M</code> is the molar mass</li><li><code>R</code> is the gas constant</li><li><code>T</code> is temperature</li><li><code>ρ_l</code> is the liquid density</li><li><code>R_p</code> is the droplet radius</li></ul><p><strong>Variables</strong></p><ul><li><code>S</code>: Saturation ratio (p<em>A / p°</em>A) (dimensionless)</li><li><code>ln_S</code>: Natural log of saturation ratio (dimensionless)</li></ul><p><strong>Parameters</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>R_p</code>: Particle radius (m)</li><li><code>σ</code>: Surface tension (N/m)</li><li><code>M_mol</code>: Molar mass (kg/mol)</li><li><code>ρ_l</code>: Liquid density (kg/m³)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using ModelingToolkit, Aerosol
@mtkbuild sys = KelvinEffect()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/kelvin_effect.jl#L9-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.DRHTemperature"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.DRHTemperature"><code>Aerosol.SeinfeldPandisCh10.DRHTemperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DRHTemperature(; name=:DRHTemperature, salt=:NH4NO3)</code></pre><p>A component that calculates the temperature-dependent deliquescence relative humidity.</p><p>Implements Equation 10.72 from Seinfeld &amp; Pandis (2006):</p><p class="math-container">\[DRH(T) = DRH(298) \exp\left\{\frac{\Delta H_s}{R}\left[A\left(\frac{1}{T} - \frac{1}{298}\right) - B\ln\frac{T}{298} - C(T-298)\right]\right\}\]</p><p>where A, B, C are the solubility polynomial coefficients from Table 10.2.</p><p><strong>Parameters</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>DRH_298K</code>: DRH at 298 K (dimensionless, 0-1)</li><li><code>ΔH_s</code>: Enthalpy of solution (J/mol)</li><li><code>A_sol</code>: Solubility coefficient A (dimensionless)</li><li><code>B_sol</code>: Solubility coefficient B (K⁻¹)</li><li><code>C_sol</code>: Solubility coefficient C (K⁻²)</li></ul><p><strong>Variables</strong></p><ul><li><code>DRH</code>: Deliquescence relative humidity at temperature T (dimensionless, 0-1)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using ModelingToolkit, Aerosol
@mtkbuild sys = DRHTemperature(salt = :NH4NO3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/drh.jl#L43-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.ZSRWaterContent"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.ZSRWaterContent"><code>Aerosol.SeinfeldPandisCh10.ZSRWaterContent</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ZSRWaterContent(; name=:ZSRWaterContent, n_species=3)</code></pre><p>A component that calculates aerosol liquid water content using the ZSR mixing rule.</p><p>Implements Equation 10.98 from Seinfeld &amp; Pandis (2006):</p><p class="math-container">\[W = \sum_i \frac{C_i}{m_{i,0}(a_w)}\]</p><p>where:</p><ul><li><code>W</code> is the total aerosol liquid water content (kg water per m³ air)</li><li><code>Cᵢ</code> is the concentration of species i (mol/m³ air)</li><li><code>mᵢ,₀(aᵤ)</code> is the molality of species i in a binary solution at water activity aᵤ</li></ul><p>The water activity equals the relative humidity for equilibrium aerosols (Eq. 10.63).</p><p><strong>Parameters</strong></p><ul><li><code>RH</code>: Relative humidity as a fraction (0-1)</li><li><code>C[1:n_species]</code>: Concentrations of each salt species (mol/m³)</li><li><code>m0[1:n_species]</code>: Molalities of each species at saturation in binary solution (mol/kg)</li></ul><p><strong>Variables</strong></p><ul><li><code>W</code>: Total aerosol liquid water content (kg/m³)</li><li><code>α_w</code>: Water activity (dimensionless)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using ModelingToolkit, Aerosol
@mtkbuild sys = ZSRWaterContent(n_species = 2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/zsr.jl#L8-L44">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.NH4NO3Equilibrium"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.NH4NO3Equilibrium"><code>Aerosol.SeinfeldPandisCh10.NH4NO3Equilibrium</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">NH4NO3Equilibrium(; name=:NH4NO3Equilibrium)</code></pre><p>A component that calculates NH4NO3 gas-aerosol equilibrium.</p><p>Implements the equilibrium reactions and constants from Section 10.4.3 of Seinfeld &amp; Pandis (2006).</p><p><strong>Solid NH4NO3 equilibrium (below DRH)</strong></p><p>Eq. 10.87: NH3(g) + HNO3(g) ⇌ NH4NO3(s)</p><p>Eq. 10.91 - Dissociation constant (ppb² units):</p><p class="math-container">\[\ln K_p = 84.6 - \frac{24220}{T} - 6.1 \ln\frac{T}{298}\]</p><p><strong>Aqueous NH4NO3 equilibrium (above DRH)</strong></p><p>Eq. 10.92: NH3(g) + HNO3(g) ⇌ NH4+ + NO3-</p><p>Eq. 10.97 - Equilibrium constant:</p><p class="math-container">\[K_{AN} = 4 \times 10^{17} \exp\left\{64.7\left(\frac{298}{T} - 1\right) + 11.51\left[1 + \ln\frac{298}{T} - \frac{298}{T}\right]\right\}\]</p><p>(units: mol² kg⁻² atm⁻²)</p><p><strong>Ionic strength fraction (Eq. 10.100)</strong></p><p class="math-container">\[Y = \frac{[NH_4NO_3]}{[NH_4NO_3] + 3[(NH_4)_2SO_4]}\]</p><p><strong>Parameters</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>RH</code>: Relative humidity (0-1)</li><li><code>C_NH42SO4</code>: (NH4)2SO4 concentration for ionic strength calculation (mol/m³)</li></ul><p><strong>Variables</strong></p><ul><li><code>ln_Kp</code>: Log of solid dissociation constant (dimensionless for ppb² units)</li><li><code>Kp</code>: Solid dissociation constant (ppb²)</li><li><code>K_AN</code>: Aqueous equilibrium constant (mol² kg⁻² atm⁻²)</li><li><code>DRH</code>: Deliquescence RH of NH4NO3 (dimensionless)</li><li><code>is_aqueous</code>: 1 if RH &gt; DRH (aqueous phase), 0 otherwise (dimensionless)</li><li><code>Y</code>: Ionic strength fraction (dimensionless)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">    # Temperature coefficients with units for Eq. 10.91 and 10.88</code></pre><pre><code class="language-julia hljs">using ModelingToolkit, Aerosol
@mtkbuild sys = NH4NO3Equilibrium()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L8-L67">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="KelvinEffect-Component"><a class="docs-heading-anchor" href="#KelvinEffect-Component">KelvinEffect Component</a><a id="KelvinEffect-Component-1"></a><a class="docs-heading-anchor-permalink" href="#KelvinEffect-Component" title="Permalink"></a></h3><p>The Kelvin effect describes the enhancement of vapor pressure over a curved liquid surface relative to a flat surface (Eq. 10.86):</p><p class="math-container">\[p_A = p°_A \exp\left(\frac{2\sigma M}{RT \rho_l R_p}\right)\]</p><h4 id="Variables"><a class="docs-heading-anchor" href="#Variables">Variables</a><a id="Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Variables" title="Permalink"></a></h4><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using Aerosol, Aerosol.SeinfeldPandisCh10

sys = KelvinEffect()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ln_S</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Natural log of saturation ratio (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">S</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Saturation ratio p_A/p°_A (dimensionless)</td></tr></tbody></table></div><h4 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h4><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">ρ_l</td><td style = "text-align: left;">1.0 m⁻³ kg</td><td style = "text-align: left;">Liquid density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_p</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Particle radius</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">R_gas</td><td style = "text-align: left;">1.0 m² kg s⁻² K⁻¹ mol⁻¹</td><td style = "text-align: left;">Universal gas constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">M_mol</td><td style = "text-align: left;">1.0 kg mol⁻¹</td><td style = "text-align: left;">Molar mass</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">σ</td><td style = "text-align: left;">1.0 kg s⁻²</td><td style = "text-align: left;">Surface tension</td></tr></tbody></table></div><h4 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{ln\_S}\left( t \right) &amp;= \frac{2 \mathtt{M\_mol} \sigma}{\mathtt{R\_gas} \mathtt{R\_p} T \mathtt{\rho\_l}} \\
S\left( t \right) &amp;= e^{\mathtt{ln\_S}\left( t \right)}
\end{align}
 \]</p><h3 id="DRHTemperature-Component"><a class="docs-heading-anchor" href="#DRHTemperature-Component">DRHTemperature Component</a><a id="DRHTemperature-Component-1"></a><a class="docs-heading-anchor-permalink" href="#DRHTemperature-Component" title="Permalink"></a></h3><p>Calculates the temperature-dependent deliquescence relative humidity using Eq. 10.72:</p><p class="math-container">\[DRH(T) = DRH(298) \exp\left\{\frac{\Delta H_s}{R}\left[A\left(\frac{1}{T} - \frac{1}{298}\right) - B\ln\frac{T}{298} - C(T-298)\right]\right\}\]</p><p>where A, B, C are the solubility polynomial coefficients from Table 10.2.</p><h4 id="Variables-and-Parameters"><a class="docs-heading-anchor" href="#Variables-and-Parameters">Variables and Parameters</a><a id="Variables-and-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Variables-and-Parameters" title="Permalink"></a></h4><pre><code class="language-julia hljs">sys_drh = DRHTemperature(salt = :NH4NO3)
params_drh = parameters(sys_drh)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params_drh],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params_drh],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params_drh]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T_ref</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Reference temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">R_gas</td><td style = "text-align: left;">1.0 m² kg s⁻² K⁻¹ mol⁻¹</td><td style = "text-align: left;">Universal gas constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">B_sol</td><td style = "text-align: left;">1.0 K⁻¹</td><td style = "text-align: left;">Solubility coefficient B</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">A_sol</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Solubility coefficient A (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">C_sol</td><td style = "text-align: left;">1.0 K⁻²</td><td style = "text-align: left;">Solubility coefficient C</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">DRH_298K</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">DRH at 298 K (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">ΔH_s</td><td style = "text-align: left;">1.0 m² kg s⁻² mol⁻¹</td><td style = "text-align: left;">Enthalpy of solution</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr></tbody></table></div><h4 id="Equations-2"><a class="docs-heading-anchor" href="#Equations-2">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">equations(sys_drh)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{DRH}\left( t \right) &amp;= \mathtt{DRH\_298K} e^{\frac{\left( \mathtt{A\_sol} \left( \frac{1}{T} + \frac{-1}{\mathtt{T\_ref}} \right) - \mathtt{B\_sol} \log\left( \frac{T}{\mathtt{T\_ref}} \right) - \mathtt{C\_sol} \left( T - \mathtt{T\_ref} \right) \right) \mathtt{{\Delta}H\_s}}{\mathtt{R\_gas}}}
\end{align}
 \]</p><h3 id="ZSRWaterContent-Component"><a class="docs-heading-anchor" href="#ZSRWaterContent-Component">ZSRWaterContent Component</a><a id="ZSRWaterContent-Component-1"></a><a class="docs-heading-anchor-permalink" href="#ZSRWaterContent-Component" title="Permalink"></a></h3><p>Calculates aerosol liquid water content using the ZSR mixing rule (Eq. 10.98):</p><p class="math-container">\[W = \sum_i \frac{C_i}{m_{i,0}(a_w)}\]</p><p>where <span>$C_i$</span> is the concentration of species <span>$i$</span> and <span>$m_{i,0}(a_w)$</span> is the molality in binary solution at water activity <span>$a_w = RH$</span> (Eq. 10.63).</p><h4 id="Variables-and-Parameters-2"><a class="docs-heading-anchor" href="#Variables-and-Parameters-2">Variables and Parameters</a><a class="docs-heading-anchor-permalink" href="#Variables-and-Parameters-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">sys_zsr = ZSRWaterContent(n_species = 2)
vars_zsr = unknowns(sys_zsr)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars_zsr],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars_zsr],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars_zsr]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">α_w</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Water activity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">W</td><td style = "text-align: left;">1.0 m⁻³ kg</td><td style = "text-align: left;">Aerosol liquid water content</td></tr></tbody></table></div><h3 id="NH4NO3Equilibrium-Component"><a class="docs-heading-anchor" href="#NH4NO3Equilibrium-Component">NH4NO3Equilibrium Component</a><a id="NH4NO3Equilibrium-Component-1"></a><a class="docs-heading-anchor-permalink" href="#NH4NO3Equilibrium-Component" title="Permalink"></a></h3><p>Implements NH₄NO₃ gas-aerosol equilibrium including:</p><ul><li>Solid dissociation constant <span>$K_p$</span> (Eq. 10.91): <span>$\ln K_p = 84.6 - 24220/T - 6.1 \ln(T/298)$</span></li><li>Empirical DRH (Eq. 10.88): <span>$\ln(DRH\%) = 723.7/T + 1.6954$</span></li><li>Phase determination based on RH vs DRH</li></ul><h4 id="Equations-3"><a class="docs-heading-anchor" href="#Equations-3">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">sys_nh4 = NH4NO3Equilibrium()
equations(sys_nh4)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{ln\_Kp}\left( t \right) &amp;= \mathtt{c1\_Kp} + \frac{ - \mathtt{c2\_Kp}}{T} - \mathtt{c3\_Kp} \log\left( \frac{T}{\mathtt{T\_ref}} \right) \\
\mathtt{DRH\_out}\left( t \right) &amp;= 0.01 e^{\mathtt{c2\_DRH} + \frac{\mathtt{c1\_DRH}}{T}} \\
\mathtt{is\_aqueous}\left( t \right) &amp;= ifelse\left( \mathtt{RH} &gt; \mathtt{DRH\_out}\left( t \right), 1, 0 \right)
\end{align}
 \]</p><h3 id="Equilibrium-Constants-(Table-10.7)"><a class="docs-heading-anchor" href="#Equilibrium-Constants-(Table-10.7)">Equilibrium Constants (Table 10.7)</a><a id="Equilibrium-Constants-(Table-10.7)-1"></a><a class="docs-heading-anchor-permalink" href="#Equilibrium-Constants-(Table-10.7)" title="Permalink"></a></h3><p>Temperature-dependent equilibrium constants for 13 reactions follow the general form:</p><p class="math-container">\[K(T) = K(298) \exp\left\{a\left(\frac{298}{T} - 1\right) + b\left[1 + \ln\frac{298}{T} - \frac{298}{T}\right]\right\}\]</p><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.get_equilibrium_constant"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.get_equilibrium_constant"><code>Aerosol.SeinfeldPandisCh10.get_equilibrium_constant</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_equilibrium_constant(reaction::Symbol, T::Real)</code></pre><p>Get the equilibrium constant for a reaction at temperature T using Table 10.7 data.</p><p><strong>Arguments</strong></p><ul><li><code>reaction</code>: Symbol identifying the reaction (e.g., :NH4NO3<em>solid, :HSO4</em>dissoc)</li><li><code>T</code>: Temperature (K)</li></ul><p><strong>Returns</strong></p><p>Equilibrium constant at temperature T</p><p><strong>Available reactions</strong></p><ul><li>:NaCl_HNO3 - NaCl(s) + HNO3(g) ⇌ NaNO3(s) + HCl(g)</li><li>:HSO4_dissoc - HSO4⁻ ⇌ H⁺ + SO4²⁻</li><li>:NH3<em>HNO3</em>aq - NH3(g) + HNO3(g) ⇌ NH4⁺ + NO3⁻</li><li>:HCl_dissoc - HCl(g) ⇌ H⁺ + Cl⁻</li><li>:NH3<em>HCl</em>aq - NH3(g) + HCl(g) ⇌ NH4⁺ + Cl⁻</li><li>:Na2SO4_dissoc - Na2SO4(s) ⇌ 2Na⁺ + SO4²⁻</li><li>:NH42SO4_dissoc - (NH4)2SO4(s) ⇌ 2NH4⁺ + SO4²⁻</li><li>:HNO3_dissoc - HNO3(g) ⇌ H⁺ + NO3⁻</li><li>:NH4Cl_dissoc - NH4Cl(s) ⇌ NH3(g) + HCl(g)</li><li>:NH4NO3_solid - NH3(g) + HNO3(g) ⇌ NH4NO3(s)</li><li>:NaCl_dissoc - NaCl(s) ⇌ Na⁺ + Cl⁻</li><li>:NaHSO4_dissoc - NaHSO4(s) ⇌ Na⁺ + HSO4⁻</li><li>:NaNO3_dissoc - NaNO3(s) ⇌ Na⁺ + NO3⁻</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L220-L249">source</a></section></details></article><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Kelvin-Effect:-Saturation-Ratio-vs.-Droplet-Radius-(cf.-Figure-10.12)"><a class="docs-heading-anchor" href="#Kelvin-Effect:-Saturation-Ratio-vs.-Droplet-Radius-(cf.-Figure-10.12)">Kelvin Effect: Saturation Ratio vs. Droplet Radius (cf. Figure 10.12)</a><a id="Kelvin-Effect:-Saturation-Ratio-vs.-Droplet-Radius-(cf.-Figure-10.12)-1"></a><a class="docs-heading-anchor-permalink" href="#Kelvin-Effect:-Saturation-Ratio-vs.-Droplet-Radius-(cf.-Figure-10.12)" title="Permalink"></a></h3><p>The Kelvin effect becomes significant for particles smaller than ~100 nm. This figure shows the saturation ratio as a function of droplet radius for water at 298 K.</p><pre><code class="language-julia hljs">using Plots

# Saturation ratio vs droplet radius for water (Fig. 10.12)
R_p_range = 10 .^ range(log10(2e-9), log10(1e-6), length = 200)
S_water = [kelvin_saturation_ratio(298.0, R_p, 0.072, 0.018, 1000.0) for R_p in R_p_range]

plot(R_p_range * 1e9, S_water,
    xlabel = &quot;Droplet Radius (nm)&quot;, ylabel = &quot;Saturation Ratio S&quot;,
    label = &quot;Water (σ=0.072 N/m)&quot;,
    xscale = :log10, legend = :topright,
    title = &quot;Kelvin Effect: Vapor Pressure Enhancement&quot;,
    linewidth = 2, xlims = (1, 1000), ylims = (1.0, 1.3))

# Add other compounds from Table 10.6 for comparison
# Dioctyl phthalate (DOP)-like organic: lower surface tension
S_organic = [kelvin_saturation_ratio(298.0, R_p, 0.030, 0.104, 900.0) for R_p in R_p_range]
plot!(R_p_range * 1e9, S_organic, label = &quot;Organic (σ=0.030 N/m)&quot;,
    linewidth = 2, linestyle = :dash)

# Add reference line at S=1
hline!([1.0], label = &quot;&quot;, color = :gray, linestyle = :dot)

savefig(&quot;kelvin_effect.svg&quot;);</code></pre><p><img src="../kelvin_effect.svg" alt/></p><h3 id="DRH-Temperature-Dependence-(cf.-Figure-10.6)"><a class="docs-heading-anchor" href="#DRH-Temperature-Dependence-(cf.-Figure-10.6)">DRH Temperature Dependence (cf. Figure 10.6)</a><a id="DRH-Temperature-Dependence-(cf.-Figure-10.6)-1"></a><a class="docs-heading-anchor-permalink" href="#DRH-Temperature-Dependence-(cf.-Figure-10.6)" title="Permalink"></a></h3><p>The deliquescence relative humidity varies with temperature. Salts with positive enthalpy of solution (<span>$\Delta H_s &gt; 0$</span>) show decreasing DRH with increasing temperature, while those with negative <span>$\Delta H_s$</span> show the opposite trend.</p><pre><code class="language-julia hljs">T_range = 250.0:1.0:320.0

salts = [:NH4NO3, :NH42SO4, :NaCl, :Na2SO4, :KCl, :NaNO3]
salt_labels = [&quot;NH₄NO₃&quot;, &quot;(NH₄)₂SO₄&quot;, &quot;NaCl&quot;, &quot;Na₂SO₄&quot;, &quot;KCl&quot;, &quot;NaNO₃&quot;]

p_drh = plot(xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;DRH (%)&quot;,
    title = &quot;DRH Temperature Dependence (Eq. 10.72)&quot;,
    legend = :outertopright, ylims = (40, 100))

for (salt, label) in zip(salts, salt_labels)
    drh_vals = [drh_temperature(T, salt) * 100 for T in T_range]
    plot!(p_drh, T_range, drh_vals, label = label, linewidth = 2)
end

savefig(&quot;drh_temperature.svg&quot;);</code></pre><p><img src="../drh_temperature.svg" alt/></p><h3 id="NHNO-Dissociation-Constant-vs.-Temperature-(cf.-Figure-10.19)"><a class="docs-heading-anchor" href="#NHNO-Dissociation-Constant-vs.-Temperature-(cf.-Figure-10.19)">NH₄NO₃ Dissociation Constant vs. Temperature (cf. Figure 10.19)</a><a id="NHNO-Dissociation-Constant-vs.-Temperature-(cf.-Figure-10.19)-1"></a><a class="docs-heading-anchor-permalink" href="#NHNO-Dissociation-Constant-vs.-Temperature-(cf.-Figure-10.19)" title="Permalink"></a></h3><p>The dissociation constant <span>$K_p$</span> of solid NH₄NO₃ increases strongly with temperature, indicating that higher temperatures favor evaporation of NH₄NO₃ to NH₃(g) + HNO₃(g).</p><pre><code class="language-julia hljs">T_range_kp = 270.0:0.5:320.0
Kp_vals = [nh4no3_Kp(T) for T in T_range_kp]

plot(T_range_kp, Kp_vals,
    xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;Kp (ppb²)&quot;,
    title = &quot;NH₄NO₃ Dissociation Constant (Eq. 10.91)&quot;,
    label = &quot;Kp&quot;, linewidth = 2, yscale = :log10,
    legend = :topleft)

savefig(&quot;nh4no3_kp.svg&quot;);</code></pre><p><img src="../nh4no3_kp.svg" alt/></p><h3 id="NHNO-Deliquescence-RH-vs.-Temperature-(cf.-Figure-10.20)"><a class="docs-heading-anchor" href="#NHNO-Deliquescence-RH-vs.-Temperature-(cf.-Figure-10.20)">NH₄NO₃ Deliquescence RH vs. Temperature (cf. Figure 10.20)</a><a id="NHNO-Deliquescence-RH-vs.-Temperature-(cf.-Figure-10.20)-1"></a><a class="docs-heading-anchor-permalink" href="#NHNO-Deliquescence-RH-vs.-Temperature-(cf.-Figure-10.20)" title="Permalink"></a></h3><p>The DRH of NH₄NO₃ decreases with increasing temperature, which determines the phase transition boundary between solid and aqueous NH₄NO₃.</p><pre><code class="language-julia hljs">T_range_drh = 270.0:0.5:320.0
drh_nh4no3_emp = [nh4no3_drh(T) * 100 for T in T_range_drh]
drh_nh4no3_eq72 = [drh_temperature(T, :NH4NO3) * 100 for T in T_range_drh]

plot(T_range_drh, drh_nh4no3_emp,
    xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;DRH (%)&quot;,
    title = &quot;NH₄NO₃ DRH vs. Temperature&quot;,
    label = &quot;Empirical (Eq. 10.88)&quot;, linewidth = 2)
plot!(T_range_drh, drh_nh4no3_eq72,
    label = &quot;General form (Eq. 10.72)&quot;, linewidth = 2, linestyle = :dash)

savefig(&quot;nh4no3_drh.svg&quot;);</code></pre><p><img src="../nh4no3_drh.svg" alt/></p><h3 id="ZSR-Water-Content-vs.-Relative-Humidity"><a class="docs-heading-anchor" href="#ZSR-Water-Content-vs.-Relative-Humidity">ZSR Water Content vs. Relative Humidity</a><a id="ZSR-Water-Content-vs.-Relative-Humidity-1"></a><a class="docs-heading-anchor-permalink" href="#ZSR-Water-Content-vs.-Relative-Humidity" title="Permalink"></a></h3><p>The ZSR mixing rule predicts aerosol liquid water content as a function of relative humidity for multicomponent aerosols.</p><pre><code class="language-julia hljs">RH_range = 0.4:0.01:0.95

# Single-component water uptake
W_nh42so4 = [zsr_water_content(RH, Dict(:NH42SO4 =&gt; 1e-6)) for RH in RH_range]
W_nh4no3 = [zsr_water_content(RH, Dict(:NH4NO3 =&gt; 1e-6)) for RH in RH_range]
W_nacl = [zsr_water_content(RH, Dict(:NaCl =&gt; 1e-6)) for RH in RH_range]

# Mixed aerosol
W_mixed = [zsr_water_content(RH, Dict(:NH42SO4 =&gt; 0.5e-6, :NH4NO3 =&gt; 0.5e-6))
           for RH in RH_range]

plot(RH_range * 100, W_nh42so4 * 1e6,
    xlabel = &quot;Relative Humidity (%)&quot;, ylabel = &quot;Water Content (μmol/m³)&quot;,
    title = &quot;ZSR Aerosol Water Content (Eq. 10.98)&quot;,
    label = &quot;(NH₄)₂SO₄&quot;, linewidth = 2)
plot!(RH_range * 100, W_nh4no3 * 1e6, label = &quot;NH₄NO₃&quot;, linewidth = 2)
plot!(RH_range * 100, W_nacl * 1e6, label = &quot;NaCl&quot;, linewidth = 2)
plot!(RH_range * 100, W_mixed * 1e6, label = &quot;Mixed&quot;, linewidth = 2, linestyle = :dash)

savefig(&quot;zsr_water.svg&quot;);</code></pre><p><img src="../zsr_water.svg" alt/></p><h3 id="Temperature-Dependence-of-Equilibrium-Constants-(Table-10.7)"><a class="docs-heading-anchor" href="#Temperature-Dependence-of-Equilibrium-Constants-(Table-10.7)">Temperature Dependence of Equilibrium Constants (Table 10.7)</a><a id="Temperature-Dependence-of-Equilibrium-Constants-(Table-10.7)-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Dependence-of-Equilibrium-Constants-(Table-10.7)" title="Permalink"></a></h3><p>Selected equilibrium constants from Table 10.7 showing their temperature dependence.</p><pre><code class="language-julia hljs">T_range_eq = 260.0:1.0:320.0

reactions = [:HSO4_dissoc, :NaCl_dissoc, :NH42SO4_dissoc, :Na2SO4_dissoc]
labels = [&quot;HSO₄⁻ dissoc.&quot;, &quot;NaCl dissoc.&quot;, &quot;(NH₄)₂SO₄ dissoc.&quot;, &quot;Na₂SO₄ dissoc.&quot;]

p_eq = plot(xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;K / K(298)&quot;,
    title = &quot;Equilibrium Constants (Table 10.7, normalized)&quot;,
    legend = :topleft, yscale = :log10)

for (rxn, label) in zip(reactions, labels)
    K_ref = get_equilibrium_constant(rxn, 298.0)
    K_vals = [get_equilibrium_constant(rxn, T) / K_ref for T in T_range_eq]
    plot!(p_eq, T_range_eq, K_vals, label = label, linewidth = 2)
end

hline!([1.0], label = &quot;&quot;, color = :gray, linestyle = :dot)

savefig(&quot;equilibrium_constants.svg&quot;);</code></pre><p><img src="../equilibrium_constants.svg" alt/></p><h3 id="Ionic-Strength-Fraction-(Eq.-10.100)"><a class="docs-heading-anchor" href="#Ionic-Strength-Fraction-(Eq.-10.100)">Ionic Strength Fraction (Eq. 10.100)</a><a id="Ionic-Strength-Fraction-(Eq.-10.100)-1"></a><a class="docs-heading-anchor-permalink" href="#Ionic-Strength-Fraction-(Eq.-10.100)" title="Permalink"></a></h3><p>The ionic strength fraction <span>$Y$</span> determines the activity coefficient correction for NH₄NO₃ in the presence of (NH₄)₂SO₄:</p><p class="math-container">\[Y = \frac{[\text{NH}_4\text{NO}_3]}{[\text{NH}_4\text{NO}_3] + 3[(\text{NH}_4)_2\text{SO}_4]}\]</p><pre><code class="language-julia hljs">ratios = 0.0:0.01:1.0  # NH4NO3 fraction of total
Y_vals = [ionic_strength_fraction(r, 1-r) for r in ratios]

plot(ratios * 100, Y_vals,
    xlabel = &quot;NH₄NO₃ Mole Fraction (%)&quot;, ylabel = &quot;Ionic Strength Fraction Y&quot;,
    title = &quot;Ionic Strength Fraction (Eq. 10.100)&quot;,
    label = &quot;Y&quot;, linewidth = 2, legend = :topleft)

savefig(&quot;ionic_strength.svg&quot;);</code></pre><p><img src="../ionic_strength.svg" alt/></p><h2 id="Functional-API-Reference"><a class="docs-heading-anchor" href="#Functional-API-Reference">Functional API Reference</a><a id="Functional-API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Functional-API-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.kelvin_saturation_ratio"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.kelvin_saturation_ratio"><code>Aerosol.SeinfeldPandisCh10.kelvin_saturation_ratio</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">kelvin_saturation_ratio(T, R_p, σ, M_mol, ρ_l)</code></pre><p>Calculate the Kelvin saturation ratio for a droplet.</p><p>Implements Equation 10.86 from Seinfeld &amp; Pandis (2006).</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>R_p</code>: Particle radius (m)</li><li><code>σ</code>: Surface tension (N/m)</li><li><code>M_mol</code>: Molar mass (kg/mol)</li><li><code>ρ_l</code>: Liquid density (kg/m³)</li></ul><p><strong>Returns</strong></p><p>Saturation ratio S = p<em>A/p°</em>A (dimensionless)</p><p><strong>Example</strong></p><p>For a 50 nm water droplet at 298 K:</p><pre><code class="language-julia hljs">S = kelvin_saturation_ratio(298.0, 50e-9, 0.072, 0.018, 1000.0)
# S ≈ 1.024 (2.4% vapor pressure enhancement)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/kelvin_effect.jl#L79-L106">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.drh_temperature"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.drh_temperature"><code>Aerosol.SeinfeldPandisCh10.drh_temperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">drh_temperature(T, salt::Symbol)</code></pre><p>Calculate the DRH of a salt at temperature T using the full form of Eq. 10.72.</p><p class="math-container">\[DRH(T) = DRH(298) \exp\left\{\frac{\Delta H_s}{R}\left[A\left(\frac{1}{T} - \frac{1}{298}\right) - B\ln\frac{T}{298} - C(T-298)\right]\right\}\]</p><p>where A, B, C are the solubility polynomial coefficients from Table 10.2.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>salt</code>: Salt symbol (:NH4NO3, :NH42SO4, :NaCl, etc.)</li></ul><p><strong>Returns</strong></p><p>DRH as a decimal fraction (0-1)</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">drh = drh_temperature(280.0, :NH4NO3)  # Returns DRH of NH4NO3 at 280 K</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/drh.jl#L114-L139">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.nh4no3_drh"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.nh4no3_drh"><code>Aerosol.SeinfeldPandisCh10.nh4no3_drh</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nh4no3_drh(T)</code></pre><p>Calculate the DRH of NH4NO3 using the empirical correlation (Eq. 10.88).</p><p class="math-container">\[\ln(DRH) = \frac{723.7}{T} + 1.6954\]</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature (K)</li></ul><p><strong>Returns</strong></p><p>DRH as a decimal fraction (0-1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/drh.jl#L154-L170">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.zsr_water_content"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.zsr_water_content"><code>Aerosol.SeinfeldPandisCh10.zsr_water_content</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">zsr_water_content(RH, concentrations::Dict{Symbol,Float64})</code></pre><p>Calculate aerosol liquid water content using the ZSR mixing rule (Eq. 10.98).</p><p><strong>Arguments</strong></p><ul><li><code>RH</code>: Relative humidity as a fraction (0-1)</li><li><code>concentrations</code>: Dictionary mapping salt symbols to concentrations (mol/m³)</li></ul><p><strong>Returns</strong></p><p>Aerosol liquid water content W (kg/m³)</p><p><strong>Supported salts</strong></p><ul><li>:NH42SO4 - Ammonium sulfate</li><li>:NH4NO3 - Ammonium nitrate</li><li>:NaCl - Sodium chloride</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">W = zsr_water_content(0.8, Dict(:NH42SO4 =&gt; 1e-6, :NH4NO3 =&gt; 2e-6))  # Eq. 10.63</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/zsr.jl#L120-L145">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.nh4no3_Kp"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.nh4no3_Kp"><code>Aerosol.SeinfeldPandisCh10.nh4no3_Kp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nh4no3_Kp(T)</code></pre><p>Calculate the solid NH4NO3 dissociation constant at temperature T.</p><p>Implements Equation 10.91 from Seinfeld &amp; Pandis (2006):</p><p class="math-container">\[\ln K_p = 84.6 - \frac{24220}{T} - 6.1 \ln\frac{T}{298}\]</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature (K)</li></ul><p><strong>Returns</strong></p><p>Kp in ppb² units</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L109-L127">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.nh4no3_K_AN"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.nh4no3_K_AN"><code>Aerosol.SeinfeldPandisCh10.nh4no3_K_AN</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nh4no3_K_AN(T)</code></pre><p>Calculate the aqueous NH4NO3 equilibrium constant at temperature T.</p><p>Implements Equation 10.97 from Seinfeld &amp; Pandis (2006).</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature (K)</li></ul><p><strong>Returns</strong></p><p>K_AN in mol² kg⁻² atm⁻² units</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L132-L146">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.ionic_strength_fraction"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.ionic_strength_fraction"><code>Aerosol.SeinfeldPandisCh10.ionic_strength_fraction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ionic_strength_fraction(C_NH4NO3, C_NH42SO4)</code></pre><p>Calculate the ionic strength fraction Y (Eq. 10.100).</p><p><strong>Arguments</strong></p><ul><li><code>C_NH4NO3</code>: NH4NO3 concentration (any units, same as C_NH42SO4)</li><li><code>C_NH42SO4</code>: (NH4)2SO4 concentration (any units, same as C_NH4NO3)</li></ul><p><strong>Returns</strong></p><p>Ionic strength fraction Y (dimensionless, 0-1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L156-L169">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.equilibrium_constant_temperature"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.equilibrium_constant_temperature"><code>Aerosol.SeinfeldPandisCh10.equilibrium_constant_temperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">equilibrium_constant_temperature(K_ref, T, T_ref, a, b)</code></pre><p>Calculate temperature-dependent equilibrium constant using the standard form.</p><p class="math-container">\[K(T) = K(298) \exp\left\{a\left(\frac{298}{T} - 1\right) + b\left[1 + \ln\frac{298}{T} - \frac{298}{T}\right]\right\}\]</p><p>This form is used for equilibrium constants in Table 10.7 of Seinfeld &amp; Pandis (2006).</p><p><strong>Arguments</strong></p><ul><li><code>K_ref</code>: Equilibrium constant at reference temperature</li><li><code>T</code>: Temperature (K)</li><li><code>T_ref</code>: Reference temperature (K), typically 298</li><li><code>a</code>: First temperature coefficient</li><li><code>b</code>: Second temperature coefficient</li></ul><p><strong>Returns</strong></p><p>Equilibrium constant at temperature T</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/nh4no3_equilibrium.jl#L174-L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.binary_molality_nh42so4"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.binary_molality_nh42so4"><code>Aerosol.SeinfeldPandisCh10.binary_molality_nh42so4</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">binary_molality_nh42so4(a_w)</code></pre><p>Calculate the molality of (NH4)2SO4 in binary aqueous solution at water activity a_w.</p><p>Based on polynomial fits to water activity data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/zsr.jl#L73-L79">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.binary_molality_nh4no3"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.binary_molality_nh4no3"><code>Aerosol.SeinfeldPandisCh10.binary_molality_nh4no3</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">binary_molality_nh4no3(a_w)</code></pre><p>Calculate the molality of NH4NO3 in binary aqueous solution at water activity a_w.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/zsr.jl#L92-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10.binary_molality_nacl"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10.binary_molality_nacl"><code>Aerosol.SeinfeldPandisCh10.binary_molality_nacl</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">binary_molality_nacl(a_w)</code></pre><p>Calculate the molality of NaCl in binary aqueous solution at water activity a_w.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/zsr.jl#L106-L110">source</a></section></details></article><h2 id="Module-Reference"><a class="docs-heading-anchor" href="#Module-Reference">Module Reference</a><a id="Module-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Aerosol.SeinfeldPandisCh10"><a class="docstring-binding" href="#Aerosol.SeinfeldPandisCh10"><code>Aerosol.SeinfeldPandisCh10</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>Aerosol thermodynamics equations from Seinfeld &amp; Pandis (2006) Chapter 10.</p><p>Reference: Seinfeld, J.H. and Pandis, S.N. (2006) &quot;Atmospheric Chemistry and Physics: From Air Pollution to Climate Change&quot;, 2nd Edition, John Wiley &amp; Sons, Chapter 10.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/seinfeld_pandis_ch10/seinfeld_pandis_ch10.jl#L1-L6">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../isorropia/">« ISORROPIA</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 17:54">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
