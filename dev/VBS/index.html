<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>VBS · Aerosol.jl</title><meta name="title" content="VBS · Aerosol.jl"/><meta property="og:title" content="VBS · Aerosol.jl"/><meta property="twitter:title" content="VBS · Aerosol.jl"/><meta name="description" content="Documentation for Aerosol.jl."/><meta property="og:description" content="Documentation for Aerosol.jl."/><meta property="twitter:description" content="Documentation for Aerosol.jl."/><meta property="og:url" content="https://aerosol.earthsci.dev/VBS/"/><meta property="twitter:url" content="https://aerosol.earthsci.dev/VBS/"/><link rel="canonical" href="https://aerosol.earthsci.dev/VBS/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Aerosol.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../dynamics/">Population Dynamics</a></li><li><a class="tocitem" href="../single_particle_dynamics/">Single Particle Dynamics</a></li><li><a class="tocitem" href="../size_distribution/">Size Distribution</a></li><li class="is-active"><a class="tocitem" href>VBS</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Temperature-dependence"><span>Temperature dependence</span></a></li></ul></li><li><a class="tocitem" href="../organic_aerosol/">Organic Aerosol</a></li><li><a class="tocitem" href="../mass_transfer/">Mass Transfer</a></li><li><a class="tocitem" href="../nucleation/">Nucleation</a></li><li><a class="tocitem" href="../aqueous_chemistry/">Aqueous Chemistry</a></li><li><span class="tocitem">Thermodynamics</span><ul><li><a class="tocitem" href="../isorropia/">ISORROPIA</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch10/">Seinfeld &amp; Pandis Ch. 10</a></li></ul></li><li><a class="tocitem" href="../aerosol_radiative_forcing/">Radiative Forcing</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>VBS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>VBS</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl/blob/main/docs/src/VBS.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="VBS:-Volatility-Basis-Set-(VBS)-model-that-deals-with-the-partitioning-of-Secondary-Organic-Aerosol-(SOA)"><a class="docs-heading-anchor" href="#VBS:-Volatility-Basis-Set-(VBS)-model-that-deals-with-the-partitioning-of-Secondary-Organic-Aerosol-(SOA)">VBS: Volatility Basis Set (VBS) model that deals with the partitioning of Secondary Organic Aerosol (SOA)</a><a id="VBS:-Volatility-Basis-Set-(VBS)-model-that-deals-with-the-partitioning-of-Secondary-Organic-Aerosol-(SOA)-1"></a><a class="docs-heading-anchor-permalink" href="#VBS:-Volatility-Basis-Set-(VBS)-model-that-deals-with-the-partitioning-of-Secondary-Organic-Aerosol-(SOA)" title="Permalink"></a></h1><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>This is an implementation of the model to simulate the behavior of semivolatile organic compounds in the atmosphere, as described in Donahue et al. (2006):</p><blockquote><p><a href="https://pubs.acs.org/doi/10.1021/es052297c">Donahue, N. M., Robinson, A. L., Stanier, C. O., &amp; Pandis, S. N. (2006). Coupled partitioning, dilution, and chemical aging of semivolatile organics. <em>Environmental science &amp; technology</em>, 40(8), 2635-2643.</a></p></blockquote><p>We can create an instance of the model in the following manner. <code>Ci</code> is the input of the function, which is the organic compound concentration in all phases (air and aerosol phase), values were read from the original Figure 1.(a):</p><pre><code class="language-julia hljs">using Aerosol
using NonlinearSolve, ModelingToolkit

Ci = [2.5, 1.8, 4.0, 4.0, 5.8, 4.8, 6.3, 8.0]
ns = VBS(Ci)</code></pre><p>We could solve and visualize the results with the following codes, Let&#39;s try reproducing Figure 1.(a):</p><pre><code class="language-julia hljs">simplens = mtkcompile(ns)
guess = [29] # initial guess of the C_OA, the total organic compound in aerosol phase
prob = NonlinearProblem(simplens, guess, [])
sol = solve(prob, TrustRegion())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: `SciMLBase.NonlinearProblem(sys, u0, p; kw...)` is deprecated. Use `SciMLBase.NonlinearProblem(sys, merge(if isempty(u0)
│     Dict()
│ else
│     Dict(unknowns(sys) .=&gt; u0)
│ end, if isempty(p)
│     Dict()
│ else
│     Dict(parameters(sys) .=&gt; p)
│ end))`
│ instead.
└ @ ModelingToolkit ~/.julia/packages/ModelingToolkit/JvjlW/src/deprecations.jl:127</code></pre><p>Figure 1.(a) shows a partitioning in ideal situations that compounds are distributed without any potential effects. The green part is the concentration of organic compounds in aerosol phase and white part is the concentration in gas phase.</p><pre><code class="language-julia hljs">using Plots
p1 = begin
    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])
    p = bar(x, Ci, label = &quot;total&quot;, color = :white)
    bar!(x, sol[simplens.ξ] .* Ci, label = &quot;condensed-phase&quot;, color = :green)
    ylabel!(&quot;Organic Mass, μg/m³&quot;)
    xlabel!(&quot;log10(C*)&quot;)
    title!(&quot;Typical Ambient Partitioning&quot;)
end</code></pre><img src="75061cae.svg" alt="Example block output"/><p>Let&#39;s try reproducing Figure 1.(b): Semi-volatile emissions as they might appear near the output of a primarysource, before substantial dilution into the background atmosphere (only enough dilution to cool the emissions to ambient temperatureis assumed). The high loading leads to partitioning well into the highC* end of the distribution, as shown in brown. Note the scale oftheyaxis (mg/m³).</p><pre><code class="language-julia hljs">Ci_2 = [0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4] .* 1000 # The unit of Ci is μg/m³, and the values read from the original Figure 1(b) are in units of mg/m³
ns2 = VBS(Ci_2)
simplens2 = mtkcompile(ns2)
prob2 = NonlinearProblem(simplens2, [10000], [])
sol2 = solve(prob2, TrustRegion())
p2 = begin
    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])
    p = bar(x, Ci_2, label = &quot;total&quot;, color = :white)
    bar!(x, sol2[simplens2.ξ] .* Ci_2, label = &quot;condensed-phase&quot;, color = :red)
    ylabel!(&quot;Organic Mass, mg/m³&quot;)
    xlabel!(&quot;log10(C*)&quot;)
    title!(&quot;Cooled Fresh Emissions&quot;)
end</code></pre><img src="04f3d4dd.svg" alt="Example block output"/><p>Let&#39;s try reproducing Figure 1.(c): The effect of dilution by pure air on the emissionsdepicted above. The dilution factor of 1000 is indicated with a horizontal black arrow. Dilution by a factor of 1000 reduces the aerosolmass by a factor of 4000 because of repartitioning into the vapor phase</p><pre><code class="language-julia hljs">Ci_3 = [0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4]
simplens3 = mtkcompile(VBS(Ci_3))
sol3 = solve(NonlinearProblem(simplens3, [10], []), TrustRegion())
p3 = begin
    x = log10.([0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])
    p = bar(x, Ci_3, label = &quot;total&quot;, color = :white)
    bar!(x, sol3[simplens3.ξ] .* Ci_3, label = &quot;condensed-phase&quot;, color = :red)
    ylabel!(&quot;Organic Mass, μg/m³&quot;)
    xlabel!(&quot;log10(C*)&quot;)
    title!(&quot;Diluted Emissions (dilution factor = 1000)&quot;)
end</code></pre><img src="4a266b88.svg" alt="Example block output"/><p>Let&#39;s try reproducing Figure 1.(d): The effect of dilution, as depicted in panel b above but nowinto background air represented in panel a above. The partitioning of the background organic material and the fresh emissions are keptseparate,  in  green  and  brown,  only  for  illustrative  purposes.  The  vapor  portions  of  the  background  and  the  fresh  emissions  are  alsoseparated, though each is shown with a white bar.</p><pre><code class="language-julia hljs">p4 = begin
    x = log10.([0.4, 0.8, 1.25, 1.7, 2.1, 2.5, 3, 3.4])
    Ci_sum = Ci .+ Ci_3
    p = bar(x, Ci_sum, label = &quot;total&quot;, color = :white)
    both = sol[simplens.ξ] .* Ci .+ sol3[simplens3.ξ] .* Ci_3
    bar!(x, both, label = &quot;diluted emission&quot;, color = :red)
    bar!(x, sol[simplens.ξ] .* Ci, label = &quot;background&quot;, color = :green)
    ylabel!(&quot;Organic Mass, μg/m³&quot;)
    xlabel!(&quot;log10(C*)&quot;)
    title!(&quot;Emission &amp; Background Mixed&quot;)
end</code></pre><img src="0fc29657.svg" alt="Example block output"/><h2 id="Temperature-dependence"><a class="docs-heading-anchor" href="#Temperature-dependence">Temperature dependence</a><a id="Temperature-dependence-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-dependence" title="Permalink"></a></h2><p>Temperature dependence was taken into consideration. A  basis  set  of  saturation concentrations (ranging from 1 ng to 100 mg at 300 K) changes with temperature  according  to  the  Clausius  Clapeyron  equation. Let&#39;s try reproducing Figure 2:</p><pre><code class="language-julia hljs">Ci_t = [0.4, 0.55, 0.7, 1.1, 1.25, 1.45, 1.7, 1.8, 2] # values were read from the original Figure
ns_t = VBS(Ci_t, [0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000, 100000]) # The second input of the VBS function is different basic set at standard temperatures, ranging from 1 ng to 100 mg at 300 K
simplens_t = mtkcompile(ns_t)
prob_310 = NonlinearProblem(simplens_t, [29], [simplens_t.T=&gt;310]) # Temperature is an adjustable parameter in the model.
prob_285 = NonlinearProblem(simplens_t, [29], [simplens_t.T=&gt;285])
sol_310 = solve(prob_310, TrustRegion())
sol_285 = solve(prob_285, TrustRegion())

# Helpful visualize function
function pl_t(sol, simplens_t, string::String)
    x = log10.([0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000, 100000])
    p = bar(x, Ci_t, label = &quot;total&quot;, color = :white)
    bar!(x, sol[simplens_t.ξ] .* Ci_t, label = &quot;condensed-phase&quot;, color = :green)
    ylabel!(&quot;Organic Mass, μg/m³&quot;)
    xlabel!(&quot;log10(C*)&quot;)
    title!(string)
end
plot(pl_t(sol_310, simplens_t, &quot;310K&quot;), pl_t(sol_285, simplens_t, &quot;285K&quot;), layout = (1, 2))</code></pre><img src="94573c27.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../size_distribution/">« Size Distribution</a><a class="docs-footer-nextpage" href="../organic_aerosol/">Organic Aerosol »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 21:48">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
