<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Population Dynamics · Aerosol.jl</title><meta name="title" content="Population Dynamics · Aerosol.jl"/><meta property="og:title" content="Population Dynamics · Aerosol.jl"/><meta property="twitter:title" content="Population Dynamics · Aerosol.jl"/><meta name="description" content="Documentation for Aerosol.jl."/><meta property="og:description" content="Documentation for Aerosol.jl."/><meta property="twitter:description" content="Documentation for Aerosol.jl."/><meta property="og:url" content="https://aerosol.earthsci.dev/dynamics/"/><meta property="twitter:url" content="https://aerosol.earthsci.dev/dynamics/"/><link rel="canonical" href="https://aerosol.earthsci.dev/dynamics/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Aerosol.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Population Dynamics</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../single_particle_dynamics/">Single Particle Dynamics</a></li><li><a class="tocitem" href="../size_distribution/">Size Distribution</a></li><li><a class="tocitem" href="../VBS/">VBS</a></li><li><a class="tocitem" href="../organic_aerosol/">Organic Aerosol</a></li><li><a class="tocitem" href="../mass_transfer/">Mass Transfer</a></li><li><a class="tocitem" href="../nucleation/">Nucleation</a></li><li><a class="tocitem" href="../aqueous_chemistry/">Aqueous Chemistry</a></li><li><span class="tocitem">Thermodynamics</span><ul><li><a class="tocitem" href="../isorropia/">ISORROPIA</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch10/">Seinfeld &amp; Pandis Ch. 10</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Population Dynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Population Dynamics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Aerosol.jl/blob/main/docs/src/dynamics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Aerosol-Population-Dynamics"><a class="docs-heading-anchor" href="#Aerosol-Population-Dynamics">Aerosol Population Dynamics</a><a id="Aerosol-Population-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-Population-Dynamics" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements aerosol population dynamics equations from Chapter 13 of Seinfeld &amp; Pandis (2006), including condensational growth, Brownian coagulation, and the general dynamic equation.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 13, pp. 588-627.</p><article><details class="docstring" open="true"><summary id="Aerosol.AerosolDynamics"><a class="docstring-binding" href="#Aerosol.AerosolDynamics"><code>Aerosol.AerosolDynamics</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AerosolDynamics(; name=:AerosolDynamics)</code></pre><p>A combined system for modeling aerosol population dynamics including condensation growth and coagulation processes.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics</em>, 2nd Edition, Chapter 13.</p><p>This system provides:</p><ul><li>Condensation growth rate calculation</li><li>Brownian coagulation coefficient (Fuchs form)</li><li>Monodisperse coagulation dynamics</li></ul><p>The General Dynamic Equation (Eq. 13.86) combines these processes:</p><p><span>$\frac{\partial n(v,t)}{\partial t} = \left(\frac{\partial n}{\partial t}\right)_{coag} + \left(\frac{\partial n}{\partial t}\right)_{cond} + J_0\delta(v-v_0) + S(v) - R(v)$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/dynamics.jl#L260-L278">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.DiameterGrowthRate"><a class="docstring-binding" href="#Aerosol.DiameterGrowthRate"><code>Aerosol.DiameterGrowthRate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DiameterGrowthRate(; name=:DiameterGrowthRate)</code></pre><p>Compute the diameter growth rate due to condensation in the continuum regime.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics</em>, 2nd Edition, Chapter 13, Eq. 13.11-13.13.</p><p>The diameter growth rate is given by:</p><p><span>$I_D = \frac{dD_p}{dt} = \frac{4 D_i M_i}{R T D_p \rho_p} (p_i - p_{eq,i})$</span></p><p>In the continuum regime with constant supersaturation (A = constant), this simplifies to:</p><p><span>$I_D = \frac{A}{D_p}$</span></p><p>where <span>$A = \frac{4 D_i M_i}{R T \rho_p} (p_i - p_{eq,i})$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/dynamics.jl#L4-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.BrownianCoagulationCoefficient"><a class="docstring-binding" href="#Aerosol.BrownianCoagulationCoefficient"><code>Aerosol.BrownianCoagulationCoefficient</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">BrownianCoagulationCoefficient(; name=:BrownianCoagulationCoefficient)</code></pre><p>Compute the Brownian coagulation coefficient using the Fuchs form, which is valid across the continuum, transition, and free-molecular regimes.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics</em>, 2nd Edition, Chapter 13, Table 13.1.</p><p>The Fuchs form of the coagulation coefficient is:</p><p><span>$K_{12} = 2\pi(D_1 + D_2)(D_{p1} + D_{p2}) \left( \frac{D_{p1} + D_{p2}}{D_{p1} + D_{p2} + 2\sqrt{g_1^2 + g_2^2}} + \frac{8(D_1 + D_2)}{\sqrt{\bar{c}_1^2 + \bar{c}_2^2}(D_{p1} + D_{p2})} \right)^{-1}$</span></p><p>where:</p><ul><li><span>$D_i = \frac{k T C_c}{3\pi\mu D_{pi}}$</span> is the Brownian diffusion coefficient</li><li><span>$\bar{c}_i = \sqrt{\frac{8 k T}{\pi m_i}}$</span> is the mean thermal velocity</li><li><span>$\ell_i = \frac{8 D_i}{\pi \bar{c}_i}$</span> is the particle mean free path</li><li><span>$g_i = \frac{1}{3 D_{pi} \ell_i}\left[(D_{pi} + \ell_i)^3 - (D_{pi}^2 + \ell_i^2)^{3/2}\right] - D_{pi}$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/dynamics.jl#L55-L74">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.MonodisperseCoagulation"><a class="docstring-binding" href="#Aerosol.MonodisperseCoagulation"><code>Aerosol.MonodisperseCoagulation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MonodisperseCoagulation(; name=:MonodisperseCoagulation)</code></pre><p>Model the evolution of total aerosol number concentration for a monodisperse aerosol undergoing Brownian coagulation with a constant coagulation coefficient.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics</em>, 2nd Edition, Chapter 13, Eq. 13.65-13.67.</p><p>The governing equation is:</p><p><span>$\frac{dN}{dt} = -\frac{1}{2} K N^2(t)$</span></p><p>with analytical solution:</p><p><span>$N(t) = \frac{N_0}{1 + t/\tau_c}$</span></p><p>where <span>$\tau_c = \frac{2}{K N_0}$</span> is the characteristic coagulation time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/dynamics.jl#L159-L177">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Aerosol.DiscreteCoagulation"><a class="docstring-binding" href="#Aerosol.DiscreteCoagulation"><code>Aerosol.DiscreteCoagulation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DiscreteCoagulation(n_bins::Int; name=:DiscreteCoagulation)</code></pre><p>Model the discrete coagulation equation for a monodisperse initial distribution with constant coagulation coefficient.</p><p><strong>Reference</strong>: Seinfeld, J. H. and Pandis, S. N. (2006) <em>Atmospheric Chemistry and Physics</em>, 2nd Edition, Chapter 13, Eq. 13.59, 13.71.</p><p>The discrete coagulation equation for k-mers is:</p><p><span>$\frac{dN_k}{dt} = \frac{1}{2} \sum_{j=1}^{k-1} K_{j,k-j} N_j N_{k-j} - N_k \sum_{j=1}^{\infty} K_{kj} N_j$</span></p><p>For a constant coagulation coefficient K and monodisperse initial condition (all particles initially monomers), the analytical solution is:</p><p><span>$N_k(t) = \frac{N_0 (t/\tau_c)^{k-1}}{[1 + t/\tau_c]^{k+1}}$</span></p><p>Arguments:</p><ul><li><code>n_bins::Int</code>: Number of size bins (k-mer sizes to track)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Aerosol.jl/blob/a6208b3b3b11d25812ee704fe94208acbf2a0c0a/src/dynamics.jl#L199-L220">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Condensational-Growth"><a class="docs-heading-anchor" href="#Condensational-Growth">Condensational Growth</a><a id="Condensational-Growth-1"></a><a class="docs-heading-anchor-permalink" href="#Condensational-Growth" title="Permalink"></a></h3><p>The diameter growth rate due to condensation is given by Eq. 13.11:</p><p class="math-container">\[I_D = \frac{dD_p}{dt} = \frac{4 D_i M_i}{R T D_p \rho_p} (p_i - p_{eq,i})\]</p><p>In the continuum regime with constant supersaturation, this simplifies to Eq. 13.13:</p><p class="math-container">\[I_D = \frac{A}{D_p}\]</p><p>where <span>$A = \frac{4 D_i M_i}{R T \rho_p} (p_i - p_{eq,i})$</span> is the growth parameter.</p><p>The analytical solution for particle diameter evolution (Eq. 13.21) is:</p><p class="math-container">\[D_p^2 = D_{p0}^2 + 2At\]</p><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using Aerosol

sys = DiameterGrowthRate()

vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">D_p</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Particle diameter</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">A</td><td style = "text-align: left;">m² s⁻¹</td><td style = "text-align: left;">Growth parameter</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">I_D</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Diameter growth rate</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ρ_p</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Particle density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Δp</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Vapor pressure difference (p_i - p_eq)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_gas</td><td style = "text-align: left;">m² kg s⁻² K⁻¹ mol⁻¹</td><td style = "text-align: left;">Universal gas constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">M_i</td><td style = "text-align: left;">kg mol⁻¹</td><td style = "text-align: left;">Molecular weight of condensing species</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">D_diff</td><td style = "text-align: left;">m² s⁻¹</td><td style = "text-align: left;">Diffusion coefficient of condensing species</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">T</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} \mathtt{D\_p}\left( t \right)}{\mathrm{d}t} &amp;= \mathtt{I\_D}\left( t \right) \\
A\left( t \right) &amp;= \frac{4 \mathtt{D\_diff} \mathtt{M\_i} \mathtt{{\Delta}p}}{\mathtt{R\_gas} T \mathtt{\rho\_p}} \\
\mathtt{I\_D}\left( t \right) &amp;= \frac{A\left( t \right)}{\mathtt{D\_p}\left( t \right)}
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Particle-Growth-Curves-(Figure-13.2)"><a class="docs-heading-anchor" href="#Particle-Growth-Curves-(Figure-13.2)">Particle Growth Curves (Figure 13.2)</a><a id="Particle-Growth-Curves-(Figure-13.2)-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Growth-Curves-(Figure-13.2)" title="Permalink"></a></h3><p>This figure shows the growth of particles of different initial sizes due to condensation. Smaller particles grow more slowly in diameter because the growth rate is inversely proportional to particle size.</p><pre><code class="language-julia hljs">using Plots
using OrdinaryDiffEq
using ModelingToolkit: t

sys = DiameterGrowthRate()
compiled_sys = mtkcompile(sys)

# Parameters from Figure 13.2
D_diff = 0.1e-4  # m²/s
M_i = 0.1        # kg/mol (100 g/mol)
Δp = 1e-4        # Pa (~1 ppb at 1 atm)
T_val = 298.0    # K
ρ_p = 1000.0     # kg/m³

# Initial diameters
D_p0_values = [0.2e-6, 0.5e-6, 2.0e-6]  # 0.2, 0.5, 2 μm

tspan = (0.0, 1200.0)  # 20 minutes

plt = plot(
    xlabel = &quot;Time (minutes)&quot;,
    ylabel = &quot;Diameter (μm)&quot;,
    title = &quot;Particle Growth by Condensation&quot;,
    legend = :topleft
)

for D_p0 in D_p0_values
    prob = ODEProblem(
        compiled_sys,
        [compiled_sys.D_p =&gt; D_p0],
        tspan,
        [
            compiled_sys.D_diff =&gt; D_diff,
            compiled_sys.M_i =&gt; M_i,
            compiled_sys.Δp =&gt; Δp,
            compiled_sys.T =&gt; T_val,
            compiled_sys.ρ_p =&gt; ρ_p
        ]
    )
    sol = solve(prob)

    plot!(plt, sol.t ./ 60, sol[compiled_sys.D_p] .* 1e6,
        label = &quot;D₀ = $(D_p0 * 1e6) μm&quot;)
end

plt</code></pre><img src="f043fa7d.svg" alt="Example block output"/><h3 id="Brownian-Coagulation-Coefficient"><a class="docs-heading-anchor" href="#Brownian-Coagulation-Coefficient">Brownian Coagulation Coefficient</a><a id="Brownian-Coagulation-Coefficient-1"></a><a class="docs-heading-anchor-permalink" href="#Brownian-Coagulation-Coefficient" title="Permalink"></a></h3><p>The Brownian coagulation coefficient determines how fast particles of different sizes collide and stick together. The Fuchs form (Table 13.1) provides an interpolation formula that is valid across all regimes:</p><pre><code class="language-julia hljs">sys_coag = BrownianCoagulationCoefficient()

# Show the coagulation coefficient equations
equations(sys_coag)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{m\_1}\left( t \right) &amp;= \frac{1}{6} \mathtt{D\_p1}^{3} \mathtt{\pi\_val} \mathtt{\rho\_p} \\
\mathtt{m\_2}\left( t \right) &amp;= \frac{1}{6} \mathtt{D\_p2}^{3} \mathtt{\pi\_val} \mathtt{\rho\_p} \\
\mathtt{Kn\_1}\left( t \right) &amp;= \frac{2 \mathtt{\lambda\_air}}{\mathtt{D\_p1}} \\
\mathtt{Kn\_2}\left( t \right) &amp;= \frac{2 \mathtt{\lambda\_air}}{\mathtt{D\_p2}} \\
\mathtt{C\_c1}\left( t \right) &amp;= 1 + \left( 1.257 + 0.4 e^{\frac{-1.1}{\mathtt{Kn\_1}\left( t \right)}} \right) \mathtt{Kn\_1}\left( t \right) \\
\mathtt{C\_c2}\left( t \right) &amp;= 1 + \left( 1.257 + 0.4 e^{\frac{-1.1}{\mathtt{Kn\_2}\left( t \right)}} \right) \mathtt{Kn\_2}\left( t \right) \\
\mathtt{D\_1}\left( t \right) &amp;= \frac{T \mathtt{k\_B} \mathtt{C\_c1}\left( t \right)}{3 \mathtt{D\_p1} \mu \mathtt{\pi\_val}} \\
\mathtt{D\_2}\left( t \right) &amp;= \frac{T \mathtt{k\_B} \mathtt{C\_c2}\left( t \right)}{3 \mathtt{D\_p2} \mu \mathtt{\pi\_val}} \\
\mathtt{c\_bar\_1}\left( t \right) &amp;= \sqrt{\frac{8 T \mathtt{k\_B}}{\mathtt{m\_1}\left( t \right) \mathtt{\pi\_val}}} \\
\mathtt{c\_bar\_2}\left( t \right) &amp;= \sqrt{\frac{8 T \mathtt{k\_B}}{\mathtt{m\_2}\left( t \right) \mathtt{\pi\_val}}} \\
\mathtt{\ell\_1}\left( t \right) &amp;= \frac{8 \mathtt{D\_1}\left( t \right)}{\mathtt{c\_bar\_1}\left( t \right) \mathtt{\pi\_val}} \\
\mathtt{\ell\_2}\left( t \right) &amp;= \frac{8 \mathtt{D\_2}\left( t \right)}{\mathtt{c\_bar\_2}\left( t \right) \mathtt{\pi\_val}} \\
\mathtt{g\_1}\left( t \right) &amp;=  - \mathtt{D\_p1} + \frac{ - \left( \mathtt{D\_p1}^{2} + \left( \mathtt{\ell\_1}\left( t \right) \right)^{2} \right)^{1.5} + \left( \mathtt{D\_p1} + \mathtt{\ell\_1}\left( t \right) \right)^{3}}{3 \mathtt{D\_p1} \mathtt{\ell\_1}\left( t \right)} \\
\mathtt{g\_2}\left( t \right) &amp;=  - \mathtt{D\_p2} + \frac{ - \left( \mathtt{D\_p2}^{2} + \left( \mathtt{\ell\_2}\left( t \right) \right)^{2} \right)^{1.5} + \left( \mathtt{D\_p2} + \mathtt{\ell\_2}\left( t \right) \right)^{3}}{3 \mathtt{D\_p2} \mathtt{\ell\_2}\left( t \right)} \\
\mathtt{K\_12}\left( t \right) &amp;= \frac{2 \left( \mathtt{D\_p1} + \mathtt{D\_p2} \right) \left( \mathtt{D\_1}\left( t \right) + \mathtt{D\_2}\left( t \right) \right) \mathtt{\pi\_val}}{\frac{\mathtt{D\_p1} + \mathtt{D\_p2}}{\mathtt{D\_p1} + \mathtt{D\_p2} + 2 \sqrt{\left( \mathtt{g\_1}\left( t \right) \right)^{2} + \left( \mathtt{g\_2}\left( t \right) \right)^{2}}} + \frac{8 \left( \mathtt{D\_1}\left( t \right) + \mathtt{D\_2}\left( t \right) \right)}{\left( \mathtt{D\_p1} + \mathtt{D\_p2} \right) \sqrt{\left( \mathtt{c\_bar\_1}\left( t \right) \right)^{2} + \left( \mathtt{c\_bar\_2}\left( t \right) \right)^{2}}}}
\end{align}
 \]</p><p>The coagulation coefficient depends strongly on particle size, with a minimum for particles of similar size in the transition regime and higher values for either very small particles (free molecular regime) or very large particles (continuum regime), or for particles of very different sizes.</p><h3 id="Monodisperse-Coagulation-Dynamics-(Eq.-13.65-13.67)"><a class="docs-heading-anchor" href="#Monodisperse-Coagulation-Dynamics-(Eq.-13.65-13.67)">Monodisperse Coagulation Dynamics (Eq. 13.65-13.67)</a><a id="Monodisperse-Coagulation-Dynamics-(Eq.-13.65-13.67)-1"></a><a class="docs-heading-anchor-permalink" href="#Monodisperse-Coagulation-Dynamics-(Eq.-13.65-13.67)" title="Permalink"></a></h3><p>For a monodisperse aerosol with constant coagulation coefficient, the total number concentration evolves according to:</p><p class="math-container">\[\frac{dN}{dt} = -\frac{1}{2} K N^2\]</p><p>with analytical solution:</p><p class="math-container">\[N(t) = \frac{N_0}{1 + t/\tau_c}\]</p><p>where <span>$\tau_c = \frac{2}{K N_0}$</span> is the characteristic coagulation time.</p><pre><code class="language-julia hljs">sys_mono = MonodisperseCoagulation()
compiled_mono = mtkcompile(sys_mono)

N_0_val = 1e12  # 10⁶ cm⁻³ = 10¹² m⁻³
K_val = 1e-15   # m³/s
τ_c = 2 / (K_val * N_0_val)

prob_mono = ODEProblem(
    compiled_mono,
    [compiled_mono.N =&gt; N_0_val],
    (0.0, 5 * τ_c),
    [
        compiled_mono.K =&gt; K_val,
        compiled_mono.N_0 =&gt; N_0_val
    ]
)
sol_mono = solve(prob_mono)

# Plot numerical vs analytical solution
t_plot = range(0, 5 * τ_c, length = 100)
N_analytical = N_0_val ./ (1 .+ t_plot ./ τ_c)

plot(sol_mono.t ./ τ_c, sol_mono[compiled_mono.N] ./ N_0_val,
    label = &quot;Numerical&quot;, lw = 2,
    xlabel = &quot;t / τc&quot;,
    ylabel = &quot;N / N₀&quot;,
    title = &quot;Monodisperse Coagulation (Eq. 13.66)&quot;)
plot!(t_plot ./ τ_c, N_analytical ./ N_0_val,
    label = &quot;Analytical: N₀/(1 + t/τc)&quot;, ls = :dash, lw = 2)</code></pre><img src="8dcd096b.svg" alt="Example block output"/><h3 id="Characteristic-Coagulation-Time"><a class="docs-heading-anchor" href="#Characteristic-Coagulation-Time">Characteristic Coagulation Time</a><a id="Characteristic-Coagulation-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Characteristic-Coagulation-Time" title="Permalink"></a></h3><p>The characteristic coagulation time depends on both the coagulation coefficient and the initial number concentration. For atmospheric aerosols:</p><table><tr><th style="text-align: left">N₀ (m⁻³)</th><th style="text-align: left">K (m³/s)</th><th style="text-align: left">τc</th><th style="text-align: left">Physical Interpretation</th></tr><tr><td style="text-align: left">10¹⁰</td><td style="text-align: left">10⁻¹⁵</td><td style="text-align: left">~55 hours</td><td style="text-align: left">Clean background</td></tr><tr><td style="text-align: left">10¹²</td><td style="text-align: left">10⁻¹⁵</td><td style="text-align: left">~33 minutes</td><td style="text-align: left">Polluted urban</td></tr><tr><td style="text-align: left">10¹⁴</td><td style="text-align: left">10⁻¹⁵</td><td style="text-align: left">~20 seconds</td><td style="text-align: left">Fresh emissions</td></tr></table><h3 id="Discrete-Coagulation-(Eq.-13.59,-13.71)"><a class="docs-heading-anchor" href="#Discrete-Coagulation-(Eq.-13.59,-13.71)">Discrete Coagulation (Eq. 13.59, 13.71)</a><a id="Discrete-Coagulation-(Eq.-13.59,-13.71)-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Coagulation-(Eq.-13.59,-13.71)" title="Permalink"></a></h3><p>For an initially monodisperse aerosol, the evolution of k-mer concentrations follows the discrete coagulation equation. The analytical solution for constant K is:</p><p class="math-container">\[N_k(t) = \frac{N_0 (t/\tau_c)^{k-1}}{[1 + t/\tau_c]^{k+1}}\]</p><pre><code class="language-julia hljs">n_bins = 8
sys_discrete = DiscreteCoagulation(n_bins)
compiled_discrete = mtkcompile(sys_discrete)

# Initially all monomers
u0 = [compiled_discrete.N[1] =&gt; N_0_val]
for k in 2:n_bins
    push!(u0, compiled_discrete.N[k] =&gt; 0.0)
end

prob_discrete = ODEProblem(
    compiled_discrete,
    u0,
    (0.0, 3 * τ_c),
    [
        compiled_discrete.K =&gt; K_val,
        compiled_discrete.N_0 =&gt; N_0_val
    ]
)
sol_discrete = solve(prob_discrete)

# Plot k-mer evolution
plt_kmer = plot(
    xlabel = &quot;t / τc&quot;,
    ylabel = &quot;Nk / N₀&quot;,
    title = &quot;Evolution of k-mer Concentrations (Eq. 13.71)&quot;,
    legend = :topright
)

for k in 1:min(5, n_bins)
    plot!(plt_kmer, sol_discrete.t ./ τ_c,
        sol_discrete[compiled_discrete.N[k]] ./ N_0_val,
        label = &quot;N$k&quot;, lw = 2)
end

plt_kmer</code></pre><img src="ad9944e0.svg" alt="Example block output"/><h3 id="Conservation-Properties-(Table-13.4)"><a class="docs-heading-anchor" href="#Conservation-Properties-(Table-13.4)">Conservation Properties (Table 13.4)</a><a id="Conservation-Properties-(Table-13.4)-1"></a><a class="docs-heading-anchor-permalink" href="#Conservation-Properties-(Table-13.4)" title="Permalink"></a></h3><p>Coagulation conserves total aerosol volume (mass) while decreasing total number. Condensation conserves number while increasing volume. This is verified numerically:</p><table><tr><th style="text-align: left">Process</th><th style="text-align: left">Number (N)</th><th style="text-align: left">Volume/Mass (V)</th></tr><tr><td style="text-align: left">Coagulation</td><td style="text-align: left">Decreases</td><td style="text-align: left">Conserved</td></tr><tr><td style="text-align: left">Condensation</td><td style="text-align: left">Conserved</td><td style="text-align: left">Increases</td></tr><tr><td style="text-align: left">Coag + Cond</td><td style="text-align: left">Decreases</td><td style="text-align: left">Increases</td></tr><tr><td style="text-align: left">Nucleation</td><td style="text-align: left">Increases</td><td style="text-align: left">Increases</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../single_particle_dynamics/">Single Particle Dynamics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 17:54">Wednesday 4 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
